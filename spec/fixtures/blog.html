<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<title>MacJournal: blog</title>
<meta http-equiv="content-type" content="text/html; charset=utf-8">
<style type="text/css">
	body { background-color: #eee; }

	h1.header { text-align: center; }

	div.journalentry
	{
		background-color: white;
		border-color: black;
		border-width: thin;
		border-style: solid;
		-webkit-border-radius: 1ex;
		-webkit-box-shadow: 0ex 0.5ex 0.75ex #888;
		padding: 1ex;
		margin: 1em;
	}
</style>
</head>
<body>
<h1 class="header">blog</h1>
<div class="journalentry">
<b>Date:</b> 18 August 2011<br>
<b>Time:</b> 2:15:48 PM<br>
<b>Topic:</b> Bootstrapping Chef with Ruby-1.9.2-p290 on Ubuntu 10.04 LTS<br><br>
<p> <span style="font: 12pt Helvetica;">I just got going with Chef and then realised that it was installing Ruby 1.8.7 on my server to bootstrap itself. How last decade is that?! I was shattered, I thought all the cool kids were using Chef. I did start to wonder what I was getting myself into.</span></p>
<p></p>
<p> <span style="font: 12pt Helvetica;">Turns out it is not too difficult to change the bootstrapping behaviour. So I set up a bootstrap template to install Ruby 1.9.2-p290 instead. I had to do a little tweaking and then knife installed the chef-client without any real problems. Below is my bootstrap template. I put it in my chef-repo under .chef/bootstrap/install_ruby_192-p290.erb</span></p>
<p></p>
<p> <span style="font: 12pt Helvetica;">This script updates apt with build-essentials and all the other goodies required to compile ruby successfully. It then pulls down 1.9.2-p290 from ruby-lang.org, unpacks it, compiles it and installs it. It follows that with updating ruby gems to an appropriate version for 1.9.2 and then installing the ohai and chef gems. Ruby will end up in /usr/local/bin rather than /usr/bin and so does ruby-gems and so you can see that the call to chef-client at the end of the script had to be hard coded rather than calling to chef_start since chef_start seems to assume the the gem executable is in /usr/bin.</span></p>
<p></p>
<p></p>
<p><span style="font: 12pt Helvetica;">bash -c '</span></p>
<p><span style="font: 12pt Helvetica;">if [ ! -f /usr/local/bin/chef-client ]; then</span></p>
<p>  <span style="font: 12pt Helvetica;">apt-get update</span></p>
<p>  <span style="font: 12pt Helvetica;">sudo apt-get install -y build-essential zlib1g zlib1g-dev openssl libssl-dev</span></p>
<p>  <span style="font: 12pt Helvetica;">cd /tmp</span></p>
<p>  <span style="font: 12pt Helvetica;">wget ftp://ftp.ruby-lang.org//pub/ruby/1.9/ruby-1.9.2-p290.tar.gz</span></p>
<p>  <span style="font: 12pt Helvetica;">tar xvf ruby-1.9.2-p290.tar.gz</span></p>
<p>  <span style="font: 12pt Helvetica;">cd ruby-1.9.2-p290</span></p>
<p>  <span style="font: 12pt Helvetica;">./configure</span></p>
<p>  <span style="font: 12pt Helvetica;">make</span></p>
<p>  <span style="font: 12pt Helvetica;">sudo make install</span></p>
<p>  <span style="font: 12pt Helvetica;">sudo gem update --system</span></p>
<p>  <span style="font: 12pt Helvetica;"></span></p>
<p>  <span style="font: 12pt Helvetica;">gem update</span></p>
<p>  <span style="font: 12pt Helvetica;">gem install ohai --no-rdoc --no-ri --verbose</span></p>
<p>  <span style="font: 12pt Helvetica;">gem install chef --no-rdoc --no-ri --verbose &lt;%= bootstrap_version_string %&gt;</span></p>
<p><span style="font: 12pt Helvetica;">fi </span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">mkdir -p /etc/chef</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">(</span></p>
<p><span style="font: 12pt Helvetica;">cat &lt;&lt;'EOP'</span></p>
<p><span style="font: 12pt Helvetica;">&lt;%= validation_key %&gt;</span></p>
<p><span style="font: 12pt Helvetica;">EOP</span></p>
<p><span style="font: 12pt Helvetica;">) &gt; /tmp/validation.pem</span></p>
<p><span style="font: 12pt Helvetica;">awk NF /tmp/validation.pem &gt; /etc/chef/validation.pem</span></p>
<p><span style="font: 12pt Helvetica;">rm /tmp/validation.pem</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">(</span></p>
<p><span style="font: 12pt Helvetica;">cat &lt;&lt;'EOP'</span></p>
<p><span style="font: 12pt Helvetica;">&lt;%= config_content %&gt;</span></p>
<p><span style="font: 12pt Helvetica;">EOP</span></p>
<p><span style="font: 12pt Helvetica;">) &gt; /etc/chef/client.rb</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">(</span></p>
<p><span style="font: 12pt Helvetica;">cat &lt;&lt;'EOP'</span></p>
<p><span style="font: 12pt Helvetica;">&lt;%= { "run_list" =&gt; @run_list }.to_json %&gt;</span></p>
<p><span style="font: 12pt Helvetica;">EOP</span></p>
<p><span style="font: 12pt Helvetica;">) &gt; /etc/chef/first-boot.json</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">/usr/local/bin/chef-client -j /etc/chef/first-boot.json'</span></p>
<p></p>
<p> <span style="font: 12pt Helvetica;">Once you have that in place you can simple type:</span></p>
<p></p>
<p></p>
<p></p>
<p><span style="font: 12pt Helvetica;">$knife bootstrap NODE --distro ubuntu10.04-gems -x ubuntu --sudo --template-file .chef/bootstrap/install_ruby_192_p290.erb</span></p>
<p></p>
<p></p>
<p> <span style="font: 12pt Helvetica;">and your node should be bootstrapped with ruby 1.9.2 instead of 1.8.7. Obviously replace NODE with your node hostname. I hope this helps someone else, it took quite a while of digging to work this out. I won't be surprised to find out in a week or so that there is some existing bog standard way of doing this and I just didn't know what it was, but until then, hopefully this can shortcut anyone else in a similar situation to me.</span></p>
<p></p>
<p></p>
</div>

<div class="journalentry">
<b>Date:</b> 12 August 2011<br>
<b>Time:</b> 4:44:31 PM<br>
<b>Topic:</b> Whoops, forgot to background that 20gb scp<br><br>
<p><span style="font: 12pt Helvetica;">How pissed off do you get when you start a massive copy from one server to another via an ssh shell and forget to background it?! I was faced with this today. I had already copied 2gb when I realised my error and rather than stay at work over the weekend I had to do a little research to find out how to bail out of the terminal session without killing my scp process. Bash to the rescue:</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">$^z</span></p>
<p><span style="font: 12pt Helvetica;">control-z suspends the current process and gives you back your prompt,</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">$bg</span></p>
<p><span style="font: 12pt Helvetica;">bg backgrounds your suspended process and lets you get back to the essential task of packing up so you can go get some beers.</span></p>
<p></p>
<p></p>
<p></p>
</div>

<div class="journalentry">
<b>Date:</b> 9 August 2011<br>
<b>Time:</b> 2:48:15 PM<br>
<b>Topic:</b> OS X GCC Installer<br><br>
<p><span style="font: 12pt Helvetica;">After having a little bitch about the size of the Xcode download required just so I can compile binaries I saw a link to </span><span style="font: 12pt Helvetica; text-decoration: underline;"><a href="https://github.com/kennethreitz/osx-gcc-installer">this little baby</a></span><span style="font: 12pt Helvetica;">. I haven't tried it myself yet, since I already sucked up the anguish of sacrificing a fair whack of my download cap in exchange for the joys of Xcode on my mac, but it looks like an awesome option for those of us who are as little bandwidth challenged at times. It is essentially an installer for just the important parts of Xcode, i.e. GCC and other essential binaries for linking and making. I'll definitely give this a go next time.</span></p>
<p></p>
<p></p>
</div>

<div class="journalentry">
<b>Date:</b> 8 August 2011<br>
<b>Time:</b> 10:45:53 AM<br>
<b>Topic:</b> RMagick / ImageMagick on OS X Lion<br><br>
<p><span style="font: 12pt Helvetica;">I have had a few interesting problems with this so I thought I would document how I went about fixing my ImageMagick problems after I upgraded to Lion.</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">First I had to uninstall the rmagick gem then uninstall ImageMagick, I use homebrew so I just did</span></p>
<p></p>
<p></p>
<p><span style="font: 12pt Helvetica;">$brew uninstall imagemagick</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">Next I had to get the new Xcode version from the appstore, thankfully it is free but at three point something gigabytes it certainly put a dent in my download cap.</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">With Xcode installed I was able to re-install ImageMagic with the usual</span></p>
<p></p>
<p></p>
<p><span style="font: 12pt Helvetica;">$brew install imagemagic</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">Lovely, image magic installed and now</span></p>
<p></p>
<p></p>
<p><span style="font: 12pt Helvetica;">$gem install rmagick</span></p>
<p></p>
<p> <span style="font: 12pt Helvetica;">works without complaint, everything is great, right? …wrong! Unfortunately ghostscript seems to have disappeared from my system, I can't say I ever used it intentionally so I'm not sure when I lost it. What I can say is that any ImageMagic font work is done using the ghostscript fonts, so anything like captcha generation fails badly with this new 'working' rmagick install as ImageMagick can't find the fonts where it expects them (in the Ghostscript directory).</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">The answer to this problem is to install ghostscript</span></p>
<p></p>
<p></p>
<p><span style="font: 12pt Helvetica;">$brew install ghostscript</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">Unfortunately this failed for me due to the SHA1 being wrong for the current ghostscript version - 9.02. Wow, what a pain in the butt. The fix for this turns out to be applying a patch to the ghostscript recipe</span></p>
<p></p>
<p></p>
<p><span style="font: 12pt Helvetica;">$brew edit ghostscript</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">Then add:</span></p>
<p></p>
<p></p>
<p><span style="font: 12pt Helvetica;">def patches</span></p>
<p><span style="font: 12pt Helvetica;">{ :p0 =&gt; 'http://ftp.netbsd.org/pub/NetBSD/packages/pkgsrc/print/ghostscript/patches/patch-ak' }</span></p>
<p><span style="font: 12pt Helvetica;">end</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">Problem solved, ghostscript installs normally and now ImageMagic can do its thing with fonts, which means that rmagick can quit with its complaining and I can get back to development…awesome.</span></p>
<p></p>
<p></p>
</div>

<div class="journalentry">
<b>Date:</b> 31 July 2011<br>
<b>Time:</b> 11:15:27 PM<br>
<b>Topic:</b> Rails 3 Error Display<br><br>
<p><span style="font: 12pt Helvetica;">Rails error management is helpful and automatic, and a total pain in the ass sometimes. The reason it can be annoying is that when a field has an error it wraps both it and it's label with separate divs with the class "field_with_errors". From an HTML layout point of view this approach is a long way from awesome.</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">If you are putting your labels above your fields the only simple way to manage this is to make your label a block level element. If you put a br after your label it makes the label jump up a line above the field when an error is present. So that approach is out. Well that is just great for people who want to make their labels block level elements but I find that it totally sucks. I prefer to put a red asterisk or red dot at the end of the label of a field that is mandatory. This is trivially easy on inline elements, just add some right padding and position the mark as a background image with no-repeat at the right.</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">Unfortunately it is all but impossible to do for a block level label. I found a way around this, hopefully it can help others. Not exactly rocket science, but I wrote a helper to generate the br element only if their is no error on row field. Here it is:</span></p>
<p></p>
<p></p>
<p><span style="font: 12pt Helvetica;">def br_if_no_errors(model, field)</span></p>
<p>  <span style="font: 12pt Helvetica;">"</span></p>
<p><span style="font: 12pt Helvetica;">" unless model.errors.get(field).present?</span></p>
<p><span style="font: 12pt Helvetica;">end</span></p>
<p></p>
<p></p>
</div>

<div class="journalentry">
<b>Date:</b> 17 April 2011<br>
<b>Time:</b> 6:32:04 PM<br>
<b>Topic:</b> BDD or Bullshit?<br><br>
<p><span style="font: 12pt Helvetica;">The BDD debate goes on and on. Every new place I work people have a new and completely different take on what it is and whether it is good or bad. I have to admit that I have gotten to the point where if a codebase I am about to start working on already has a Cucumber test suite, I start to get nervous.</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">What is it going to be this time? A scenario for every possible edge case? Mountains of steps, impossible to read and constantly breaking? No controller or view specs, just a sprinkling of Cucumber pixie dust? There are just so many failure modes with a technology like Cucumber and it is such a tightrope walk to be successful.</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">I am now at the point where, on a project using BDD and I wasn't there at inception, I expect half my time to be spent fixing the Cucumber end of the build. If I'm spending that much time fixing them they would want to be providing some pretty airtight certainty of correctness and a certainty that I couldn't get with well scoped specs, usually they aren't.</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">Oddly enough more than half the time spent fixing the build has nothing to do with defects in the code, it is brittle tests. I can no longer even muster up an ironic chuckle when developers tell me that they retired their brittle Selenium tests in favour of Cucumber backed by Capybara. Umm... so you replaced your brittle Selenium tests with brittle Selenium tests driven by 2 - 3 layers of indirection (usually Cucumber scenarios and steps driving Capybara, driving Selenium WebDriver)... how has that worked out for you??</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">I'm not joining in with the anti-BDD brigade. I love RSpec and I think the idea of Cucumber is awesome. The idea that a BA or product owner can articulate a feature in plain English and the developer can provably implement it in code has real attraction. The reality is often a long way from that dream though. Even if you are lucky enough to have a BA or product owner who will write feature files, they generally have to be groomed and pruned by developers and certainly have to be implemented by developers. This pushes more and more effort down into the developer bottleneck. Further, as the application grows, the Cukes become slower and slower and more and more fragile. Any poorly written ones become a constant cross on the back of the development team.</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">The answer is to be highly selective about what you choose to test in a Cuke. Drive out the feature happy case only and paint with the broadest strokes that will satisfy. If necessary one or two of the major failure cases can be written as scenarios, but think seriously before going too far down this path.</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">Spend a lot of time thinking about how you are going to efficiently setup data for your Cukes. Don't fall into the trap of executing long chains of steps just to get your data in a state for your actual assertion unless those steps are core to the scenario. </span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">Don't use Cucumber to build an automated regression suite. You may as well just go direct to Selenium to do that (assuming this is a web app). At least then your testers are able to write and maintain the tests and take some of the test load off the developers.</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">Write controller and view specs with the same rigour you apply to any other specs. Consider testing your scenario edge cases here and certainly test your HTML in this way rather than baking it into your Cukes.</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">Use Jasmine or some other Javascript testing framework that allows you to completely cover your Javascript without requiring Cukes to give you confidence that they work. Of course you will trigger Javascript in your Cukes but you are in for a world of pain if that is your main or only Javascript testing.</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">It is hard to defend BDD sometimes when you look at the mess many development teams have made from it. I nevertheless maintain that you can derive immense value from it so long as you approach it carefully and don't just drink the cool aid and dive in head first.</span></p>
<p></p>
<p></p>
<p></p>
<p></p>
</div>

<div class="journalentry">
<b>Date:</b> 29 January 2011<br>
<b>Time:</b> 3:17:02 PM<br>
<b>Topic:</b> Replacing Dozer with SimpleObjectAssembler<br><br>
<p><span style="font: 12pt Helvetica;">Since I made the painful move to using DTOs in my Java applications (at least when any remoting is involved) I have been less than excited with the work involved in mapping domain objects to their DTO counterparts. There is a whole, lengthy conversation in why I abandoned trying to remote with domain objects (even when the domain is reasonably trivial) and went to DTOs but ostensibly it was driven by Hibernate and JPA and the enormous pain in the ass involved in detaching the object graph.</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">Until recently I have been using </span><span style="font: 12pt Helvetica; text-decoration: underline;"><a href="http://dozer.sourceforge.net/">Dozer</a></span> <span style="font: 12pt Helvetica;">to do the heavy lifting in transforming from domain to DTO and back. It is heavily XML based and requires a fair bit of XML configuration for anything other than the most simple mappings. Since I have a long history with Spring (since long before annotations came along) I just accepted this along with the other billion lines of XML required for defining my applications. I guess I had just become immune to configuration fatigue, it all seemed quite normal to me. Even when a friend and colleague (Rob Monie) told me about a little open source project he was working on to simplify the mapping process without the need for XML (</span><span style="font: 12pt Helvetica; text-decoration: underline;"><a href="http://code.google.com/p/simple-object-assembler/">SimpleObjectAssembler</a></span><span style="font: 12pt Helvetica;">) I initially ignored it and stuck with the devil I knew.</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">Recently, I just got sick of it all and decided to move to the Simple Object Assembler. My main motivation was not so much about Dozer as that I had implemented my mappings without tests to verify them and could no longer stand the pain of supporting that approach. I decided to properly test my transforms and decided it was a good opportunity to scrap Dozer and clean up.</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">SimpleObjectAssembler allows you to define field to be excluded inline when you do the mapping. There is no need to set up an XML descriptor for each type-to-type mapping. It does some pretty reasonable inferences where fields are named the same and allows you to register custom converters for complex type conversions. I like this approach as it splits out the conversion logic into classes that are highly specialised to the task. So long as you name them clearly it is simple to track down the conversion logic later and even easier to test it in isolation. The same cannot be said for Dozer.</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">I have converted Express 0.8-RC2 to SimpleObjectAssembler and aside from the increased testability I have achieved I am also getting a slight performance increase. This is likely due to the fact that it is easier to highly customize the mappings a service performs as you can rework the exclusions in-line rather than just putting up with an XML configured conversion that is close to what you want (the Dozer approach).</span></p>
<p></p>
</div>

<div class="journalentry">
<b>Date:</b> 9 December 2010<br>
<b>Time:</b> 4:28:19 PM<br>
<b>Topic:</b> Install ruby-pg gem on snow leopard<br><br>
<p><span style="font: 12pt Helvetica;">I can't hunt the web for how to do this again:</span></p>
<p></p>
<p></p>
<p><span style="font: 12pt Helvetica;">export PATH=/Library/PostgreSQL/9.0/bin/:${PATH}</span></p>
<p><span style="font: 12pt Helvetica;">env ARCHFLAGS="-arch x86_64" gem install ruby-pg</span></p>
<p></p>
<p></p>
</div>

<div class="journalentry">
<b>Date:</b> 18 November 2010<br>
<b>Time:</b> 11:04:48 PM<br>
<b>Topic:</b> Automatic Getter And Setter Testing with Hamcrest<br><br>
<p> <span style="font: 12pt Helvetica;">Getter and setter testing is a pain in the behind. This kind of low value testing is time consuming and really hard to justify, but every now and then it turns up a variable shadowing bug or some problem in assignment that would be brutally hard to work out based on user defect reports. The other down side of not doing it is that it really hits your test coverage metrics hard and causes no end of pointless depression for teams trying to keep high quality code metrics.</span></p>
<p></p>
<p> <span style="font: 12pt Helvetica;">I am a strong exponent of TDD but, personally, I rarely drive out domain getters and setters with tests. I'm certain that I am committing some type of mortal sin by not doing so, but I usually have a fair idea about the data required from domain modelling discussions and I like to get out a bare bones implementation of the domain quickly to facilitate initial stories. Over a number of years I have used a getter/setter invoking strategy that is fairly horrible but functional. Recently I had cause to go back and have a look at it and decided to rewrite it using Mockito, Hamcrest matchers, and some varargs to make the whole thing a lot more useable.</span></p>
<p></p>
<p> <span style="font: 12pt Helvetica;">Two matchers are exposed, one that will invoke a getter and setter for all member variables of a class and will exclude zero or more fields that the user provides</span></p>
<p></p>
<p></p>
<p><span style="font: 12pt Helvetica;">@Test</span></p>
<p><span style="font: 12pt Helvetica;">public void shouldSetAndGetProperties() {</span></p>
<p>   <span style="font: 12pt Helvetica;">assertThat(user, hasValidSettersAndGettersExcluding("fieldX", "fieldY"));</span></p>
<p><span style="font: 12pt Helvetica;">}</span></p>
<p></p>
<p></p>
<p><span style="font: 12pt Helvetica;">The other matcher will invoke a getter and setter only for the fields provided</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">@Test</span></p>
<p><span style="font: 12pt Helvetica;">public void shouldSetAndGetProperties() {</span></p>
<p>   <span style="font: 12pt Helvetica;">assertThat(user, hasValidSettersAndGettersFor("fieldA", "fieldB", "fieldC));</span></p>
<p><span style="font: 12pt Helvetica;">}</span></p>
<p></p>
<p></p>
<p><span style="font: 12pt Helvetica;">The heavy lifting is done by a GetterSetterInovker class:</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">package com.express.testutils;</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">import org.apache.commons.logging.Log;</span></p>
<p><span style="font: 12pt Helvetica;">import org.apache.commons.logging.LogFactory;</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">import java.lang.reflect.Field;</span></p>
<p><span style="font: 12pt Helvetica;">import java.lang.reflect.Method;</span></p>
<p><span style="font: 12pt Helvetica;">import java.lang.reflect.Modifier;</span></p>
<p><span style="font: 12pt Helvetica;">import java.util.ArrayList;</span></p>
<p><span style="font: 12pt Helvetica;">import java.util.HashMap;</span></p>
<p><span style="font: 12pt Helvetica;">import java.util.List;</span></p>
<p><span style="font: 12pt Helvetica;">import java.util.Map;</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">public class SetterGetterInvoker {</span></p>
<p>   <span style="font: 12pt Helvetica;">private static final Log LOG = LogFactory.getLog(SetterGetterInvoker.class);</span></p>
<p></p>
<p>   <span style="font: 12pt Helvetica;">private T testTarget;</span></p>
<p>   <span style="font: 12pt Helvetica;">private Class testClass;</span></p>
<p>   <span style="font: 12pt Helvetica;">private ValueFactory valueFactory;</span></p>
<p>   <span style="font: 12pt Helvetica;">private Map methodMap = new HashMap();</span></p>
<p></p>
<p>   <span style="font: 12pt Helvetica;">public SetterGetterInvoker(T testTarget) {</span></p>
<p>      <span style="font: 12pt Helvetica;">this.testTarget = testTarget;</span></p>
<p>      <span style="font: 12pt Helvetica;">this.testClass = testTarget.getClass();</span></p>
<p>      <span style="font: 12pt Helvetica;">this.valueFactory = new ValueFactory();</span></p>
<p>      <span style="font: 12pt Helvetica;">for (Method method : testTarget.getClass().getMethods()) {</span></p>
<p>         <span style="font: 12pt Helvetica;">methodMap.put(method.getName(), method);</span></p>
<p>      <span style="font: 12pt Helvetica;">}</span></p>
<p>   <span style="font: 12pt Helvetica;">}</span></p>
<p></p>
<p>   <span style="font: 12pt Helvetica;">public boolean invokeSettersAndGettersFor(String[] fields) {</span></p>
<p>      <span style="font: 12pt Helvetica;">return invokeSettersAndGetters(fields);</span></p>
<p>   <span style="font: 12pt Helvetica;">}</span></p>
<p></p>
<p>   <span style="font: 12pt Helvetica;">public boolean invokeSettersAndGettersExcluding(String[] excludedFields) {</span></p>
<p>      <span style="font: 12pt Helvetica;">Field[] classFields = testClass.getDeclaredFields();</span></p>
<p>      <span style="font: 12pt Helvetica;">List fields = new ArrayList();</span></p>
<p>      <span style="font: 12pt Helvetica;">for(Field classField : classFields) {</span></p>
<p>         <span style="font: 12pt Helvetica;">String fieldName = classField.getName();</span></p>
<p>         <span style="font: 12pt Helvetica;">if(!in(fieldName, excludedFields) &amp;&amp; !Modifier.isStatic(classField.getModifiers())) {</span></p>
<p>            <span style="font: 12pt Helvetica;">fields.add(fieldName);</span></p>
<p>         <span style="font: 12pt Helvetica;">}</span></p>
<p>      <span style="font: 12pt Helvetica;">}</span></p>
<p>      <span style="font: 12pt Helvetica;">return invokeSettersAndGetters(fields.toArray(new String[fields.size()]));</span></p>
<p>   <span style="font: 12pt Helvetica;">}</span></p>
<p></p>
<p>   <span style="font: 12pt Helvetica;">private boolean in(String field, String[] fields) {</span></p>
<p>      <span style="font: 12pt Helvetica;">for(String arrayField : fields) {</span></p>
<p>         <span style="font: 12pt Helvetica;">if( arrayField.equals(field)) {</span></p>
<p>            <span style="font: 12pt Helvetica;">return true;</span></p>
<p>         <span style="font: 12pt Helvetica;">}</span></p>
<p>      <span style="font: 12pt Helvetica;">}</span></p>
<p>      <span style="font: 12pt Helvetica;">return false;</span></p>
<p>   <span style="font: 12pt Helvetica;">}</span></p>
<p></p>
<p>   <span style="font: 12pt Helvetica;">private boolean invokeSettersAndGetters(String[] fields) {</span></p>
<p>      <span style="font: 12pt Helvetica;">for (String field : fields) {</span></p>
<p>         <span style="font: 12pt Helvetica;">LOG.debug("Invoking getter/setter for " + field);</span></p>
<p>         <span style="font: 12pt Helvetica;">String capitalizedFieldName = Character.toUpperCase(field.charAt(0)) + field.substring(1);</span></p>
<p>         <span style="font: 12pt Helvetica;">try {</span></p>
<p>            <span style="font: 12pt Helvetica;">Object testValue = invokeSetter(methodMap.get("set" + capitalizedFieldName));</span></p>
<p>            <span style="font: 12pt Helvetica;">Method getterMethod = methodMap.get(constructMethodName(capitalizedFieldName, testValue));</span></p>
<p>            <span style="font: 12pt Helvetica;">Object result = getterMethod.invoke(testTarget);</span></p>
<p>            <span style="font: 12pt Helvetica;">if (!testValue.equals(result)) {</span></p>
<p>               <span style="font: 12pt Helvetica;">LOG.error("Getter result did not match set value for field:" + field);</span></p>
<p>               <span style="font: 12pt Helvetica;">return false;</span></p>
<p>            <span style="font: 12pt Helvetica;">}</span></p>
<p>         <span style="font: 12pt Helvetica;">} catch (Exception e) {</span></p>
<p>            <span style="font: 12pt Helvetica;">LOG.error("Unable to invoke both getter and setter for " + field, e);</span></p>
<p>            <span style="font: 12pt Helvetica;">return false;</span></p>
<p>         <span style="font: 12pt Helvetica;">}</span></p>
<p>      <span style="font: 12pt Helvetica;">}</span></p>
<p>      <span style="font: 12pt Helvetica;">return true;</span></p>
<p>   <span style="font: 12pt Helvetica;">}</span></p>
<p></p>
<p>   <span style="font: 12pt Helvetica;">private Object invokeSetter(Method method) throws Exception {</span></p>
<p>      <span style="font: 12pt Helvetica;">Class[] parameterTypes = method.getParameterTypes();</span></p>
<p>      <span style="font: 12pt Helvetica;">if (parameterTypes.length == 1) {</span></p>
<p>         <span style="font: 12pt Helvetica;">Object testValue = valueFactory.createValue(parameterTypes[0]);</span></p>
<p>         <span style="font: 12pt Helvetica;">method.invoke(testTarget, testValue);</span></p>
<p>         <span style="font: 12pt Helvetica;">return testValue;</span></p>
<p>      <span style="font: 12pt Helvetica;">}</span></p>
<p>      <span style="font: 12pt Helvetica;">return null;</span></p>
<p>   <span style="font: 12pt Helvetica;">}</span></p>
<p></p>
<p>   <span style="font: 12pt Helvetica;">private String constructMethodName(String capitalizedFieldName, Object testValue) {</span></p>
<p>      <span style="font: 12pt Helvetica;">String base =  "get";</span></p>
<p>      <span style="font: 12pt Helvetica;">if(testValue instanceof Boolean &amp;&amp; testMethodNameDoesNotExists(base + capitalizedFieldName)) {</span></p>
<p>         <span style="font: 12pt Helvetica;">return "is" + capitalizedFieldName;</span></p>
<p>      <span style="font: 12pt Helvetica;">}</span></p>
<p>      <span style="font: 12pt Helvetica;">return base + capitalizedFieldName;</span></p>
<p>   <span style="font: 12pt Helvetica;">}</span></p>
<p></p>
<p>   <span style="font: 12pt Helvetica;">private boolean testMethodNameDoesNotExists(String methodName) {</span></p>
<p>      <span style="font: 12pt Helvetica;">try {</span></p>
<p>         <span style="font: 12pt Helvetica;">testClass.getMethod(methodName, null);</span></p>
<p>         <span style="font: 12pt Helvetica;">return false;</span></p>
<p>      <span style="font: 12pt Helvetica;">} catch (NoSuchMethodException e) {</span></p>
<p>         <span style="font: 12pt Helvetica;">return true;</span></p>
<p>      <span style="font: 12pt Helvetica;">}</span></p>
<p></p>
<p>   <span style="font: 12pt Helvetica;">}</span></p>
<p><span style="font: 12pt Helvetica;">}</span></p>
<p></p>
<p></p>
<p><span style="font: 12pt Helvetica;">The GetterSetterInovker relies on the ValueFactory to create values for setting and getting. For non-final classes, it simply returns a Mockito mock of the type. Plenty of the Java core types are final however so there is a little ugliness here.</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">package com.express.testutils;</span></p>
<p></p>
<p></p>
<p><span style="font: 12pt Helvetica;">import java.lang.reflect.Modifier;</span></p>
<p><span style="font: 12pt Helvetica;">import java.util.HashMap;</span></p>
<p><span style="font: 12pt Helvetica;">import java.util.Map;</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">import static org.mockito.Mockito.mock;</span></p>
<p></p>
<p></p>
<p><span style="font: 12pt Helvetica;">public class ValueFactory {</span></p>
<p>   <span style="font: 12pt Helvetica;">private static final int A_NUMBER = 42;</span></p>
<p>   <span style="font: 12pt Helvetica;">private static final int HALF_A_NUMBER = 21;</span></p>
<p></p>
<p>   <span style="font: 12pt Helvetica;">private Map, Object&gt; typeValues;</span></p>
<p></p>
<p>   <span style="font: 12pt Helvetica;">public ValueFactory() {</span></p>
<p>      <span style="font: 12pt Helvetica;">typeValues = new HashMap, Object&gt;();</span></p>
<p>      <span style="font: 12pt Helvetica;">typeValues.put(String.class, "test");</span></p>
<p>      <span style="font: 12pt Helvetica;">typeValues.put(Long.class, new Long(A_NUMBER));</span></p>
<p>      <span style="font: 12pt Helvetica;">typeValues.put(Long.TYPE, new Long(A_NUMBER));</span></p>
<p>      <span style="font: 12pt Helvetica;">typeValues.put(Integer.class, Integer.valueOf(HALF_A_NUMBER));</span></p>
<p>      <span style="font: 12pt Helvetica;">typeValues.put(Integer.TYPE, Integer.valueOf(HALF_A_NUMBER));</span></p>
<p>      <span style="font: 12pt Helvetica;">typeValues.put(Boolean.class, Boolean.TRUE);</span></p>
<p>      <span style="font: 12pt Helvetica;">typeValues.put(Boolean.TYPE, Boolean.TRUE);</span></p>
<p>      <span style="font: 12pt Helvetica;">typeValues.put(Long[].class, new Long[0]);</span></p>
<p>      <span style="font: 12pt Helvetica;">typeValues.put(Integer[].class, new Integer[0]);</span></p>
<p>      <span style="font: 12pt Helvetica;">typeValues.put(String[].class, new String[0]);</span></p>
<p>      <span style="font: 12pt Helvetica;">typeValues.put(Boolean[].class, new Boolean[0]);</span></p>
<p>   <span style="font: 12pt Helvetica;">}</span></p>
<p></p>
<p>   <span style="font: 12pt Helvetica;">public Object createValue(Class type) {</span></p>
<p>      <span style="font: 12pt Helvetica;">if(Modifier.isFinal(type.getModifiers())) {</span></p>
<p>         <span style="font: 12pt Helvetica;">return typeValues.get(type);</span></p>
<p>      <span style="font: 12pt Helvetica;">}</span></p>
<p>      <span style="font: 12pt Helvetica;">return mock(type);</span></p>
<p>   <span style="font: 12pt Helvetica;">}</span></p>
<p><span style="font: 12pt Helvetica;">}</span></p>
<p></p>
<p></p>
<p><span style="font: 12pt Helvetica;">All the nastiness of getting and setting gets hidden away behind a pair of Hamcrest Matchers. As described above one invokes getters and setters for all class member variables except those specified, the other will invoke getters and setters for only the member variables specified. Here is the one that invokes getters and setters for all class fields except those specified:</span></p>
<p></p>
<p></p>
<p><span style="font: 12pt Helvetica;">package com.express.matcher;</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">import com.express.testutils.SetterGetterInvoker;</span></p>
<p><span style="font: 12pt Helvetica;">import org.hamcrest.Description;</span></p>
<p><span style="font: 12pt Helvetica;">import org.hamcrest.TypeSafeMatcher;</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">public class HasValidSettersAndGettersExcludingMatcher extends TypeSafeMatcher {</span></p>
<p>   <span style="font: 12pt Helvetica;">private String[] fields;</span></p>
<p></p>
<p>   <span style="font: 12pt Helvetica;">public HasValidSettersAndGettersExcludingMatcher(String... fields) {</span></p>
<p>      <span style="font: 12pt Helvetica;">this.fields = fields;</span></p>
<p>   <span style="font: 12pt Helvetica;">}</span></p>
<p></p>
<p>   <span style="font: 12pt Helvetica;">@Override</span></p>
<p>   <span style="font: 12pt Helvetica;">public boolean matchesSafely(T subject) {</span></p>
<p>      <span style="font: 12pt Helvetica;">SetterGetterInvoker setterGetterInvoker = new SetterGetterInvoker(subject);</span></p>
<p>      <span style="font: 12pt Helvetica;">return setterGetterInvoker.invokeSettersAndGettersExcluding(fields);</span></p>
<p>   <span style="font: 12pt Helvetica;">}</span></p>
<p></p>
<p>   <span style="font: 12pt Helvetica;">public void describeTo(Description description) {</span></p>
<p>      <span style="font: 12pt Helvetica;">description.appendText("Unable to match setter and getter results for class fields excluding ");</span></p>
<p>      <span style="font: 12pt Helvetica;">description.appendValue(fields);</span></p>
<p>   <span style="font: 12pt Helvetica;">}</span></p>
<p><span style="font: 12pt Helvetica;">}</span></p>
<p></p>
<p></p>
<p><span style="font: 12pt Helvetica;">And this one invokes only those specified:</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">package com.express.matcher;</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">import com.express.testutils.SetterGetterInvoker;</span></p>
<p><span style="font: 12pt Helvetica;">import org.hamcrest.Description;</span></p>
<p><span style="font: 12pt Helvetica;">import org.hamcrest.TypeSafeMatcher;</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">public class HasValidSettersAndGettersForMatcher extends TypeSafeMatcher {</span></p>
<p>   <span style="font: 12pt Helvetica;">private String[] fields;</span></p>
<p></p>
<p>   <span style="font: 12pt Helvetica;">public HasValidSettersAndGettersForMatcher(String... fields) {</span></p>
<p>      <span style="font: 12pt Helvetica;">this.fields = fields;</span></p>
<p>   <span style="font: 12pt Helvetica;">}</span></p>
<p></p>
<p>   <span style="font: 12pt Helvetica;">@Override</span></p>
<p>   <span style="font: 12pt Helvetica;">public boolean matchesSafely(T subject) {</span></p>
<p>      <span style="font: 12pt Helvetica;">SetterGetterInvoker setterGetterInvoker = new SetterGetterInvoker(subject);</span></p>
<p>      <span style="font: 12pt Helvetica;">return setterGetterInvoker.invokeSettersAndGettersFor(fields);</span></p>
<p>   <span style="font: 12pt Helvetica;">}</span></p>
<p></p>
<p>   <span style="font: 12pt Helvetica;">public void describeTo(Description description) {</span></p>
<p>      <span style="font: 12pt Helvetica;">description.appendText("Unable to match setter and getter results for class fields: ");</span></p>
<p>      <span style="font: 12pt Helvetica;">description.appendValue(fields);</span></p>
<p>   <span style="font: 12pt Helvetica;">}</span></p>
<p><span style="font: 12pt Helvetica;">}</span></p>
<p></p>
<p></p>
<p><span style="font: 12pt Helvetica;">A factory sits over the top to make it simple to acquire a matcher in the usual Hamcrest way:</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">package com.express.matcher;</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">import org.hamcrest.Factory;</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">public final class BeanMatchers {</span></p>
<p>   <span style="font: 12pt Helvetica;">private BeanMatchers() { }</span></p>
<p></p>
<p>   <span style="font: 12pt Helvetica;">@Factory</span></p>
<p>   <span style="font: 12pt Helvetica;">public static  HasValidSettersAndGettersForMatcher hasValidSettersAndGettersFor(String... fields) {</span></p>
<p>      <span style="font: 12pt Helvetica;">return new HasValidSettersAndGettersForMatcher(fields);</span></p>
<p>   <span style="font: 12pt Helvetica;">}</span></p>
<p></p>
<p>   <span style="font: 12pt Helvetica;">@Factory</span></p>
<p>   <span style="font: 12pt Helvetica;">public static  HasValidSettersAndGettersExcludingMatcher hasValidSettersAndGettersExcluding(String... fields) {</span></p>
<p>      <span style="font: 12pt Helvetica;">return new HasValidSettersAndGettersExcludingMatcher(fields);</span></p>
<p>   <span style="font: 12pt Helvetica;">}</span></p>
<p><span style="font: 12pt Helvetica;">}</span></p>
<p></p>
<p></p>
<p></p>
</div>

<div class="journalentry">
<b>Date:</b> 30 May 2010<br>
<b>Time:</b> 10:46:39 PM<br>
<b>Topic:</b> Agile Tools<br><br>
<p style="text-align: left"><span style="font: 12pt Helvetica;">I read a bunch of Agile and Scrum user groups, since I am fairly involved both in Agile development and tool support for Agile development it seems sensible to stay in touch with what people are talking about and what questions they are asking.</span></p>
<p style="text-align: left"></p>
<p style="text-align: left"><span style="font: 12pt Helvetica;">It seems like about once a month someone will post a question to one of these groups asking for advice on what backlog management tool they should use or what is everyone else using. Often they are looking for open source tools, but not always. More often than not, whether they are requesting open source tools or not, sales people from the various agile tool companies jump on these posts to push their product, often bringing up the old "how free is free" argument, implying that open source means poorly made and you will spend more time/money trying to get it working than you would just buying their fantastic tool.</span></p>
<p style="text-align: left"></p>
<p style="text-align: left"><span style="font: 12pt Helvetica;">I often wonder about these types of questions. They are so unspecific about what the asker is actually looking for, I often want to ask: "What makes you think you need a tool?" or "What is the problem you are trying to solve?". Obviously I would like people to check out Express, like it, and get a lot of value from it, but it seems hard to imagine that anyone is going to be able to select a tool unless they are clear on what they need from it and how it is going to improve their process.</span></p>
<p style="text-align: left"></p>
<p style="text-align: left"><span style="font: 12pt Helvetica;">For many groups there is no need for anything more sophisticated than a whiteboard and some type of shared document space, like a wiki or a google doc/site. For other teams this is nowhere near adequate. What are the factors that make this nowhere near adequate? I thought I might explore them as I have some experience in this and it is why I began developing Express in the first place.</span></p>
<p style="text-align: left"></p>
<p style="text-align: left"><span style="font: 12pt Helvetica;">1. You have stakeholders who are not co-located with the development team: This is really common for external development companies, outsourcers, and consultancies. There is nothing unagile about not having all stakeholders co-located. Of course there needs to be a customer representative but that person will likely be representing all sorts of interested parties who would like to be able to get information on how the project is going. Tools can help here to keep the remote parties in the loop about what is going on and allow them to review the stories as well as progress.</span></p>
<p style="text-align: left"></p>
<p style="text-align: left"><span style="font: 12pt Helvetica;">2. Your team is distributed. There is nothing unagile about this either. Many teams have an off-site component to their development or have entire sprint teams off-site or off-shore. Of course everyone being in the same room has immense benefits in  terms of informal communication and information sharing but that is not always an option and in some cases, not even desirable. Teams who are not physically co-located need to work hard to maintain communication and their commitment to tasks assigned to them. The best way to do this is with a virtual wall. This allows everyone to view the current state of the iteration stories and tasks.</span></p>
<p style="text-align: left"></p>
<p style="text-align: left"><span style="font: 12pt Helvetica;">3. You need to manage and track project metrics. Some agile teams are not too concerned about detailed metrics. They know their velocity and that is enough. Other teams like to keep detailed metrics on what happened during a sprint. This can be very onerous unless the team has some tools to help. Tracking this kind of thing on a spreadsheet can quickly become problematic. An Agile project management tool can be really helpful here to track how many points were delivered in each iteration, how the total count of story points delivered compares to the number of story points required to release, etc.</span></p>
<p style="text-align: left"></p>
<p style="text-align: left"><span style="font: 12pt Helvetica;">4. Your team has stakeholders who would like to know when you're likely to be finished. Okay, that is probably every team but it can be very difficult to say when you are likely to be finished when you don't have a tool to help with estimation and time tracking. If you are using a backlog management tool you should be able to get a more and more accurate picture of how you are tracking and when you are likely to deliver.</span></p>
<p style="text-align: left"></p>
<p style="text-align: left"><span style="font: 12pt Helvetica;">In general I think that knowing what you are looking for is going to make a big difference as to the tool that you select to manage your backlog. Other considerations are around integration with existing tools (if you have them) such as defect management tools and version control. It is well worth just thinking about whether you need this type of integration and exactly what benefit you see your team getting from it.</span></p>
<p style="text-align: left"></p>
</div>

<div class="journalentry">
<b>Date:</b> 15 March 2010<br>
<b>Time:</b> 5:15:15 PM<br>
<b>Topic:</b> Express Roadmap<br><br>
<p><span style="font: 12pt Helvetica;">I thought it might be useful to detail where Express is right now and where it will be going in the immediate future. This should serve both as documentation for people on what features are currently available and also provide information to people who are thinking of using Express as to where the application is heading in the near future. This roadmap is somewhat changeable, as I try to groom the next features being developed based on feedback from users.</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">Currently I am working on refactoring the UI to support more information. I am going to remove the project summary and iteration summary accordion from the main backlog screen and create vertical tabs down the right hand side that will allow the project and iteration panels to be able to slide out from the right and be visible no matter what main screen you re on. this will allow me to add a 3rd panel for impediment management which is a core feature for the 8.0 release.</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">I am also increasing the amount of historical information retained by Express to be able to track change. This means that in future Express will be able to report on story points added or removed from an iteration. We will also be able to track change at a project level. This will allow a burnup chart to be generated for the project and a burndown for an iteration can also indicate how the target for the iteration changed.</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">Filters and searching are also coming to version 0.8. I am looking to apply these to both the backlog management screen and the virtual wall. I will likely implement most of the functionality in point release but look at 0.8 shipping having filtering of stories.</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">I'm keen to get feedback from users as to what features they think are most important so please go ahead and comment here or (even better) post on the feature request tracker </span><span style="font: 12pt Helvetica; text-decoration: underline;"><a href="http://sourceforge.net/tracker/?group_id=283684&atid=1202878">here</a></span><span style="font: 12pt Helvetica;">.</span></p>
<p></p>
</div>

<div class="journalentry">
<b>Date:</b> 12 March 2010<br>
<b>Time:</b> 11:34:22 AM<br>
<b>Topic:</b> Selecting a technology for rapid development<br><br>
<p style="text-align: left"><span style="font: 12pt Helvetica;">I recently started with a company looking to quickly create a web application to leverage their existing customer base but without being coupled to their existing product and platform. Once the high level requirements were understood the first thing to decide was what technology would best suit this. They have a big investment in people and skills around Java and the JVM. Although the new project is siloed and to be treated as a completely separate entity to the main company</span></p>
<p style="text-align: left"></p>
</div>

<div class="journalentry">
<b>Date:</b> 6 March 2010<br>
<b>Time:</b> 3:38:43 PM<br>
<b>Topic:</b> Express 0.7.5 Released<br><br>
<p style="text-align: left"><span style="font: 12pt Helvetica;">I have just released Express 0.7.5. This release fixes a layout issue for task cards on a Linux client with a limited font availability. It ensures that the scrollbar doesn't appear on the card if the only available sans-serif font renders slightly taller than normal.</span></p>
<p style="text-align: left"><span style="font: 12pt Helvetica;">This will be the last 0.7 point release. Work on the 0.8 release is progressing well and will include filtering, extra reporting and impediment management.</span></p>
<p style="text-align: left"></p>
</div>

<div class="journalentry">
<b>Date:</b> 2 March 2010<br>
<b>Time:</b> 8:04:27 PM<br>
<b>Topic:</b> Express 0.7.4 released!<br><br>
<p><span style="font: 12pt Helvetica;">I have just released Express version 0.7.4 it can be downloaded at </span><span style="font: 12pt Helvetica; text-decoration: underline;"><a href="https://sourceforge.net/projects/agileexpress/files/">sourceforge</a></span><span style="font: 12pt Helvetica;">. This release has just one new feature - individual swim lanes for tasks under a given story. I intended to do a number of small features in this release but due to the number of requests for this feature I decided to release it immediately and move the search and filter features, which are only partially completed, into the next release. I am going to start on the 0.8 release now and bring all the currently requested features all into that release as well as the completion of impediment management.</span></p>
<p></p>
</div>

<div class="journalentry">
<b>Date:</b> 4 February 2010<br>
<b>Time:</b> 3:01:45 PM<br>
<b>Topic:</b> Express 0.7.3 released!<br><br>
<p><span style="font: 12pt Helvetica;">Express version 0.7.3 has now been released on </span><span style="font: 12pt Helvetica; text-decoration: underline;"><a href="http://sourceforge.net/projects/agileexpress/files/">sourceforge</a></span><span style="font: 12pt Helvetica;">. This version contains a number of fixes and improvements including:</span></p>
<ul style="list-style-type: disc">
<li></li>
<li><span style="font: 12pt Helvetica;">Unassign</span></li>
<li></li>
<li><span style="font: 12pt Helvetica;">Deselect themes</span></li>
<li></li>
<li><span style="font: 12pt Helvetica;">Sorting on assigned to in the backlog grid</span></li>
<li></li>
<li><span style="font: 12pt Helvetica;">quick menus for stories and tasks on the virtual wall</span></li>
<li></li>
<li><span style="font: 12pt Helvetica;">Fixed missing effort record for 'now' on the burndown</span></li>
<li></li>
<li><span style="font: 12pt Helvetica;">Ordering of multiple themes for a story</span></li>
<li></li>
</ul>
<p></p>
<p></p>
</div>

<div class="journalentry">
<b>Date:</b> 3 June 2009<br>
<b>Time:</b> 1:00:50 PM<br>
<b>Topic:</b> Postcards From a Vietnam Labour Camp Pt IX<br><br>
<p><span style="font: 12pt Helvetica;">Wow I'm almost at the big postcard X! I'l have to save some really juicy stuff to put in that one, I'll make it a special Gala edition postcard and really pile on the bullshit... because I generally hold back so much that on a day to day basis I feel kind of repressed.</span></p>
<p></p>
<p></p>
<p></p>
<p><span style="font: 12pt Helvetica;">I'm learning so much living here in Vietnam. If only I had been flown here instead of to the Alfred hospital when they evacuated me from Thailand you probably wouldn't even be able to tell I had been burned. In Hoi An, even the people on street know the secret to fixing a sub-glottic stenosis (the medical condition behind my trachea tube). They know and they are happy to share their advice for free, unlike those schiesters at the Alfred and in the Wellington hospital in London. The solution mostly revolves around Ginger, oddly enough a spice whose very smell causes me to want to blow chunks. Basically if I would modify my diet to include massive doses of ginger then apparently I could just pull out my trachea tube after a couple of days. I've decided when I get back to Australia I am going to sue my surgeons for malpractice, while they were busy doing surgery and repairing damaged parts of my anatomy, what they actually should have been doing is giving me some ginger tea!</span></p>
<p></p>
<p></p>
<p></p>
<p><span style="font: 12pt Helvetica;">While we were staying in Hoi An, we also had the joy of watching some local TV stations. We discovered that Lily doesn't really give a shit what language the cartoon is in as long as it has some type of animal that she likes, currently that means Elephants, Lions, Giraffes and Monkeys. I was initially kind of surprised about this, but when you think of how poor a grasp on English most 2 year olds have I guess the surprising thing is that cartoon makers bother putting voices on at all. Bill &amp; Ben certainly didn't bother when I was a kid, they just said "a bob bob bob bob". I happened to catch a new and improved episode the other day which actually has a narrator and found that the stories made no more sense than they did when I used to watch them as a 4 year old.</span></p>
<p></p>
<p></p>
<p></p>
<p><span style="font: 12pt Helvetica;">While we were in Hoi An I actually saw an English movie dubbed in Vietnamese while we were channel surfing looking for cartoons containing the aforementioned animals, so I have got to describe it. Okay, I accept that there is a certain amount of bullshit in my emails, but you have got to believe that the following account is absolutely accurate and in no way exaggerated... believe me, I couldn't make this shit up!</span></p>
<p></p>
<p></p>
<p></p>
<p><span style="font: 12pt Helvetica;">In the west when they dub a movie, they generally try to find people to do the voices who sound a bit like the actors voice which they are going to play. For instance if they were going to dub Harry Potter, they would get some children of the correct sex to do the lines for the various kids in the local language. Not only do they not bother trying to match the actors age/sex/style over here, they don't even bother to get multiple actors to dub the lines. They get one person to basically read out the story over the top of the movie. Generally they don't even seem to be reading out the scene being played, although my grasp of Vietnamese is not good enough to swear that they are never in synch. It seems kind of ironic to me that in a country where wages are the smallest component of any type of business venture, they don't want to pay for more than one actor to dub a western movie.</span></p>
<p></p>
<p></p>
<p></p>
<p><span style="font: 12pt Helvetica;">I feel I have to share another of my dirty secrets with you all. I don't know what is about writing these emails that forces me to articulate my dirty secrets, but unfortunately that is just the way it is, you have to take the good with the bad...</span></p>
<p></p>
<p></p>
<p></p>
<p><span style="font: 12pt Helvetica;">I grew up as an rabid anti-colonialist. I hate the idea of the English or the Dutch, etc. sailing into some, so called savage country, and taking over in the name of civilization. Mostly civilization just builds a massive underclass which is thoroughly exploited to the benefit of those bringing civilization. While we were in Hue, however, we stayed at this amazingly plush hotel called La Residence. It was a bastion of French colonialism back before they had their asses kicked by Ho Chi Minh and the boys and it is filled with literature telling of how the filthy French exploited everyone and eventually got their just deserts.</span></p>
<p></p>
<p></p>
<p></p>
<p><span style="font: 12pt Helvetica;">This is the type of stuff which would usually have me nodding my head and completely sympathizing with the suppressed natives. But to my surprise I found myself imagining what the French reaction must have been when Ho Chi Minh and the fellas declared that they wanted the French to leave and that they could run the country themselves, thank you very much. They must have absolutely wet themselves laughing. Just imagine how humiliated and despondent they must have been to have their asses kicked by a couple of million Vietnamese who were still having problems with the concept of separating their sewage from their drinking water. You really have to admire the grit of the Vietnamese. It's just a little unfortunate that they won. Although, when you look at the chaos and number of deaths on the road over here you can definitely see the legacy of French colonialism is still alive and kicking.</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">Well, thats enough of my ramblings for now. I have to rest and compose myself for the Gala X edition. I am also going to start adding some photographic material and perhaps some slightly less vitriolic material here in case I ever end up in court and want to make myself appear to be a decent human being.</span></p>
<p></p>
<p></p>
</div>

<div class="journalentry">
<b>Date:</b> 23 May 2009<br>
<b>Time:</b> 12:19:23 AM<br>
<b>Topic:</b> Postcards From a Vietnam Labour Camp Pt VIII<br><br>
<p><span style="font: 12pt Helvetica;">It has been a while since my last postcard. Since then we have been up to Hue and Hoi An for a weeks holiday and countless bizarre and email worthy events have happened. I might break this up in to a couple of posts to try and distribute the tedium of reading each them over broader time period.</span></p>
<p></p>
<p></p>
<p></p>
<p><span style="font: 12pt Helvetica;">Something I have always been aware of, but never paid particular attention to, is the way that being in a group can lower individual IQs by a fairly significant amount. I estimate the drop, conservatively, at around 36 points. It seems to be across the board, pretty much everyone who is part of the group is effected, this is how stupid shit like the Cabramatta riots happens. People who weren't particularly bright to start off with, join up in a group, and are reduced to a thinking capacity so limited that they can't even work out that the car they are paint bombing or hitting with a baseball bat is, in fact, their own. This same phenomena can occur in really big checkin queues. For some people the IQ reduction brings them to a point where they no longer even understand what it means to checkin as a group.</span></p>
<p></p>
<p></p>
<p></p>
<p><span style="font: 12pt Helvetica;">We had the misfortune to be in a checkin queue at the HCMC airport which was big enough to have a noticeable effect on IQs. Vietnamese queueing behaviour is pretty unpleasant at the best of times, but when IQs drop past a certain level some really hilarious shit starts happening. I have witnessed people who are not even checking in, push to the front of the checkin queue and start up a 5+ minute discussion with the staff member who is supposed to be checking in people's baggage. The fact that the staff here are so poorly trained that instead of ignoring these idiots and doing their job, they actually engage in conversation and stop processing the already enormous queue, is testimony to the fact that either the airlines are hiring straight out of special school or that the checkin staff are effected by the IQ lowering phenomena also.</span></p>
<p></p>
<p></p>
<p></p>
<p><span style="font: 12pt Helvetica;">On this day we had the tape strips and poles up, creating about 6 or 7 rows and hairpin turns to negotiate before you got to the counter. We were about 1 row from the front when I noticed a Vietnamese lady doing the usual shit they do over here, basically pushing as far to the front as they can get until someone forces them to stop. They routinely push forward like this until someone gives them a firm elbow or punches them. Once this has happened they behave themselves for a brief period of time and don't appear to hold a grudge against the person who, admittedly with proper cause, just gave them a good belting. But innevitably they will go for it again.</span></p>
<p></p>
<p></p>
<p></p>
<p><span style="font: 12pt Helvetica;">This lady tried to make it past Lily, Jac and I, and frankly after waiting 20 minutes already I wasn't in the mood to let it go. I put my arm out and stopped her "I don't suppose you noticed this enormous queue"? I asked gesturing to the crowd behind us which looked to me to be more people than the last Melbourne football game I went to (though I guess that isn't saying too much). Surprisingly she actually understood me and stopped. "I travel with people" she said gesturing forward. I looked at her dubiously since the indicated 2 people were just about to go to a checkin counter and didn't seem to notice that they had lost one of their group. I decided that there was no point in pursuing a conversation with her about it and turned away. She slipped forward a couple more places but didn't join her friends. Her friends were at the checkin as I turned back. I looked at her, she looked at me and I gestured to her friends, she gestured to the people in front of her as if they were restraining her at gun point.</span></p>
<p></p>
<p></p>
<p></p>
<p><span style="font: 12pt Helvetica;">So lets get this straight, she pushed past about 70 ppl, including me, because she is together with a group of people who are already checking in without her... maybe my IQ was being affected because that didn't make any sense to me, I decided to force her to go and check in with her supposed friends and perhaps explain to her that if she wasn't actually checking in with them, that their presence in the queue in front of her didn't endow her with any special privileges. Both the couple and her seemed pretty confused by the whole situation when I marched her up but I had little sympathy for them since I spend most of my time in Vietnam feeling that way.</span></p>
<p></p>
<p></p>
<p></p>
<p><span style="font: 12pt Helvetica;">After we had finally checked in and gotten to the departure lounge we sat down to wait for the boarding announcement. In English it sounds like they have the same boarding calls as they do in Australia and most other countries:</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">"We'd like to announce that flight xyz to blah di blah will be boarding shortly. Could elderly passengers, those with a disability, traveling with infants, or in need of assistance please proceed to gate blah di blah". Obviously the rich also count as disabled or needing assistance as first class and business class ticket holders are always included in there somewhere.</span></p>
<p></p>
<p></p>
<p></p>
<p><span style="font: 12pt Helvetica;">The Vietnamese version of the boarding call, however seems to include some extra parts which aren't in the English version. Judging by the passenger behaviour, I can only conclude that their version went something like this:</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">"We'd like to announce that flight xyz to blah di blah will be boarding shortly. Could  elderly passengers, those with a disability, traveling with infants, in need of assistance or who don't give a shit about trampling the elderly or disabled please proceed to gate blah di blah". Obviously, in Vietnam, that means everyone. Jacqui, Lily and I have taken to staying seated until the stampede has passed and the bodies of those unfortunate enough not to make it have been removed, then we board at a more leisurely pace.</span></p>
<p></p>
<p></p>
<p></p>
<p><span style="font: 12pt Helvetica;">As I mentioned earlier I'll break this up and send our Hue and Hoi An experiences and observations in the next postcard.</span></p>
<p></p>
<p></p>
</div>

<div class="journalentry">
<b>Date:</b> 23 May 2009<br>
<b>Time:</b> 1:01:58 AM<br>
<b>Topic:</b> Flex Authorize Tag<br><br>
<p><span style="font: 12pt Helvetica;">It is a very rare event when I am asked to code an application which doesn’t have some security constraints. Most Java MVC frameworks provide some type of role based security for the UI out of the box. No such thing exists in Flex. I decided, after casting about for an existing solution, to write an authorize tag for myself. This component has the following properties which need to be set:</span></p>
<p></p>
<ol style="list-style-type: decimal">
<li></li>
<li><span style="font: 12pt Helvetica;">roles - one or more roles (strings) which are to be evaluated against.</span></li>
<li></li>
<li></li>
<li><span style="font: 12pt Helvetica;">userRoles - one or more roles(strings) which the user has</span></li>
<li></li>
<li></li>
<li><span style="font: 12pt Helvetica;">components - one or more components which will be effected if evaluation of roles against userRoles fails.</span></li>
<li></li>
<li></li>
<li><span style="font: 12pt Helvetica;">type - type of evaluation to be performed one of: 
</span><ul style="list-style-type: circle">
<li></li>
<li><span style="font: 12pt Helvetica;">‘hasAny’ - evaluates true if userRole exists in any of the roles</span></li>
<li></li>
<li></li>
<li><span style="font: 12pt Helvetica;">‘hasAll,’ - evaluates to true only if userRoles contains all roles</span></li>
<li></li>
<li></li>
<li><span style="font: 12pt Helvetica;">‘hasNone’ - evaluates to true if userRoles does not contain any of the roles.</span></li>
<li></li>
</ul>
</li>
<li></li>
<li></li>
<li></li>
<li><span style="font: 12pt Helvetica;">behaviour - the behviour to be applied to the specified components: 
</span><ul style="list-style-type: circle">
<li></li>
<li><span style="font: 12pt Helvetica;">Disable - disables the components if evaluation fails</span></li>
<li></li>
<li></li>
<li><span style="font: 12pt Helvetica;">Vanish - causes the components visible property to be set to false if evaluation fails</span></li>
<li></li>
<li></li>
<li><span style="font: 12pt Helvetica;">Collapse - causes the components visible and includeInLayout properties to be set to false if evaluation fails</span></li>
<li></li>
</ul>
</li>
<li></li>
<li></li>
</ol>
<p></p>
<p><span style="font: 12pt Helvetica;">Here is the code, please feel free to copy it and use it. Any feedback would be appreciated:</span></p>
<p></p>
<p></p>
<p></p>
<p><span style="font: 12pt Helvetica;">package com.express.security {</span></p>
<p><span style="font: 12pt Helvetica;">import flash.events.Event;</span></p>
<p><span style="font: 12pt Helvetica;">import flash.events.EventDispatcher;</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">import mx.collections.ArrayCollection;</span></p>
<p><span style="font: 12pt Helvetica;">import mx.collections.ICollectionView;</span></p>
<p><span style="font: 12pt Helvetica;">import mx.collections.IList;</span></p>
<p><span style="font: 12pt Helvetica;">import mx.collections.ListCollectionView;</span></p>
<p><span style="font: 12pt Helvetica;">import mx.collections.XMLListCollection;</span></p>
<p><span style="font: 12pt Helvetica;">import mx.core.UIComponent;</span></p>
<p><span style="font: 12pt Helvetica;">import mx.events.CollectionEvent;</span></p>
<p><span style="font: 12pt Helvetica;">import mx.events.FlexEvent;</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">public class Authorize extends EventDispatcher{</span></p>
<p></p>
<p>   <span style="font: 12pt Helvetica;">public static const HAS_ANY : String = "hasAny";</span></p>
<p>   <span style="font: 12pt Helvetica;">public static const HAS_ALL : String = "hasAll";</span></p>
<p>   <span style="font: 12pt Helvetica;">public static const HAS_NONE : String = "hasNone";</span></p>
<p></p>
<p>   <span style="font: 12pt Helvetica;">public static const DISABLE : String = "disable";</span></p>
<p>   <span style="font: 12pt Helvetica;">public static const VANISH : String = "vanish";</span></p>
<p>   <span style="font: 12pt Helvetica;">public static const COLLAPSE : String = "collapse";</span></p>
<p>   <span style="font: 12pt Helvetica;">private static const BEHAVIOUR_ENUM : String = DISABLE + "," + VANISH + "," + COLLAPSE;</span></p>
<p></p>
<p>   <span style="font: 12pt Helvetica;">/**</span></p>
<p>    <span style="font: 12pt Helvetica;">* Roles which will be evaluated against the type rules and user's roles.</span></p>
<p>    <span style="font: 12pt Helvetica;">*/</span></p>
<p>   <span style="font: 12pt Helvetica;">private var _roles : ICollectionView;</span></p>
<p></p>
<p>   <span style="font: 12pt Helvetica;">/**</span></p>
<p>    <span style="font: 12pt Helvetica;">* Roles which the current user has. These will be evauated aginst the type rules and roles.</span></p>
<p>    <span style="font: 12pt Helvetica;">*/</span></p>
<p>   <span style="font: 12pt Helvetica;">private var _userRoles : ICollectionView;</span></p>
<p></p>
<p>   <span style="font: 12pt Helvetica;">/**</span></p>
<p>    <span style="font: 12pt Helvetica;">* Components which will have behaviour applied to them based on the evaluation outcome.</span></p>
<p>    <span style="font: 12pt Helvetica;">*/</span></p>
<p>   <span style="font: 12pt Helvetica;">private var _components : ICollectionView;</span></p>
<p></p>
<p>   <span style="font: 12pt Helvetica;">/**</span></p>
<p>    <span style="font: 12pt Helvetica;">* Specifies the type of evaluation which will be applied to the roles</span></p>
<p>    <span style="font: 12pt Helvetica;">*/</span></p>
<p>   <span style="font: 12pt Helvetica;">[Inspectable(enumeration="hasAny,hasAll,hasNone")]</span></p>
<p>   <span style="font: 12pt Helvetica;">public var type : String;</span></p>
<p></p>
<p>   <span style="font: 12pt Helvetica;">/**</span></p>
<p>    <span style="font: 12pt Helvetica;">* Specifies the type of evaluation which will be applied to the roles</span></p>
<p>    <span style="font: 12pt Helvetica;">*/</span></p>
<p>   <span style="font: 12pt Helvetica;">[Inspectable(enumeration="disable,vanish,collapse")]</span></p>
<p>   <span style="font: 12pt Helvetica;">public var behaviour : String;</span></p>
<p></p>
<p>   <span style="font: 12pt Helvetica;">public function Authorize() {</span></p>
<p>      <span style="font: 12pt Helvetica;">super();</span></p>
<p>      <span style="font: 12pt Helvetica;">addEventListener(FlexEvent.CREATION_COMPLETE, handleCreationComplete);</span></p>
<p>   <span style="font: 12pt Helvetica;">}</span></p>
<p></p>
<p>   <span style="font: 12pt Helvetica;">private function handleCreationComplete(event : FlexEvent) : void {</span></p>
<p>      <span style="font: 12pt Helvetica;">evaluate();</span></p>
<p>   <span style="font: 12pt Helvetica;">}</span></p>
<p></p>
<p>   <span style="font: 12pt Helvetica;">public function evaluate() : void {</span></p>
<p>      <span style="font: 12pt Helvetica;">var result : Boolean = false;</span></p>
<p>      <span style="font: 12pt Helvetica;">if (_roles != null &amp;&amp; _userRoles != null &amp;&amp; type != null) {</span></p>
<p>         <span style="font: 12pt Helvetica;">if (type == HAS_ANY) {</span></p>
<p>            <span style="font: 12pt Helvetica;">result = evaluateAny();</span></p>
<p>         <span style="font: 12pt Helvetica;">}</span></p>
<p>         <span style="font: 12pt Helvetica;">else if (type == HAS_ALL) {</span></p>
<p>            <span style="font: 12pt Helvetica;">result = evaluateAll();</span></p>
<p>         <span style="font: 12pt Helvetica;">}</span></p>
<p>         <span style="font: 12pt Helvetica;">else if (type == HAS_NONE) {</span></p>
<p>            <span style="font: 12pt Helvetica;">result = evaluateNone();</span></p>
<p>         <span style="font: 12pt Helvetica;">}</span></p>
<p>      <span style="font: 12pt Helvetica;">}</span></p>
<p>      <span style="font: 12pt Helvetica;">applyResult(result);</span></p>
<p>   <span style="font: 12pt Helvetica;">}</span></p>
<p></p>
<p>   <span style="font: 12pt Helvetica;">protected function evaluateAny() : Boolean {</span></p>
<p>      <span style="font: 12pt Helvetica;">for each(var userRole : String in _userRoles) {</span></p>
<p>         <span style="font: 12pt Helvetica;">if (containsRole(_roles, userRole)) {</span></p>
<p>            <span style="font: 12pt Helvetica;">return true;</span></p>
<p>         <span style="font: 12pt Helvetica;">}</span></p>
<p>      <span style="font: 12pt Helvetica;">}</span></p>
<p>      <span style="font: 12pt Helvetica;">return false;</span></p>
<p>   <span style="font: 12pt Helvetica;">}</span></p>
<p></p>
<p>   <span style="font: 12pt Helvetica;">protected function evaluateAll() : Boolean {</span></p>
<p>      <span style="font: 12pt Helvetica;">for each(var userRole : String in _userRoles) {</span></p>
<p>         <span style="font: 12pt Helvetica;">if (!containsRole(_roles, userRole)) {</span></p>
<p>            <span style="font: 12pt Helvetica;">return false;</span></p>
<p>         <span style="font: 12pt Helvetica;">}</span></p>
<p>      <span style="font: 12pt Helvetica;">}</span></p>
<p>      <span style="font: 12pt Helvetica;">return true;</span></p>
<p>   <span style="font: 12pt Helvetica;">}</span></p>
<p></p>
<p>   <span style="font: 12pt Helvetica;">protected function evaluateNone() : Boolean {</span></p>
<p>      <span style="font: 12pt Helvetica;">for each(var userRole : String in _userRoles) {</span></p>
<p>         <span style="font: 12pt Helvetica;">if (containsRole(_roles, userRole)) {</span></p>
<p>            <span style="font: 12pt Helvetica;">return false;</span></p>
<p>         <span style="font: 12pt Helvetica;">}</span></p>
<p>      <span style="font: 12pt Helvetica;">}</span></p>
<p>      <span style="font: 12pt Helvetica;">return true;</span></p>
<p>   <span style="font: 12pt Helvetica;">}</span></p>
<p></p>
<p>   <span style="font: 12pt Helvetica;">protected function containsRole(roles : ICollectionView, role : String) : Boolean {</span></p>
<p>      <span style="font: 12pt Helvetica;">for each(var userRole : String in roles) {</span></p>
<p>         <span style="font: 12pt Helvetica;">if (role == userRole) {</span></p>
<p>            <span style="font: 12pt Helvetica;">return true;</span></p>
<p>         <span style="font: 12pt Helvetica;">}</span></p>
<p>      <span style="font: 12pt Helvetica;">}</span></p>
<p>      <span style="font: 12pt Helvetica;">return false;</span></p>
<p>   <span style="font: 12pt Helvetica;">}</span></p>
<p></p>
<p>   <span style="font: 12pt Helvetica;">protected function applyResult(result : Boolean) : void {</span></p>
<p>      <span style="font: 12pt Helvetica;">for each(var comp : UIComponent in _components) {</span></p>
<p>         <span style="font: 12pt Helvetica;">switch(behaviour) {</span></p>
<p>            <span style="font: 12pt Helvetica;">case DISABLE :</span></p>
<p>               <span style="font: 12pt Helvetica;">comp.enabled = result;</span></p>
<p>               <span style="font: 12pt Helvetica;">break;</span></p>
<p>            <span style="font: 12pt Helvetica;">case VANISH :</span></p>
<p>               <span style="font: 12pt Helvetica;">comp.visible = result;</span></p>
<p>               <span style="font: 12pt Helvetica;">break;</span></p>
<p>            <span style="font: 12pt Helvetica;">case COLLAPSE :</span></p>
<p>               <span style="font: 12pt Helvetica;">comp.visible = result;</span></p>
<p>               <span style="font: 12pt Helvetica;">comp.includeInLayout = result;</span></p>
<p>         <span style="font: 12pt Helvetica;">}</span></p>
<p>      <span style="font: 12pt Helvetica;">}</span></p>
<p>   <span style="font: 12pt Helvetica;">}</span></p>
<p></p>
<p>   <span style="font: 12pt Helvetica;">public function get roles():Object {</span></p>
<p>      <span style="font: 12pt Helvetica;">return _roles;</span></p>
<p>   <span style="font: 12pt Helvetica;">}</span></p>
<p></p>
<p>   <span style="font: 12pt Helvetica;">public function set roles(val:Object):void {</span></p>
<p>      <span style="font: 12pt Helvetica;">_roles = convertToCollection(val);</span></p>
<p>      <span style="font: 12pt Helvetica;">evaluate();</span></p>
<p>   <span style="font: 12pt Helvetica;">}</span></p>
<p></p>
<p>   <span style="font: 12pt Helvetica;">public function get userRoles():Object {</span></p>
<p>      <span style="font: 12pt Helvetica;">return _userRoles;</span></p>
<p>   <span style="font: 12pt Helvetica;">}</span></p>
<p></p>
<p>   <span style="font: 12pt Helvetica;">public function set userRoles(val:Object):void {</span></p>
<p>      <span style="font: 12pt Helvetica;">_userRoles = convertToCollection(val);</span></p>
<p>      <span style="font: 12pt Helvetica;">_userRoles.addEventListener(CollectionEvent.COLLECTION_CHANGE, handleCollectionChange, false, 0, true);</span></p>
<p>      <span style="font: 12pt Helvetica;">evaluate();</span></p>
<p>   <span style="font: 12pt Helvetica;">}</span></p>
<p></p>
<p>   <span style="font: 12pt Helvetica;">public function get components():Object {</span></p>
<p>      <span style="font: 12pt Helvetica;">return _components;</span></p>
<p>   <span style="font: 12pt Helvetica;">}</span></p>
<p></p>
<p>   <span style="font: 12pt Helvetica;">public function set components(val:Object):void {</span></p>
<p>      <span style="font: 12pt Helvetica;">_components = convertToCollection(val);</span></p>
<p>      <span style="font: 12pt Helvetica;">_components.addEventListener(CollectionEvent.COLLECTION_CHANGE, handleCollectionChange, false, 0, true);</span></p>
<p>      <span style="font: 12pt Helvetica;">evaluate();</span></p>
<p>   <span style="font: 12pt Helvetica;">}</span></p>
<p></p>
<p>   <span style="font: 12pt Helvetica;">private function handleCollectionChange(event : Event) : void {</span></p>
<p>      <span style="font: 12pt Helvetica;">evaluate();</span></p>
<p>   <span style="font: 12pt Helvetica;">}</span></p>
<p></p>
<p>   <span style="font: 12pt Helvetica;">public function convertToCollection(value : Object) : ICollectionView {</span></p>
<p>      <span style="font: 12pt Helvetica;">if (value is Array) {</span></p>
<p>         <span style="font: 12pt Helvetica;">return new ArrayCollection(value as Array);</span></p>
<p>      <span style="font: 12pt Helvetica;">}</span></p>
<p>      <span style="font: 12pt Helvetica;">else if (value is ICollectionView) {</span></p>
<p>         <span style="font: 12pt Helvetica;">return ICollectionView(value);</span></p>
<p>      <span style="font: 12pt Helvetica;">}</span></p>
<p>      <span style="font: 12pt Helvetica;">else if (value is IList) {</span></p>
<p>         <span style="font: 12pt Helvetica;">return new ListCollectionView(IList(value));</span></p>
<p>      <span style="font: 12pt Helvetica;">}</span></p>
<p>      <span style="font: 12pt Helvetica;">else if (value is XMLList) {</span></p>
<p>         <span style="font: 12pt Helvetica;">return new XMLListCollection(value as XMLList);</span></p>
<p>      <span style="font: 12pt Helvetica;">}</span></p>
<p>      <span style="font: 12pt Helvetica;">else {</span></p>
<p>         <span style="font: 12pt Helvetica;">// convert it to an array containing this one item</span></p>
<p>         <span style="font: 12pt Helvetica;">var tmp:Array = [value];</span></p>
<p>         <span style="font: 12pt Helvetica;">return new ArrayCollection(tmp);</span></p>
<p>      <span style="font: 12pt Helvetica;">}</span></p>
<p>   <span style="font: 12pt Helvetica;">}</span></p>
<p><span style="font: 12pt Helvetica;">}</span></p>
<p><span style="font: 12pt Helvetica;">}</span></p>
<p></p>
<p></p>
</div>

<div class="journalentry">
<b>Date:</b> 1 May 2009<br>
<b>Time:</b> 12:13:49 PM<br>
<b>Topic:</b> Migrated Technical Blog<br><br>
<p><span style="font: 12pt Helvetica;">Hi all. I have migrated my technical blog to </span><span style="font: 12pt Helvetica; text-decoration: underline;"><a href="http://www.redredred.com.au/">redredred</a></span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">From now on I am only going to use this blog for personal and non-technical posts.</span></p>
<p></p>
</div>

<div class="journalentry">
<b>Date:</b> 1 April 2009<br>
<b>Time:</b> 6:18:51 PM<br>
<b>Topic:</b> Postcards From a Vietnam Labour Camp pt VII<br><br>
<p><span style="font: 12pt Helvetica;">Vietnamese people have a radically different world view to that of the average Australian. Buddha and luck rules virtually everything that happens in their world. Every shop has a shrine to Buddha, usually with some disco lights around the outside and incense burning on the inside, often with some food or drink in there. I am almost afraid to ask what the reason for this is, I can only assume that Buddha, being such a hearty fellow, is in need of constant snack options and his spirit wanders around Vietnam pigging out on these little goodies. Presumably after a good feed he is then in the right frame of mind for bestowing some good luck on the shop which fed him, in the form of business.</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">Even the act of driving to work involves a fair bit of faith and a great deal of luck. You can tell by the way that they drive that they generally don't experience themselves as responsible for, or able to control in any way, the total chaos which is a Vietnamese road. When a truck comes up behind a motorcycle, doing 5 km/hour down the middle of the road, zigzagging around in the usual way, which could be due to complete confusion about where the hell they are going or how to operate their vehicle, or a very clever tactic for avoiding missile lock from any US jet fighters which may not yet know that the war finished quite some time ago, they usually sound their air horn at around 1000db. The bike rider's usual response to that is either to completely ignore the ear shattering blast and go on attempting to avoid missile lock or else to look over their shoulder with an amazingly mild expression which seems to say "Gosh your having a bit of bad luck right now aren't you? I hope things work out better for you soon".</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">If this scene was in virtually anywhere else in the world, the truck driver would probably get out of his truck with a large iron bar, run up to the retarded bike rider, and beat him savagely about the head. If I were a jury member on the aforesaid truck driver's trial I would be forced to acquit based on reasonable cause. Over here the truck driver just keeps on honking his horn with a resigned look on his face which seems to say "This is a very unlucky day for me, I wish I had offered some chocolate doughnuts in the disco shrine this morning".</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">It should be noted that the truck driver is not the only one experiencing this bad luck, since his horn is so tremendously loud and unpleasant that anyone living within a Kilometer is unlikely to experience any of the inner harmony that worshiping Buddha is supposed to bring. In fact the chances of successfully meditating during one of these constant truck horn shit storms has got to be close to zero. This goes some way to explaining the confused approach to Buddhism, demonstrated by the Vietnamese, which appears to have nothing whatsoever to do with Buddha's teachings.</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">My irony meter is permanently redlining over here. Every drive I take and most of my work interactions are so heavily peppered with ironic content it is amazing that I am not permanently sneezing! The unfortunate thing is that most of the time there is no-one nearby that I can share with. Never-mind, it doesn't stop them from being funny.</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">This morning for instance I saw a bag lady walking down the street. Now in a country where over 80% of the people can't afford to run an air-conditioner you might think it is hard to identify a bag lady, but actually the social structure is as obvious here as anywhere I've been. Poor (relative to local standards) people just look poor. Poor women, for instance, almost uniformly wear these shockingly floral matching pants and tank-top outfits. It is possible that after the war all the female Viet Cong traded in their black pajamas for a floral matching pants suit and they are still wearing the same ones today.</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">Down from that level are the bag ladies/men and beggars. They tend to abandon tradition and where absolutely any scungy rag they can find. This particular lady drew my attention. She was not wearing the traditional floral pants suit but instead had obviously thrown together the identifying ad hoc outfit made up of the cheapest crap she could get her hands on. She had the standard, almost offensively bright, floral pants on but a tan coloured sheer top, so sheer in fact that I can't bring myself to describe in words the front view as she passed me. The rear view, however was what awoke my sense of irony as realized that the cheapest piece of crap that she could lay her hands on was in fact a Dolce &amp; Gabana top with the D &amp; G stitched in in diamantes down the back.</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">My ultimate irony however, and one that I can scarcely imagine being topped in this lifetime, is that Lily appears to be learning the words 'fuck' and 'shit' not from me, but from JACQUI!!! It's not that I am actively trying to repress my naturally foul mouth in front of Lily, but for some reason I just don't seem to feel the inclination to swear when she is around. Jac on the other hand is around her a lot more than me during the day and I guess has more opportunity. She dropped something and broke it the other day and said 'fuck"! Lily who was running around my feet at the time looked up at me and said "fuck daddy". I just about wet my pants!</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">Well, I guess that is enough of my pointless observations for now, talk to you all again soon.</span></p>
<p></p>
</div>

<div class="journalentry">
<b>Date:</b> 25 February 2009<br>
<b>Time:</b> 6:12:31 PM<br>
<b>Topic:</b> Postcards From a Vietnam Labour Camp pt VI<br><br>
<p><span style="font: 12pt Helvetica;">Vietnamese people have a cultural blind spot (at least one), centered on the use of lifts. Of course in Australia our ancestors have been using lifts for at least 2 generations and we are born with the genetic blueprint necessary to know instinctively that if we are waiting for a lift and we want to go up we push the up button. Conversely, if we want to go down we push the... you guessed it, the down button. That tiny, yet significant piece of genetic code is missing in the typical Vietnamese person. Roughly half the people in our building look at where the lift is, if it is above them, they push the down button to order it down to them, even if they want to go up. If it is below them they push the up button for the same reason. Once they get in they do understand that they have to push the floor number which they want to get off at, however, if they are going to the ground they can often end up taking a trip to the top floor on their way.</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">Because of this, the lifts are rarely empty. I often get into a downward traveling lift at my floor (9) and see that the 11th and 12th floor button has been pushed. My Vietnamese is still insufficient to explain to these lost souls how to use the lift buttons correctly. I did however have a go at using my mime skills to explain to an old lady on the ground floor how it all works... Lets just say that neither of us really got satisfaction from that little exercise. There must be some offensive Vietnamese gesture that looks a bit like pushing an imaginary lift button and pointing up. I'm just glad she didn't call the cops.</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">Our building has cable TV. There are 70 odd channels, although only about 20 or so work. In Vietnamese terms that is an extremely high success rate. There are 3 functioning movie channels which is really great. I am finally catching up on all the shitty movies I missed out on seeing in the nineties. At this stage of the game Jac &amp; I don't even bother bagging the movies when they finish. The cable channels are even aware of how shitty the movies are and don't bother playing the titles, they cut straight to an ad. We just turn the TV off quietly and try to erase the whole sordid experience from our minds by pretending we were just sitting on the couch in the darkness. Sometimes after we go to bed I have flashbacks and wake up in a cold sweat with some ridiculous line echoing in my ears and wonder whether the Americans aren't still waging a slightly more subtle war over here with the cable TV channels as their new 'Advisors'.</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">Lately I have been trying to work out what the point of number plates are over here. In most western countries they are used to ensure the roadworthiness of vehicles on the road. Over here they seem to be purely ornamentation. Many of the vehicles on the road have got to be seen to be believed. They look like the bastard offspring of a motor-bike and a scrap metal yard. I often see them shedding parts of themselves as they chug down the road. My personal favourites are the Vietnamese equivalent of Mr Whippee vans. Essentially a pushbike or motor scooter with a small shop welded to the side of it. They generally sell unspeakable dishes (both literally and figuratively) and their enormous weight must make it so hard to overcome inertia on that once they start moving the owner will not stop, no matter what obstruction stands in their way. </span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">I remember a scene from Apocalypse Now where Vietnamese propaganda is played over a loud speaker into the night to scare the GIs and inspire the locals. The Mr Whippee vans sound exactly like that, they have motorbike batteries powering their megaphones and instead of music they blare out Vietnamese propaganda messages (or perhaps, if one could understand it, it is a flashy sales pitch for their hideous merchandise). People over here regularly stop in the middle of the road to have a conversation on their mobile phones, the one thing which will get these idiots to move is on of these food vendors banging down the road, blaring something unintelligible from their megaphones... every cloud has a silver lining, eh?</span></p>
<p></p>
</div>

<div class="journalentry">
<b>Date:</b> 25 February 2009<br>
<b>Time:</b> 1:53:43 AM<br>
<b>Topic:</b> Integrating Spring Security with BlazeDS and Flex RIAs<br><br>
<p><span style="font: 12pt Helvetica;">I have found a couple of tutorials on this lying around the web, however they all take slightly different approaches, and although the information was useful, I think there is a cleaner way to do the integration. Keeping in mind of course that now that the spring guys have released the spring-flex module there will hopefully be complete integration with Spring Security soon without the need to even wire it up the way I describe here.</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">What I am going to describe here uses:</span></p>
<p></p>
<ul style="list-style-type: disc">
<li></li>
<li><span style="font: 12pt Helvetica;">Spring 2.5.5</span></li>
<li></li>
<li></li>
<li><span style="font: 12pt Helvetica;">Spring-Security 2.0.4 (core &amp; tiger)</span></li>
<li></li>
<li></li>
<li><span style="font: 12pt Helvetica;">BlazeDS 3.2</span></li>
<li></li>
<li></li>
<li><span style="font: 12pt Helvetica;">Flex3</span></li>
<li></li>
</ul>
<p></p>
<p><span style="font: 12pt Helvetica;">My approach is not to protect end-points using BlazeDs's security. The reason is that I often expose my services as web services as well as AMF endpoints and I don't want to create my security mappings twice. Instead I use method invocation based security and protect the services directly. All that BlazeDS needs to do is get the users credentials out of the request and delegate to SpingSecurity to create a SecureContext, authenticate and put the authentication object in the SecureContext (effectively thread local). After that normal Spring Security applies and secure methods will be protected in the normal way.</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">A typical security scenario in one of my applications goes something like this: Either none of the application or a small part of the application is available anonymously as is the login service. Users access them without credentials, usually the User doesn't even have menu options to navigate to UI areas with secure functions until they have logged in. After a successful login I will cache the user's credentials on the client and re-log them in on each service request. This keeps the server completely stateless, all state is stored on the client. I configure a lightweight cache on the server since if someone logs in once they will likely make many more login requests (one for every service they are going to use). This reduces database hits. I implement a service registry on the client which stores the credentials and automatically adds them to all RemoteObjects and HttpServices.</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">I'm going to work this assuming that you already have a Flex/BlazeDS/Spring application going. It can be as simple as hello world, there is an excellent article on how to do this using the new spring-flex solution </span><span style="font: 12pt Helvetica; text-decoration: underline;"><a href="http://blog.springsource.com/2008/12/17/using-spring-blazeds-integration-m1/?__utma=1.4375592336291106000.1229564509.1229564509.1229564509.1&__utmb=1.2.10.1229564509&__utmc=1&__utmx=-&__utmz=1.1229564509.1.1.utmcsr=(direct)|utmccn=(direct)|utmcmd=(none)&__utmv=-&__utmk=181422887">here</a></span> <span style="font: 12pt Helvetica;">. The way that i am applying security means that it is largely irrelevent whether you are using the Adobe SpringFactory or the spring-flex </span><span style="font: 12pt Helvetica; color: rgb(36,0,255);">MessageBrokerHandlerAdapter.</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;"><strong>Step1.</strong> Add spring-security to your web application's lib my pom entry looks like this:</span></p>
<p></p>
<p><span style="font: 12pt Helvetica; color: rgb(8,110,109);">&lt;</span><span style="font: 12pt Helvetica; color: rgb(49,109,108);">dependency</span><span style="font: 12pt Helvetica; color: rgb(8,110,109);">&gt;</span></p>
<p></p>
<p>   <span style="font: 12pt Helvetica;"></span><span style="font: 12pt Helvetica; color: rgb(8,110,109);">&lt;</span><span style="font: 12pt Helvetica; color: rgb(49,109,108);">groupId</span><span style="font: 12pt Helvetica; color: rgb(8,110,109);">&gt;</span><span style="font: 12pt Helvetica;">org.springframework.security</span><span style="font: 12pt Helvetica; color: rgb(8,110,109);">&lt;/</span><span style="font: 12pt Helvetica; color: rgb(49,109,108);">groupId</span><span style="font: 12pt Helvetica; color: rgb(8,110,109);">&gt;</span></p>
<p></p>
<p>   <span style="font: 12pt Helvetica;"></span><span style="font: 12pt Helvetica; color: rgb(8,110,109);">&lt;</span><span style="font: 12pt Helvetica; color: rgb(49,109,108);">artifactId</span><span style="font: 12pt Helvetica; color: rgb(8,110,109);">&gt;</span><span style="font: 12pt Helvetica;">spring-security-core</span><span style="font: 12pt Helvetica; color: rgb(8,110,109);">&lt;/</span><span style="font: 12pt Helvetica; color: rgb(49,109,108);">artifactId</span><span style="font: 12pt Helvetica; color: rgb(8,110,109);">&gt;</span></p>
<p></p>
<p>   <span style="font: 12pt Helvetica;"></span><span style="font: 12pt Helvetica; color: rgb(8,110,109);">&lt;</span><span style="font: 12pt Helvetica; color: rgb(49,109,108);">version</span><span style="font: 12pt Helvetica; color: rgb(8,110,109);">&gt;</span><span style="font: 12pt Helvetica;">2.0.4</span><span style="font: 12pt Helvetica; color: rgb(8,110,109);">&lt;/</span><span style="font: 12pt Helvetica; color: rgb(49,109,108);">version</span><span style="font: 12pt Helvetica; color: rgb(8,110,109);">&gt;</span></p>
<p></p>
<p>  <span style="font: 12pt Helvetica;"></span> <span style="font: 12pt Helvetica; color: rgb(49,109,108);"></span><span style="font: 12pt Helvetica; color: rgb(8,110,109);">&lt;/</span><span style="font: 12pt Helvetica; color: rgb(49,109,108);">dependency</span><span style="font: 12pt Helvetica; color: rgb(8,110,109);">&gt;</span></p>
<p></p>
<p><span style="font: 12pt Helvetica; color: rgb(8,110,109);">&lt;</span><span style="font: 12pt Helvetica; color: rgb(49,109,108);">dependency</span><span style="font: 12pt Helvetica; color: rgb(8,110,109);">&gt;</span></p>
<p></p>
<p><span style="font: 12pt Helvetica; color: rgb(8,110,109);">&lt;</span><span style="font: 12pt Helvetica; color: rgb(49,109,108);">groupId</span><span style="font: 12pt Helvetica; color: rgb(8,110,109);">&gt;</span><span style="font: 12pt Helvetica;">org.springframework.security</span><span style="font: 12pt Helvetica; color: rgb(8,110,109);">&lt;/</span><span style="font: 12pt Helvetica; color: rgb(49,109,108);">groupId</span><span style="font: 12pt Helvetica; color: rgb(8,110,109);">&gt;</span></p>
<p></p>
<p><span style="font: 12pt Helvetica; color: rgb(8,110,109);">&lt;</span><span style="font: 12pt Helvetica; color: rgb(49,109,108);">artifactId</span><span style="font: 12pt Helvetica; color: rgb(8,110,109);">&gt;</span><span style="font: 12pt Helvetica;">spring-security-core-tiger</span><span style="font: 12pt Helvetica; color: rgb(8,110,109);">&lt;/</span><span style="font: 12pt Helvetica; color: rgb(49,109,108);">artifactId</span><span style="font: 12pt Helvetica; color: rgb(8,110,109);">&gt;</span></p>
<p></p>
<p><span style="font: 12pt Helvetica; color: rgb(8,110,109);">&lt;</span><span style="font: 12pt Helvetica; color: rgb(49,109,108);">version</span><span style="font: 12pt Helvetica; color: rgb(8,110,109);">&gt;</span><span style="font: 12pt Helvetica;">2.0.4</span><span style="font: 12pt Helvetica; color: rgb(8,110,109);">&lt;/</span><span style="font: 12pt Helvetica; color: rgb(49,109,108);">version</span><span style="font: 12pt Helvetica; color: rgb(8,110,109);">&gt;</span></p>
<p></p>
<p><span style="font: 12pt Helvetica; color: rgb(8,110,109);">&lt;/</span><span style="font: 12pt Helvetica; color: rgb(49,109,108);">dependency</span><span style="font: 12pt Helvetica; color: rgb(8,110,109);">&gt;</span></p>
<p></p>
<p>   <span style="font: 12pt Helvetica;"></span><span style="font: 12pt Helvetica; color: rgb(8,110,109);">&lt;/</span><span style="font: 12pt Helvetica; color: rgb(49,109,108);">dependencies</span><span style="font: 12pt Helvetica; color: rgb(8,110,109);">&gt;</span></p>
<p><span style="font: 12pt Helvetica;"><strong>Step2.</strong> Add the spring security filter to your web.xml</span></p>
<p></p>
<p><span style="font: 12pt Helvetica; color: rgb(8,110,109);">&lt;</span><span style="font: 12pt Helvetica; color: rgb(49,109,108);">filter</span><span style="font: 12pt Helvetica; color: rgb(8,110,109);">&gt;</span></p>
<p></p>
<p><span style="font: 12pt Helvetica; color: rgb(8,110,109);">&lt;</span><span style="font: 12pt Helvetica; color: rgb(49,109,108);">filter-name</span><span style="font: 12pt Helvetica; color: rgb(8,110,109);">&gt;</span><span style="font: 12pt Helvetica;">springSecurityFilterChain</span><span style="font: 12pt Helvetica; color: rgb(8,110,109);">&lt;/</span><span style="font: 12pt Helvetica; color: rgb(49,109,108);">filter-name</span><span style="font: 12pt Helvetica; color: rgb(8,110,109);">&gt;</span></p>
<p></p>
<p><span style="font: 12pt Helvetica; color: rgb(8,110,109);">&lt;</span><span style="font: 12pt Helvetica; color: rgb(49,109,108);">filter-class</span><span style="font: 12pt Helvetica; color: rgb(8,110,109);">&gt;</span><span style="font: 12pt Helvetica; text-decoration: underline;">org</span><span style="font: 12pt Helvetica;">.</span><span style="font: 12pt Helvetica; text-decoration: underline;">springframework</span><span style="font: 12pt Helvetica;">.web.filter.DelegatingFilterProxy</span><span style="font: 12pt Helvetica; color: rgb(8,110,109);">&lt;/</span><span style="font: 12pt Helvetica; color: rgb(49,109,108);">filter-class</span><span style="font: 12pt Helvetica; color: rgb(8,110,109);">&gt;</span></p>
<p></p>
<p><span style="font: 12pt Helvetica; color: rgb(8,110,109);">&lt;/</span><span style="font: 12pt Helvetica; color: rgb(49,109,108);">filter</span><span style="font: 12pt Helvetica; color: rgb(8,110,109);">&gt;</span></p>
<p></p>
<p></p>
<p></p>
<p><span style="font: 12pt Helvetica; color: rgb(8,110,109);">&lt;</span><span style="font: 12pt Helvetica; color: rgb(49,109,108);">filter-mapping</span><span style="font: 12pt Helvetica; color: rgb(8,110,109);">&gt;</span></p>
<p></p>
<p><span style="font: 12pt Helvetica; color: rgb(8,110,109);">&lt;</span><span style="font: 12pt Helvetica; color: rgb(49,109,108);">filter-name</span><span style="font: 12pt Helvetica; color: rgb(8,110,109);">&gt;</span><span style="font: 12pt Helvetica;">springSecurityFilterChain</span><span style="font: 12pt Helvetica; color: rgb(8,110,109);">&lt;/</span><span style="font: 12pt Helvetica; color: rgb(49,109,108);">filter-name</span><span style="font: 12pt Helvetica; color: rgb(8,110,109);">&gt;</span></p>
<p></p>
<p><span style="font: 12pt Helvetica; color: rgb(8,110,109);">&lt;</span><span style="font: 12pt Helvetica; color: rgb(49,109,108);">url-pattern</span><span style="font: 12pt Helvetica; color: rgb(8,110,109);">&gt;</span><span style="font: 12pt Helvetica;">/data/</span><span style="font: 12pt Helvetica; text-decoration: underline;">messagebroker</span><span style="font: 12pt Helvetica;">/*</span><span style="font: 12pt Helvetica; color: rgb(8,110,109);">&lt;/</span><span style="font: 12pt Helvetica; color: rgb(49,109,108);">url-pattern</span><span style="font: 12pt Helvetica; color: rgb(8,110,109);">&gt;</span></p>
<p></p>
<p><span style="font: 12pt Helvetica; color: rgb(8,110,109);">&lt;/</span><span style="font: 12pt Helvetica; color: rgb(49,109,108);">filter-mapping</span><span style="font: 12pt Helvetica; color: rgb(8,110,109);">&gt;</span></p>
<p><span style="font: 12pt Helvetica;">This will secure everything and is mostly necessary if you are going to use other transports than just AMF via BlazeDS.</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;"><strong>Step3.</strong> Configure Spring Security. I am just going to put a very basic config here. For details on configuring spring security you can look at the spring security documentation </span><span style="font: 12pt Helvetica; text-decoration: underline;"><a href="http://static.springframework.org/spring-security/site/reference/html/">here</a></span></p>
<p></p>
<p><span style="font: 12pt Helvetica; color: rgb(8,110,109);">&lt;</span><span style="font: 12pt Helvetica; color: rgb(49,109,108);">security:http </span><span style="font: 12pt Helvetica; color: rgb(108,0,109);">auto-config</span><span style="font: 12pt Helvetica;">=</span><span style="font: 12pt Helvetica; color: rgb(36,0,255);">"true"</span><span style="font: 12pt Helvetica; color: rgb(8,110,109);">&gt;</span></p>
<p></p>
<p><span style="font: 12pt Helvetica; color: rgb(8,110,109);">&lt;</span><span style="font: 12pt Helvetica; color: rgb(49,109,108);">security:intercept-url </span><span style="font: 12pt Helvetica; color: rgb(108,0,109);">pattern</span><span style="font: 12pt Helvetica;">=</span><span style="font: 12pt Helvetica; color: rgb(36,0,255);">"/**"</span> <span style="font: 12pt Helvetica; color: rgb(49,109,108);"></span><span style="font: 12pt Helvetica; color: rgb(108,0,109);">filters</span><span style="font: 12pt Helvetica;">=</span><span style="font: 12pt Helvetica; color: rgb(36,0,255);">"none"</span><span style="font: 12pt Helvetica; color: rgb(8,110,109);">/&gt;</span></p>
<p></p>
<p><span style="font: 12pt Helvetica; color: rgb(8,110,109);">&lt;/</span><span style="font: 12pt Helvetica; color: rgb(49,109,108);">security:http</span><span style="font: 12pt Helvetica; color: rgb(8,110,109);">&gt;</span></p>
<p></p>
<p></p>
<p></p>
<p><span style="font: 12pt Helvetica; color: rgb(8,110,109);">&lt;</span><span style="font: 12pt Helvetica; color: rgb(49,109,108);">security:global-method-security</span><span style="font: 12pt Helvetica; color: rgb(8,110,109);">&gt;</span></p>
<p></p>
<p><span style="font: 12pt Helvetica; color: rgb(8,110,109);">&lt;</span><span style="font: 12pt Helvetica; color: rgb(49,109,108);">security:protect-pointcut</span></p>
<p></p>
<p><span style="font: 12pt Helvetica; color: rgb(108,0,109);">expression</span><span style="font: 12pt Helvetica;">=</span><span style="font: 12pt Helvetica; color: rgb(36,0,255);">"execution(* net.oneadam.app.services.*Manager.*(..))"</span></p>
<p></p>
<p><span style="font: 12pt Helvetica; color: rgb(108,0,109);">access</span><span style="font: 12pt Helvetica;">=</span><span style="font: 12pt Helvetica; color: rgb(36,0,255);">"ROLE_ADMIN"</span><span style="font: 12pt Helvetica; color: rgb(8,110,109);">/&gt;</span></p>
<p></p>
<p><span style="font: 12pt Helvetica; color: rgb(8,110,109);">&lt;/</span><span style="font: 12pt Helvetica; color: rgb(49,109,108);">security:global-method-security</span><span style="font: 12pt Helvetica; color: rgb(8,110,109);">&gt;</span></p>
<p></p>
<p></p>
<p></p>
<p><span style="font: 12pt Helvetica; color: rgb(8,110,109);">&lt;authentication-provider&gt;</span></p>
<p></p>
<p>   <span style="font: 12pt Helvetica; color: rgb(8,110,109);">&lt;user-service&gt;</span></p>
<p></p>
<p><span style="font: 12pt Helvetica; color: rgb(8,110,109);">&lt;user name="adam" password="adamspassword" authorities="ROLE_USER, ROLE_ADMIN" /&gt;</span></p>
<p></p>
<p>   <span style="font: 12pt Helvetica; color: rgb(8,110,109);">&lt;user name="bob" password="bobspassword" authorities="ROLE_USER" /&gt;</span></p>
<p></p>
<p>   <span style="font: 12pt Helvetica; color: rgb(8,110,109);">&lt;/user-service&gt;</span></p>
<p></p>
<p>  <span style="font: 12pt Helvetica; color: rgb(8,110,109);">&lt;/authentication-provider&gt;</span></p>
<p></p>
<p></p>
<p><span style="font: 12pt Helvetica;">This configuration passes everything through at the URL level and relies on method level security. I have used pointcuts here since it doesn't require me to cut and paste classes and methods in order to demonstrate how annotations work. The above pointcut requires the user for all methods in any class ending in the word Manager in the services package to have the role ROLE_ADMIN.</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;"><strong>Step4.</strong> Implement the flex.messaging.security.LoginCommand Interface so that the doAuthentication creates a UsernamePasswordAuthenticationToken and authenticates using Spring Security, if it is successful it should put the authentication object into the SecureContext where it will be accessible to your application and the Spring Security annotations or security pointcuts. here is my implementation:</span></p>
<p></p>
<p><span style="font: 12pt Helvetica; color: rgb(107,0,68);">package</span> <span style="font: 12pt Helvetica;">net.oneadam.web.security;</span></p>
<p></p>
<p></p>
<p></p>
<p><span style="font: 12pt Helvetica; color: rgb(107,0,68);">import</span> <span style="font: 12pt Helvetica;">java.security.Principal;</span></p>
<p></p>
<p><span style="font: 12pt Helvetica; color: rgb(107,0,68);">import</span> <span style="font: 12pt Helvetica;">java.util.List;</span></p>
<p></p>
<p><span style="font: 12pt Helvetica; color: rgb(107,0,68);">import</span> <span style="font: 12pt Helvetica;">java.util.Map;</span></p>
<p></p>
<p></p>
<p></p>
<p><span style="font: 12pt Helvetica; color: rgb(107,0,68);">import</span> <span style="font: 12pt Helvetica;">javax.servlet.ServletConfig;</span></p>
<p></p>
<p><span style="font: 12pt Helvetica; color: rgb(107,0,68);">import</span> <span style="font: 12pt Helvetica;">javax.servlet.http.HttpServletRequest;</span></p>
<p></p>
<p></p>
<p></p>
<p><span style="font: 12pt Helvetica; color: rgb(107,0,68);">import</span> <span style="font: 12pt Helvetica;">org.apache.commons.logging.Log;</span></p>
<p></p>
<p><span style="font: 12pt Helvetica; color: rgb(107,0,68);">import</span> <span style="font: 12pt Helvetica;">org.apache.commons.logging.LogFactory;</span></p>
<p></p>
<p><span style="font: 12pt Helvetica; color: rgb(107,0,68);">import</span> <span style="font: 12pt Helvetica;">org.springframework.context.ApplicationContext;</span></p>
<p></p>
<p><span style="font: 12pt Helvetica; color: rgb(107,0,68);">import</span> <span style="font: 12pt Helvetica;">org.springframework.security.AbstractAuthenticationManager;</span></p>
<p></p>
<p><span style="font: 12pt Helvetica; color: rgb(107,0,68);">import</span> <span style="font: 12pt Helvetica;">org.springframework.security.Authentication;</span></p>
<p></p>
<p><span style="font: 12pt Helvetica; color: rgb(107,0,68);">import</span> <span style="font: 12pt Helvetica;">org.springframework.security.context.SecurityContextHolder;</span></p>
<p></p>
<p><span style="font: 12pt Helvetica; color: rgb(107,0,68);">import</span> <span style="font: 12pt Helvetica;">org.springframework.security.providers.AbstractAuthenticationToken;</span></p>
<p></p>
<p><span style="font: 12pt Helvetica; color: rgb(107,0,68);">import</span> <span style="font: 12pt Helvetica;">org.springframework.security.providers.UsernamePasswordAuthenticationToken;</span></p>
<p></p>
<p><span style="font: 12pt Helvetica; color: rgb(107,0,68);">import</span> <span style="font: 12pt Helvetica;">org.springframework.web.context.support.WebApplicationContextUtils;</span></p>
<p></p>
<p></p>
<p></p>
<p><span style="font: 12pt Helvetica; color: rgb(107,0,68);">import</span> <span style="font: 12pt Helvetica;">flex.messaging.FlexContext;</span></p>
<p></p>
<p><span style="font: 12pt Helvetica; color: rgb(107,0,68);">import</span> <span style="font: 12pt Helvetica;">flex.messaging.io.MessageIOConstants;</span></p>
<p></p>
<p><span style="font: 12pt Helvetica; color: rgb(107,0,68);">import</span> <span style="font: 12pt Helvetica;">flex.messaging.security.LoginCommand;</span></p>
<p></p>
<p></p>
<p></p>
<p><span style="font: 12pt Helvetica; color: rgb(107,0,68);">public</span> <span style="font: 12pt Helvetica;"></span><span style="font: 12pt Helvetica; color: rgb(107,0,68);">class</span> <span style="font: 12pt Helvetica;">SpringSecurityLoginCommand </span><span style="font: 12pt Helvetica; color: rgb(107,0,68);">implements</span> <span style="font: 12pt Helvetica;">LoginCommand {</span></p>
<p></p>
<p>   <span style="font: 12pt Helvetica;"></span><span style="font: 12pt Helvetica; color: rgb(107,0,68);">private</span> <span style="font: 12pt Helvetica;"></span><span style="font: 12pt Helvetica; color: rgb(107,0,68);">static</span> <span style="font: 12pt Helvetica;"></span><span style="font: 12pt Helvetica; color: rgb(107,0,68);">final</span> <span style="font: 12pt Helvetica;">Log </span><span style="font: 12pt Helvetica; color: rgb(11,0,181);">LOG</span> <span style="font: 12pt Helvetica;">= LogFactory.getLog(SpringSecurityLoginCommand.</span><span style="font: 12pt Helvetica; color: rgb(107,0,68);">class</span><span style="font: 12pt Helvetica;">);</span></p>
<p></p>
<p></p>
<p></p>
<p>   <span style="font: 12pt Helvetica;"></span><span style="font: 12pt Helvetica; color: rgb(107,0,68);">private</span> <span style="font: 12pt Helvetica;">AbstractAuthenticationManager </span><span style="font: 12pt Helvetica; color: rgb(11,0,181);">authenticationManager</span><span style="font: 12pt Helvetica;">;</span></p>
<p></p>
<p></p>
<p></p>
<p>   <span style="font: 12pt Helvetica;"></span><span style="font: 12pt Helvetica; color: rgb(107,0,68);">public</span> <span style="font: 12pt Helvetica;">Principal doAuthentication(String username, Object credentials) {</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">String password = extractPassword(credentials);</span></p>
<p></p>
<p><span style="font: 12pt Helvetica; color: rgb(107,0,68);">if</span> <span style="font: 12pt Helvetica;">(password == </span><span style="font: 12pt Helvetica; color: rgb(107,0,68);">null</span><span style="font: 12pt Helvetica;">) {</span></p>
<p></p>
<p>   <span style="font: 12pt Helvetica;"></span><span style="font: 12pt Helvetica; color: rgb(107,0,68);">return</span> <span style="font: 12pt Helvetica;"></span><span style="font: 12pt Helvetica; color: rgb(107,0,68);">null</span><span style="font: 12pt Helvetica;">;</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">}</span></p>
<p></p>
<p>  <span style="font: 12pt Helvetica;"></span></p>
<p></p>
<p><span style="font: 12pt Helvetica; color: rgb(107,0,68);">if</span><span style="font: 12pt Helvetica;">(</span><span style="font: 12pt Helvetica; color: rgb(11,0,181);">authenticationManager </span><span style="font: 12pt Helvetica;">==</span> <span style="font: 12pt Helvetica; color: rgb(11,0,181);"></span><span style="font: 12pt Helvetica; color: rgb(107,0,68);">null</span><span style="font: 12pt Helvetica;">) {</span></p>
<p></p>
<p>   <span style="font: 12pt Helvetica;">init();</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">}</span></p>
<p></p>
<p></p>
<p></p>
<p><span style="font: 12pt Helvetica;">Authentication auth = </span><span style="font: 12pt Helvetica; color: rgb(107,0,68);">new</span> <span style="font: 12pt Helvetica;">UsernamePasswordAuthenticationToken(username, password);</span></p>
<p></p>
<p><span style="font: 12pt Helvetica; color: rgb(107,0,68);">try</span> <span style="font: 12pt Helvetica;">{</span></p>
<p></p>
<p>   <span style="font: 12pt Helvetica;">SecurityContextHolder.getContext().setAuthentication(</span><span style="font: 12pt Helvetica; color: rgb(11,0,181);">authenticationManager</span><span style="font: 12pt Helvetica;">.authenticate(auth));</span></p>
<p></p>
<p>   <span style="font: 12pt Helvetica;"></span><span style="font: 12pt Helvetica; color: rgb(11,0,181);">LOG</span><span style="font: 12pt Helvetica;">.info(</span><span style="font: 12pt Helvetica; color: rgb(36,0,255);">"User ["</span> <span style="font: 12pt Helvetica;">+ username + </span><span style="font: 12pt Helvetica; color: rgb(36,0,255);">"] logged in."</span><span style="font: 12pt Helvetica;">);</span></p>
<p></p>
<p>   <span style="font: 12pt Helvetica;"></span><span style="font: 12pt Helvetica; color: rgb(107,0,68);">return</span> <span style="font: 12pt Helvetica;">(AbstractAuthenticationToken) SecurityContextHolder.getContext().getAuthentication();</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">}</span></p>
<p></p>
<p><span style="font: 12pt Helvetica; color: rgb(107,0,68);">catch</span> <span style="font: 12pt Helvetica;">(RuntimeException e) {</span></p>
<p></p>
<p>  <span style="font: 12pt Helvetica;"></span> <span style="font: 12pt Helvetica; color: rgb(36,0,255);"></span><span style="font: 12pt Helvetica; color: rgb(11,0,181);">LOG</span><span style="font: 12pt Helvetica;">.info(</span><span style="font: 12pt Helvetica; color: rgb(36,0,255);">"User [" </span><span style="font: 12pt Helvetica;">+ username +</span> <span style="font: 12pt Helvetica; color: rgb(36,0,255);">"] failed authentication."</span><span style="font: 12pt Helvetica;">);</span></p>
<p></p>
<p>   <span style="font: 12pt Helvetica;"></span><span style="font: 12pt Helvetica; color: rgb(107,0,68);">throw</span> <span style="font: 12pt Helvetica;">e;</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">}</span></p>
<p></p>
<p>   <span style="font: 12pt Helvetica;">}</span></p>
<p></p>
<p></p>
<p></p>
<p>   <span style="font: 12pt Helvetica;"></span><span style="font: 12pt Helvetica; color: rgb(50,67,180);">/**</span></p>
<p></p>
<p><span style="font: 12pt Helvetica; color: rgb(50,67,180);">* We are not going to perform Authorization at this level since we would like SpringSecurity</span></p>
<p></p>
<p><span style="font: 12pt Helvetica; color: rgb(50,67,180);">* to manage Authorization at the method level.</span></p>
<p></p>
<p><span style="font: 12pt Helvetica; color: rgb(50,67,180);">*/</span></p>
<p></p>
<p>  <span style="font: 12pt Helvetica;"></span> <span style="font: 12pt Helvetica; color: rgb(81,81,81);">@SuppressWarnings</span><span style="font: 12pt Helvetica;">(</span><span style="font: 12pt Helvetica; color: rgb(36,0,255);">"unchecked"</span><span style="font: 12pt Helvetica;">)</span></p>
<p></p>
<p>   <span style="font: 12pt Helvetica;"></span><span style="font: 12pt Helvetica; color: rgb(107,0,68);">public</span> <span style="font: 12pt Helvetica;"></span><span style="font: 12pt Helvetica; color: rgb(107,0,68);">boolean</span> <span style="font: 12pt Helvetica;">doAuthorization(Principal principal, List roles) {</span></p>
<p></p>
<p><span style="font: 12pt Helvetica; color: rgb(107,0,68);">return true</span><span style="font: 12pt Helvetica;">;</span></p>
<p></p>
<p>   <span style="font: 12pt Helvetica;">}</span></p>
<p></p>
<p></p>
<p></p>
<p>   <span style="font: 12pt Helvetica;"></span><span style="font: 12pt Helvetica; color: rgb(107,0,68);">public</span> <span style="font: 12pt Helvetica;"></span><span style="font: 12pt Helvetica; color: rgb(107,0,68);">boolean</span> <span style="font: 12pt Helvetica;">logout(Principal principal) {</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">HttpServletRequest request = FlexContext.getHttpRequest();</span></p>
<p></p>
<p><span style="font: 12pt Helvetica; color: rgb(107,0,68);">if</span> <span style="font: 12pt Helvetica;">(request != </span><span style="font: 12pt Helvetica; color: rgb(107,0,68);">null</span> <span style="font: 12pt Helvetica;">&amp;&amp; request.getSession(</span><span style="font: 12pt Helvetica; color: rgb(107,0,68);">false</span><span style="font: 12pt Helvetica;">) != </span><span style="font: 12pt Helvetica; color: rgb(107,0,68);">null</span><span style="font: 12pt Helvetica;">) {</span></p>
<p></p>
<p>   <span style="font: 12pt Helvetica;"></span><span style="font: 12pt Helvetica; color: rgb(107,0,68);">try</span> <span style="font: 12pt Helvetica;">{</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">request.getSession().invalidate();</span></p>
<p></p>
<p>   <span style="font: 12pt Helvetica;">}</span></p>
<p></p>
<p>   <span style="font: 12pt Helvetica;"></span><span style="font: 12pt Helvetica; color: rgb(107,0,68);">catch</span> <span style="font: 12pt Helvetica;">(IllegalStateException e) {</span></p>
<p></p>
<p><span style="font: 12pt Helvetica; color: rgb(49,110,76);">// Expected.</span></p>
<p></p>
<p>   <span style="font: 12pt Helvetica;">}</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">}</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">request.getSession(</span><span style="font: 12pt Helvetica; color: rgb(107,0,68);">true</span><span style="font: 12pt Helvetica;">);</span> <span style="font: 12pt Helvetica; color: rgb(49,110,76);">// Session re-created to avoid </span><span style="font: 12pt Helvetica; color: rgb(49,110,76); text-decoration: underline;">Flex</span> <span style="font: 12pt Helvetica; color: rgb(49,110,76);">error when</span></p>
<p></p>
<p><span style="font: 12pt Helvetica; color: rgb(49,110,76);">// it also attempts to invalidate the session.</span></p>
<p></p>
<p><span style="font: 12pt Helvetica; color: rgb(11,0,181);">LOG</span><span style="font: 12pt Helvetica;">.info(</span><span style="font: 12pt Helvetica; color: rgb(36,0,255);">"User ["</span> <span style="font: 12pt Helvetica;">+ principal.getName() + </span><span style="font: 12pt Helvetica; color: rgb(36,0,255);">"] logged out."</span><span style="font: 12pt Helvetica;">);</span></p>
<p></p>
<p><span style="font: 12pt Helvetica; color: rgb(107,0,68);">return true</span><span style="font: 12pt Helvetica;">;</span></p>
<p></p>
<p>   <span style="font: 12pt Helvetica;">}</span></p>
<p></p>
<p></p>
<p></p>
<p>   <span style="font: 12pt Helvetica;"></span><span style="font: 12pt Helvetica; color: rgb(107,0,68);">public</span> <span style="font: 12pt Helvetica;"></span><span style="font: 12pt Helvetica; color: rgb(107,0,68);">void</span> <span style="font: 12pt Helvetica;">start(ServletConfig config) {</span></p>
<p></p>
<p><span style="font: 12pt Helvetica; color: rgb(49,110,76);">//My tests show this never gets called</span></p>
<p></p>
<p>   <span style="font: 12pt Helvetica;">}</span></p>
<p></p>
<p></p>
<p></p>
<p>   <span style="font: 12pt Helvetica;"></span><span style="font: 12pt Helvetica; color: rgb(107,0,68);">public</span> <span style="font: 12pt Helvetica;"></span><span style="font: 12pt Helvetica; color: rgb(107,0,68);">void</span> <span style="font: 12pt Helvetica;">stop() {</span></p>
<p></p>
<p><span style="font: 12pt Helvetica; color: rgb(11,0,181);">authenticationManager </span><span style="font: 12pt Helvetica;">=</span> <span style="font: 12pt Helvetica; color: rgb(11,0,181);"></span><span style="font: 12pt Helvetica; color: rgb(107,0,68);">null</span><span style="font: 12pt Helvetica;">;</span></p>
<p></p>
<p>   <span style="font: 12pt Helvetica;">}</span></p>
<p></p>
<p></p>
<p></p>
<p>  <span style="font: 12pt Helvetica;"></span> <span style="font: 12pt Helvetica; color: rgb(81,81,81);">@SuppressWarnings</span><span style="font: 12pt Helvetica;">(</span><span style="font: 12pt Helvetica; color: rgb(36,0,255);">"unchecked"</span><span style="font: 12pt Helvetica;">)</span></p>
<p></p>
<p>   <span style="font: 12pt Helvetica;"></span><span style="font: 12pt Helvetica; color: rgb(107,0,68);">protected</span> <span style="font: 12pt Helvetica;">String extractPassword(Object credentials)</span></p>
<p></p>
<p>   <span style="font: 12pt Helvetica;">{</span></p>
<p></p>
<p>   <span style="font: 12pt Helvetica;">String password = </span><span style="font: 12pt Helvetica; color: rgb(107,0,68);">null</span><span style="font: 12pt Helvetica;">;</span></p>
<p></p>
<p>   <span style="font: 12pt Helvetica;"></span><span style="font: 12pt Helvetica; color: rgb(107,0,68);">if</span> <span style="font: 12pt Helvetica;">(credentials </span><span style="font: 12pt Helvetica; color: rgb(107,0,68);">instanceof</span> <span style="font: 12pt Helvetica;">String)</span></p>
<p></p>
<p>   <span style="font: 12pt Helvetica;">{</span></p>
<p></p>
<p>   <span style="font: 12pt Helvetica;">password = (String)credentials;</span></p>
<p></p>
<p>   <span style="font: 12pt Helvetica;">}</span></p>
<p></p>
<p>   <span style="font: 12pt Helvetica;"></span><span style="font: 12pt Helvetica; color: rgb(107,0,68);">else</span> <span style="font: 12pt Helvetica;"></span><span style="font: 12pt Helvetica; color: rgb(107,0,68);">if</span> <span style="font: 12pt Helvetica;">(credentials </span><span style="font: 12pt Helvetica; color: rgb(107,0,68);">instanceof</span> <span style="font: 12pt Helvetica;">Map)</span></p>
<p></p>
<p>   <span style="font: 12pt Helvetica;">{</span></p>
<p></p>
<p>   <span style="font: 12pt Helvetica;">password = (String)((Map)credentials).get(MessageIOConstants.</span><span style="font: 12pt Helvetica; color: rgb(11,0,181);">SECURITY_CREDENTIALS</span><span style="font: 12pt Helvetica;">);</span></p>
<p></p>
<p>   <span style="font: 12pt Helvetica;">}</span></p>
<p></p>
<p>   <span style="font: 12pt Helvetica;"></span><span style="font: 12pt Helvetica; color: rgb(107,0,68);">return</span> <span style="font: 12pt Helvetica;">password;</span></p>
<p></p>
<p>   <span style="font: 12pt Helvetica;">}</span></p>
<p></p>
<p></p>
<p></p>
<p>   <span style="font: 12pt Helvetica;"></span><span style="font: 12pt Helvetica; color: rgb(107,0,68);">private</span> <span style="font: 12pt Helvetica;"></span><span style="font: 12pt Helvetica; color: rgb(107,0,68);">void</span> <span style="font: 12pt Helvetica;">init() {</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">HttpServletRequest request = FlexContext.getHttpRequest();</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">ApplicationContext ctx =</span></p>
<p></p>
<p>   <span style="font: 12pt Helvetica;">WebApplicationContextUtils.getWebApplicationContext(request.getSession().getServletContext());</span></p>
<p></p>
<p><span style="font: 12pt Helvetica; color: rgb(11,0,181);">authenticationManager</span> <span style="font: 12pt Helvetica;">= (AbstractAuthenticationManager) ctx.getBean(</span><span style="font: 12pt Helvetica; color: rgb(36,0,255);">"_authenticationManager"</span><span style="font: 12pt Helvetica;">);</span></p>
<p></p>
<p>   <span style="font: 12pt Helvetica;">}</span></p>
<p></p>
<p></p>
<p></p>
<p><span style="font: 12pt Helvetica;">}</span></p>
<p></p>
<p></p>
<p><span style="font: 12pt Helvetica;">You will notice that the doAuthentication method just returns true. That is because I am not interested in securing BlazeDS destinations. I prefer to secure the service facade methods themselves, that way if I expose them using CXF or some other Web Service transport my security does not have to be redone.</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;"><strong>Step5.</strong> Wire up security in the services-config.xml file to use your SpringSecurityLoginCommand it will look something like this:</span></p>
<p></p>
<p><span style="font: 12pt Helvetica; color: rgb(8,110,109);">&lt;</span><span style="font: 12pt Helvetica; color: rgb(49,109,108);">security</span><span style="font: 12pt Helvetica; color: rgb(8,110,109);">&gt;</span></p>
<p></p>
<p><span style="font: 12pt Helvetica; color: rgb(8,110,109);">&lt;</span><span style="font: 12pt Helvetica; color: rgb(49,109,108);">login-command</span> <span style="font: 12pt Helvetica; color: rgb(36,0,255);"></span><span style="font: 12pt Helvetica; color: rgb(108,0,109);">class</span><span style="font: 12pt Helvetica;">=</span><span style="font: 12pt Helvetica; color: rgb(36,0,255);">"com.renewtek.cmf.web.security.SpringSecurityLoginCommand" </span><span style="font: 12pt Helvetica; color: rgb(108,0,109);">server</span><span style="font: 12pt Helvetica;">=</span><span style="font: 12pt Helvetica; color: rgb(36,0,255);">"Tomcat"</span><span style="font: 12pt Helvetica; color: rgb(8,110,109);">&gt;</span></p>
<p></p>
<p>  <span style="font: 12pt Helvetica;"></span> <span style="font: 12pt Helvetica; color: rgb(49,109,108);"></span><span style="font: 12pt Helvetica; color: rgb(8,110,109);">&lt;</span><span style="font: 12pt Helvetica; color: rgb(49,109,108);">per-client-authentication</span><span style="font: 12pt Helvetica; color: rgb(8,110,109);">&gt;</span><span style="font: 12pt Helvetica;">true</span><span style="font: 12pt Helvetica; color: rgb(8,110,109);">&lt;/</span><span style="font: 12pt Helvetica; color: rgb(49,109,108);">per-client-authentication</span><span style="font: 12pt Helvetica; color: rgb(8,110,109);">&gt;</span></p>
<p></p>
<p><span style="font: 12pt Helvetica; color: rgb(8,110,109);">&lt;/</span><span style="font: 12pt Helvetica; color: rgb(49,109,108);">login-command</span><span style="font: 12pt Helvetica; color: rgb(8,110,109);">&gt;</span></p>
<p></p>
<p><span style="font: 12pt Helvetica; color: rgb(8,110,109);">&lt;</span><span style="font: 12pt Helvetica; color: rgb(49,109,108);">security-constraint </span><span style="font: 12pt Helvetica; color: rgb(108,0,109);">id</span><span style="font: 12pt Helvetica;">=</span><span style="font: 12pt Helvetica; color: rgb(36,0,255);">"roleuser"</span><span style="font: 12pt Helvetica; color: rgb(8,110,109);">&gt;</span></p>
<p></p>
<p>  <span style="font: 12pt Helvetica;"></span> <span style="font: 12pt Helvetica; color: rgb(49,109,108);"></span><span style="font: 12pt Helvetica; color: rgb(8,110,109);">&lt;</span><span style="font: 12pt Helvetica; color: rgb(49,109,108);">auth-method</span><span style="font: 12pt Helvetica; color: rgb(8,110,109);">&gt;</span><span style="font: 12pt Helvetica;">Custom</span><span style="font: 12pt Helvetica; color: rgb(8,110,109);">&lt;/</span><span style="font: 12pt Helvetica; color: rgb(49,109,108);">auth-method</span><span style="font: 12pt Helvetica; color: rgb(8,110,109);">&gt;</span></p>
<p></p>
<p>   <span style="font: 12pt Helvetica;"></span><span style="font: 12pt Helvetica; color: rgb(8,110,109);">&lt;</span><span style="font: 12pt Helvetica; color: rgb(49,109,108);">roles</span><span style="font: 12pt Helvetica; color: rgb(8,110,109);">&gt;</span></p>
<p></p>
<p><span style="font: 12pt Helvetica; color: rgb(8,110,109);">&lt;</span><span style="font: 12pt Helvetica; color: rgb(49,109,108);">role</span><span style="font: 12pt Helvetica; color: rgb(8,110,109);">&gt;</span><span style="font: 12pt Helvetica;">ROLE_USER</span><span style="font: 12pt Helvetica; color: rgb(8,110,109);">&lt;/</span><span style="font: 12pt Helvetica; color: rgb(49,109,108);">role</span><span style="font: 12pt Helvetica; color: rgb(8,110,109);">&gt;</span></p>
<p></p>
<p><span style="font: 12pt Helvetica; color: rgb(8,110,109);">&lt;</span><span style="font: 12pt Helvetica; color: rgb(49,109,108);">role</span><span style="font: 12pt Helvetica; color: rgb(8,110,109);">&gt;</span><span style="font: 12pt Helvetica;">ROLE_ADMIN</span><span style="font: 12pt Helvetica; color: rgb(8,110,109);">&lt;/</span><span style="font: 12pt Helvetica; color: rgb(49,109,108);">role</span><span style="font: 12pt Helvetica; color: rgb(8,110,109);">&gt;</span></p>
<p></p>
<p>   <span style="font: 12pt Helvetica;"></span><span style="font: 12pt Helvetica; color: rgb(8,110,109);">&lt;/</span><span style="font: 12pt Helvetica; color: rgb(49,109,108);">roles</span><span style="font: 12pt Helvetica; color: rgb(8,110,109);">&gt;</span></p>
<p></p>
<p><span style="font: 12pt Helvetica; color: rgb(8,110,109);">&lt;/</span><span style="font: 12pt Helvetica; color: rgb(49,109,108);">security-constraint</span><span style="font: 12pt Helvetica; color: rgb(8,110,109);">&gt;</span></p>
<p></p>
<p>  <span style="font: 12pt Helvetica;"></span> <span style="font: 12pt Helvetica; color: rgb(49,109,108);"></span><span style="font: 12pt Helvetica; color: rgb(8,110,109);">&lt;/</span><span style="font: 12pt Helvetica; color: rgb(49,109,108);">security</span><span style="font: 12pt Helvetica; color: rgb(8,110,109);">&gt;</span></p>
<p><span style="font: 12pt Helvetica;">The roles are actually unnecessary since I return true from all authorization requests at this level. I have just left them in for completeness. If you wanted to reject a request at this level that is where you would put the roles and if you are using the Adobe style of defining destinations in your remoting-config.xml file then you could say what destinations are allowed for what roles. What is important to the strategy I described above is the per-client-authentication entry. it needs to be set to true since we don't want to use server based sessions. it is false by default.</span></p>
<p></p>
</div>

<div class="journalentry">
<b>Date:</b> 2 February 2009<br>
<b>Time:</b> 6:11:36 PM<br>
<b>Topic:</b> Postcards From a Vietnam Labour Camp pt V<br><br>
<p style="text-align: left"><span style="font: 12pt Helvetica;">Chuc mung nam moi! or happy new year for those of you not lucky enough to be attempting to learn to speak the single most difficult language in existence.</span></p>
<p style="text-align: left"></p>
<p style="text-align: left"><span style="font: 12pt Helvetica;">New Year in Vietnam is based on the lunar calendar and is called Tet. Tet means our office is closed for a week and Jacqui and I get time off for good behavior. We took a couple of days extra and went to Lombok for a week of lying around a pool doing bugger all and 3 days in Singapore spending money on all the things we can't buy in Saigon.</span></p>
<p style="text-align: left"></p>
<p style="text-align: left"><span style="font: 12pt Helvetica;">I am writing this from our hotel in Singapore and as I write I am not sure I can make myself go back to Saigon. Lombok was an oasis of tranquility. The Indonesian people are so friendly and nice. Things move quite slowly and no one tries to run you over when you are walking on the footpath. I almost didn't know myself. We did quite a bit of sight seeing but mostly we did a lot of nothing. The pool at the resort we were staying at was almost as warm as a bath and Lily loved it. We spent a fair part of every day swimming her back and forth between Jac and me or taking her to the swim up bar for a banana and mango smoothie.</span></p>
<p style="text-align: left"></p>
<p style="text-align: left"><span style="font: 12pt Helvetica;">My rusty Indonesian came back to me surprisingly easily and within a day I was having less trouble being understood than I usually have in Saigon after nearly 3 months of lessons. I don't know if that is testimony to my awesome long term memory or an indictment on my short term memory. Maybe it is just the fact that Indonesian doesn't have any tones... or maybe it is that Indonesian people are helpful and really chuffed when you make an effort to speak their language rather than laughing at you and making things difficult.</span></p>
<p style="text-align: left"></p>
<p style="text-align: left"><span style="font: 12pt Helvetica;">Singapore is like an oasis in the middle of a road rule dessert. Virtually everyone speaks English and can read enough to get which side of the road they should be driving on. Forget about driving, they only have a few shop assistants in any given shop (about the same as Australia) but they actually seem to know something about the products in their store. I asked someone for deodorant and told them that because of my skin, I can't use anti-perspirant and they not only understood what I was asking for but showed me where the choices were!!! My god, in Saigon there are about 5 people for every isle of the supermarket yet no-one seems to know where the fucking rice is!</span></p>
<p style="text-align: left"></p>
<p style="text-align: left"><span style="font: 12pt Helvetica;">I guess that is enough of my complaining (for now). It is amazing how normalized to the craziness you become, it is only when you get away from it that you realise how insane things are. Well, deep breath, we are off for another dose of craziness :)</span></p>
<p style="text-align: left"></p>
</div>

<div class="journalentry">
<b>Date:</b> 18 January 2009<br>
<b>Time:</b> 12:02:57 PM<br>
<b>Topic:</b> Postcards From a Vietnam Labour Camp pt IV<br><br>
<p><span style="font: 12pt Helvetica;">We went to Cu Chi the other weekend. This is the place made famous by the tunnels dug by the Vietnamese, firstly while they were fighting the French and then later expanded while they got rid of the Americans. I guess part of me is in awe of the determination and sheer bloody mindedness required to dig and live in those tunnels. The rest of me, however, is wondering whether it really matters that much which particular dickhead is making the rules.</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">Okay, I will admit that the French can be a little annoying with their superior attitude, but they did, after all, invent the croissant and made breakfast bearable for those of us who don't necessarily want to eat cold kippers or dead animal first thing in the morning. If someone told me that I was going to have to live underground for 20 - 30 years and eat nothing but rice and tapioca while my enemies partied hard and ate at 5 star restaurants, and in the case of the Americans, had sex with every available woman in the country. I would have a serious think about how important it was that I lived under a particular political regime.</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">Our receptionist got married not long ago and Jacqui, Lily and I were invited to the event. You can say what you like about the way the Vietnamese drive, eat, recreate, and generally run their country but you cannot criticize their weddings! No expense is spared as new heights of (slightly kitsch) glamour are reached. Not only was there a stage at this particular wedding, but also a cat walk.</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">The core thing which the Vietnamese have learned, which few other cultures seem to have done is that watching your friends and family drink themselves insensible until the wee hours of the morning on the night which is essentially the culmination of months or years of courting is counterproductive to the ultimate goal. A Vietnamese wedding receptions has everything that any western wedding has, and a fair bit that they don't, and it lasts around 2 - 3 hours max.</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">As you can imagine that is a pretty action packed 2 - 3 hours. At the wedding I went to they managed to serve a complete 10 course degustation and present the bride and groom in what can only be described as a floor show, making use of the stage and runway to very good effect.</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">Entrees were served during a Bollywood style lip sync and dance performance complete with Miss Saigon style umbrellas. The performers then became part of the welcoming committee to a bridal party which was at least 25 people. We found out later that many of them were hotel wait staff who have an assortment of gowns and suits in their wardrobe department for exactly this kind of thing.</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">Once the bridal party had all made it to the stage, the MC announced everyone. Obviously we didn't understand a word that was said but there was a lot of cheering. After intros the cakes were brought in, 4 of them. There was a fair bit of dry ice action going on with them and they were pouring out smoke as the bide and groom cut them each one by one. i was assured by one of the guests that only one or two of them would actually be real but they cut all four.</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">After that we had speeches during the main courses. Everyone was on stage still and of course we didn't understand any of this either but I believe it contained all the usual wedding stuff since there was plenty of laughing and cheering during the young people's speeches and lots of eating and serious nodding during the mother and father's speeches. This all culminated in the rest of the bridal party filing off the stage while the bride and groom filled the champagne fountain with bright pink champagne. Of course the glasses in the top couple of tiers of the fountain contained dry ice so there was plenty of smoke and spectacle.</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">Everyone finishes their food while the bridal party goes from table to table saying a brief hello to all the guests. Fast eaters get up and have a dance, mostly the kids (and there are plenty of them) just want to get up on the stage. Somehow the catwalk has vanished so there is a bit more floor room. Then everyone starts leaving.</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">That is about it you are home in time to put your child to bed and chill for a while before going to bed yourself... very civilized! Oh and the other thing is that you don't give presents, you give money. There is no mucking around with bridal registries, or worse still trying to guess what the bride and groom might want or need, you just anonymously donate some cash in the barrel as you go in.</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">I can tell you, if Jac &amp; I get married, we will definitely be doing it Vietnamese style :)</span></p>
<p></p>
</div>

<div class="journalentry">
<b>Date:</b> 9 January 2009<br>
<b>Time:</b> 5:42:53 AM<br>
<b>Topic:</b> Optimistic Locking with JPA, Flex &amp;amp; BlazeDS<br><br>
<p><span style="font: 12pt Helvetica;">Optimistic locking in JPA relies on a version field which can be a number or a date of some type. Using date objects can be problematic if they are not detailed enough. For example a date which does not persist at least milliseconds is likely not to be accurate enough to do versioning. I generally use a Long since it is going to survive a very long time indeed, even in a high transaction system. The version filed is identified using the @Version annotation and when an object containing a version field is updated JPA will read up the version number in the database before attempting to do the update and if the version numbers do not match then it will throw an OptimisticLockException. It is a good practice to make the version field private and not to provide getters and setters. it is critical that the field not be altered except by the JPA implementation.</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">Ok, so far so good, we implement this strategy on systems where we have a greater proportion of reads to writes and we would like data to be highly available. Basically a user can always get a read, no matter what, however if they want to do a write we will check that the object they are modifying has not been written to since they read it. Very many web based application use this strategy today and as I described above it is supported out of the box with JPA. Of course there are endless arguments about how you manage the OptimisticLockException, but that is a separate issue.</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">When your web application is using DTOs or some other representation of the system data which is not your actual domain another level of complexity enters the frame. If the DTOs don't carry the version field with them and re-present it for the update then the whole optimistic lock strategy is dead in the water. If the web tier represents an object without keeping the version field then when it the user requests to update the domain, JPA must retrieve it again, over-write the fields provided and then perform the update. Of course if someone had changed the data between the user's read and write, that would be over-written.</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">So we have established that maintaining the version field into the web tier is critical. We already established that the version field should not be user modifiable so it would be good to make the version field in the DTOs private as well. If you are hand mapping between DTOs and your domain then you will need to use reflection to map this field across. I generally user dozer and it allows you to set is-accessible="true" in a field description which tells it to access this field directly without using the getter and setter.</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">When you add Flex and BlazeDS to the picture (and of course that means an ActionScript domain) you add a whole new level of complexity and at this point a real problem arises. Of course BlazeDS will auto-magically transform your Java DTOs into your ActionScript domain and perform all transport in AMF3. Thats peachy, but unfortunately it does not transport private fields without getters or setters. That means that although your version field gets mapped onto the DTO when it arrives on the Flex client, it is gone.</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">Well that just won't do, we already established that without the version field we have no locking strategy at all. Currently my only work around is to provide getters and setters on the DTOs. This ensures that they make the trip to the client and back but it risks the client accidentally altering them and inadvertently causing an OptimisticLockException. I'm a little unhappy with this and intend to spend a little bit of time with the BlazeDS source code to see if there is something that can be done to allow private field mapping. If you are interested stay tuned or feel free to post your ideas as comments here.</span></p>
<p></p>
<p></p>
</div>

<div class="journalentry">
<b>Date:</b> 8 January 2009<br>
<b>Time:</b> 3:12:23 PM<br>
<b>Topic:</b> M2Eclipse and WTP<br><br>
<p><span style="font: 12pt Helvetica;">WTP and M2Eclipse do not play very nicely together. We have identified 2 main problems:</span></p>
<p></p>
<ol style="list-style-type: decimal">
<li></li>
<li><span style="font: 12pt Helvetica;">Converting Maven projects to WTP projects so that they can be auto-deployed to the servlet container.</span></li>
<li></li>
<li></li>
<li><span style="font: 12pt Helvetica;">Multi-modules projects where the web project has dependencies on one or more of the other modules and you want to be able to debug freely into any module. In this case if you allow a project per module, the other modules never seem to get deployed to the web project.</span></li>
<li></li>
</ol>
<p></p>
<p><span style="font: 12pt Helvetica;">I will deal with <strong>issue 1</strong> first. Most of this solution came from a posting on the eclipse.webtools newsgroup, however it is quite incomplete with respect to Maven projects:</span></p>
<p></p>
<ol style="list-style-type: decimal">
<li></li>
<li><span style="font: 12pt Helvetica;">Open .project file for the project to be converted to web project.</span></li>
<li></li>
<li></li>
<li><span style="font: 12pt Helvetica;">Insert the following to natures element:  &lt;nature&gt;org.eclipse.wst.common.project.facet.core.nature&lt;/nature&gt;  &lt;nature&gt;org.eclipse.wst.common.modulecore.ModuleCoreNature&lt;/nature&gt;</span></li>
<li></li>
<li></li>
<li><span style="font: 12pt Helvetica;">Open the properties for the project and go to the section for Project Facets</span></li>
<li></li>
<li></li>
<li><span style="font: 12pt Helvetica;">Add <strong>Java</strong> and <strong>Dynamic Web Module</strong> facets to the project. (I forgot the Java facet first time around and had a lot of confusion until I worked it out)</span></li>
<li></li>
</ol>
<p></p>
<p><span style="font: 12pt Helvetica;">The above will work for a non-maven project the rest you will need if you are using m2eclipse:</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">Open the .classpath file and add the following:</span></p>
<p></p>
<p></p>
<p><span style="font: 12pt Helvetica;">&lt;classpathentry exported="true" kind="con" path="org.maven.ide.eclipse.MAVEN2_CLASSPATH_CONTAINER"&gt;</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">&lt;attributes&gt;</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">&lt;attribute name="org.eclipse.jst.component.dependency" value="/WEB-INF/lib"/&gt;</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">&lt;/attributes&gt;</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">&lt;/classpathentry&gt;</span></p>
<p><span style="font: 12pt Helvetica;">Open the org.eclipse.wst.common.component file in the .settings folder of your project and add this line inside the wb-resource block:&lt;wb-resource deploy-path="/" source-path="&lt;nested module name if you have one&gt;/src/main/webapp"/&gt;</span></p>
<p></p>
<p></p>
<p></p>
<p><span style="font: 12pt Helvetica;"><strong>Issue 2</strong> is really annoying to me since most of our applications use multiple modules to decouple the services from the way they are exposed, ie. via a Java MVC framework, Web Services or via BlazeDs to a Flex RIA. Having this limitation forces us to have a single eclipse project for the services and the web tier or transport tier. This can have the effect of hiding coupling between your services and the web or transport tier.</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">Nevertheless it is a reality that has to be dealt with right now. You can manage it very easily in IntelliJ, however, even there I can, as yet, find no way to tell the editor that the service tier jar source code is actually in the editor so that I can set break points. Probably this could be dealt with but I was reluctant to spend time on it when I know our management would flip if I suggested paying for all developers to have IntelliJ  licenses :-D</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">Okay, so the way to solve this problem with m2eclipse is to have the service or core application and the web server application as a single project with multiple maven modules. This sucks for a couple of reasons. The first is that if you have decomposed your application into more that 2 modules it is very hard to manage all the source folders in eclipse. The second reason I mentioned above, this approach will actually have eclipse compiling all classes into the one class folder and deploying that to your web server once you set WTP up. I have seen a number of instances where this effectively makes decomposing your application into multiple modules a waste of time or worse since it gives you the impression that you are enforcing a decoupling when in fact you are not.</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">If you use this approach then the instructions above still apply in terms of setting up WTP once you have created your multi-module project. In the last step you will need to prepend the web server module name to src/main/webapp (the angle brackets in the description above show exaclty where this goes).</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">I hope this helps someone, at the very least it will help me the next time I have to deal with this.</span></p>
<p></p>
</div>

<div class="journalentry">
<b>Date:</b> 2 December 2008<br>
<b>Time:</b> 5:51:23 PM<br>
<b>Topic:</b> Postcards From a Vietnam Labour Camp pt III<br><br>
<p style="text-align: left"><span style="font: 12pt Helvetica;">I haven't written for a while, life has been pretty busy and we have been trying to fit in as much as possible between my work and Jac's study.</span></p>
<p style="text-align: left"></p>
<p style="text-align: left"><span style="font: 12pt Helvetica;">Being a small child is like being a high level executive in a big company, you have people for everything and need only concern yourself with things of immediate interest. Lily has been able to take off her sandals for quite a while now, but at child care she has a bevvy of older children who have decided that looking after her every need is their task for the morning. Today we got in early and none of the other kids were there. Lily looked a bit lost she sat down on the ground in front of the lockers where they put their bags and shoes. Jac started telling her to take of her shoes and Lily just looked around with a bemused expression on her face, silently asking the question "Where are my people?". Clearly there was no way she was going to take them off herself.</span></p>
<p style="text-align: left"></p>
<p style="text-align: left"><span style="font: 12pt Helvetica;">I have really been getting into people watching lately. When Viet, our driver isn't drilling me on Vietnamese I stare out the window and just look at the weird people doing even weirder stuff. I like the idea that with my white skin and trache tube I can be one of the weird people to someone else. Sometimes I feel I should start twitching and ticking like someone with Tourette's to really give people something to look at as they walk past a restaurant where I am eating.</span></p>
<p style="text-align: left"></p>
<p style="text-align: left"><span style="font: 12pt Helvetica;">Even with all that I have going for me in the freak department I can still become invisible when Lily is with me. Viet calls her the VIP baby. Since she is quite blonde and has white skin (and is totally cute, even if I do say so myself) she is the center of attention everywhere we go. Vietnamese people in general love kids and a blonde western baby causes them to take it to the next level. On a number of occasions I have had to actually physically remove someone's hand as Lily is clearly not into having her cheek or arm tweaked and they are clearly not going to stop. Luckily the term 'fuck off' seems to cross the language barrier, so I can make myself understood on this subject.</span></p>
<p style="text-align: left"></p>
<p style="text-align: left"><span style="font: 12pt Helvetica;">I always wondered why they call Motor Scooters that. I can't see how they are fundamentally different from motor bikes. Now that I have lived in Vietnam I know, the term was clearly invented here. I am constantly seeing people broken down or out of petrol scooting their bikes along with their feet.</span></p>
<p style="text-align: left"></p>
<p style="text-align: left"><span style="font: 12pt Helvetica;">On Saturday we decided to go to an island resort on the Mekong river called Vung Tao. They advertise half hourly hydrofoils to the island which takes around an hour and a quarter. We broke the first rule of living in Vietnam: "Don't believe the hype!". We got down to the terminal at 9.55, we figured if we got lucky we would jump straight onto the 10am ferry otherwise we could get the 10.30 one... no big deal, right?!</span></p>
<p style="text-align: left"></p>
<p style="text-align: left"><span style="font: 12pt Helvetica;">One look queue for the 10am ferry was enough to tell me that we weren't getting onto that. I went over to the other counter to book a ticket for the 10.30 one. The woman told me that they had no ferries going today at all. I wandered back over to Jac who was still staring with sick fascination at the what Vietnamese people will do to get to the front of the queue. As a white person you are just not born with the necessary desperation to compete with a Vietnamese person in a queue, they will happily push you on your ass to get to the counter before you and have no idea what you are carrying on about when you get pissed off.</span></p>
<p style="text-align: left"></p>
<p style="text-align: left"><span style="font: 12pt Helvetica;">The next ferry that we had any hope of competing for was either at 11 or 12 depending on which sign was correct. I still wasn't too worried since there is a beautiful hotel (The Majestic) right over the road from the ferry terminal and I figured if we got a ticket we could hang out over there with the other rich white people. All of a sudden someone has my suitcase by the other end and is dragging me toward the terminal.</span></p>
<p style="text-align: left"></p>
<p style="text-align: left"><span style="font: 12pt Helvetica;">"You want ferry mister?"</span></p>
<p style="text-align: left"></p>
<p style="text-align: left"><span style="font: 12pt Helvetica;">I don't think it was a question so much as a statement. Since unless I let go of our suitcase, we were heading for the ferry. I gave Jac a slightly desperate, questioning look, she shrugged and followed with Lily in her arms. In all the desperation I couldn't even remember the Vietnamese word for ticket to tell him we didn't have one.</span></p>
<p style="text-align: left"></p>
<p style="text-align: left"><span style="font: 12pt Helvetica;">"Khong ticket, Anh" I said as he continued dragging me to the ferry gate by my suitcase. He gave me a kind of pitying look and just kept going. When we got to the actual boarding area I was greeted by a scene like something from the evacuation of Saigon at as the Viet Cong entered the city. People were literally elbowing each other out of the way in an effort to be at the front of a queue which ended at a gate where no one was being let through and an empty gang plank to the ferry. All the activity was happening at our side of the gate and I can tell you, no one was making any life long buddies that day! One guy was almost pushed over the barrier and into the water, it was complete chaos, even by Vietnam standards.</span></p>
<p style="text-align: left"></p>
<p style="text-align: left"><span style="font: 12pt Helvetica;">The guy on the end of my suitcase detached himself and disappeared into the mayhem. I looked at Jac and raised my eyebrows as far up my forehead as they would go. She gave me doughnuts, lacking any other directions and since she was holding Lily I figured I would stick around and see what happened.</span></p>
<p style="text-align: left"></p>
<p style="text-align: left"><span style="font: 12pt Helvetica;">Amazingly, our guy was not trampled to death in the throng. He emerged with a big grin on his face and a guy in a uniform in tow.</span></p>
<p style="text-align: left"><span style="font: 12pt Helvetica;">"You want ferry?" he asked again.</span></p>
<p style="text-align: left"></p>
<p style="text-align: left"><span style="font: 12pt Helvetica;">I shrugged "Sure, but look" I somewhat superfluously pointed at the mosh pit between us and the ferry gang plank.</span></p>
<p style="text-align: left"></p>
<p style="text-align: left"><span style="font: 12pt Helvetica;">The official produced two tickets and to my utter amazement asked for the value printed on them and not a penny more. I was really having trouble working out what everyone's angle was but I decided to just go with it and gave him the money he asked for. My friend took total control of our suitcase, which was almost as big as him, and used it as a battering ram to get us to the gang plank. Jac, Lily and I trundled in his wake. When they opened the gate to let us through, a new frenzy of activity broke out and I had to do some shoving of my own to let Jac and Lily though.</span></p>
<p style="text-align: left"></p>
<p style="text-align: left"><span style="font: 12pt Helvetica;">All of a sudden like a cork from a bottle we were popped through the gate down the gang plank and into the relative quiet of the ferry. I </span></p>
<p style="text-align: left"><span style="font: 12pt Helvetica;">started getting some Dong out for our guy who took it on himself to tell me exactly how much would be appropriate for him and his official </span></p>
<p style="text-align: left"><span style="font: 12pt Helvetica;">buddy. It seemed totally reasonable to me so I paid him, shook his hand and off he went, presumably in search of another tourist to </span></p>
<p style="text-align: left"><span style="font: 12pt Helvetica;">hustle through.</span></p>
<p style="text-align: left"></p>
<p style="text-align: left"><span style="font: 12pt Helvetica;">I'm  not even going to talk about the ancient Russian made Hydrofoil , I'll leave that to another email.</span></p>
<p style="text-align: left"></p>
</div>

<div class="journalentry">
<b>Date:</b> 22 October 2008<br>
<b>Time:</b> 3:13:41 PM<br>
<b>Topic:</b> Flex MVC<br><br>
<p><span style="font: 12pt Helvetica;">When you look around at all the postings with Flex code examples and advice, it seems clear that the Flex community is largely made up of graphic artists and refugees from the last popular drag and drop programming framework (probably .NET). There are definitely some people out there coding high quality Flex applications but if the code snippets on the web are anything to go by then they are in a tiny minority.</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">I come from a structured programming background and have been writing Java/J2EE applications almost exclusively for the past 5 or 6 years, I love user interface programming and have done a lot of work on web based UIs, mostly with Javascript, Ajax and HTML. When I first saw the Flex 3 beta and heard that Adobe was going to open source Flex I was blown away, I immediately downloaded the beta Flex Builder 3 and jumped in.</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">Of course I started Googling for solutions to the problems I was having and pretty soon I realized that most of the code examples, although functional, were a pile of pants. It seems like most of the flex community has never heard of <em>separation of concerns.</em> People just seem to open up a script block and go for it right there in the middle of a presentation page, sometimes they don't even bother to do that, they just inline it inside the event they are interested in. I must admit that I initially thought this was some kind of joke. A club of deviant bloggers trying to see how successful they could be in encouraging newbies to write rubbish code.</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">Strangely the problem when you are coding Flex is exactly the opposite to when you are coding Java web applications. In Java structure is easy to find and you want an MVC framework which will make things quicker. In Flex writing applications is quite quick but you desperately need some structure since you know that a couple of months down the track you are going to be supporting your application or building new modules for it and you can quickly see that what you are writing is a no holds barred mess.</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">When you google for Flex best practice you get very little and what there is is mostly very general and stolen from the last Agile, TDD slide set the presenter watched... There are exceptions and there are some people out there doing really nice code. Some guys at Adobe had a misguided attempt to develop an MVC framework, presumably with the intention of trying to correct the horror code that was beginning to be associated with the Flex brand. Cairngorm was born. Cairngorm is basically a Singleton-fest who's only redeeming feature, IMHO, is the ServiceLocator class.</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">Nobody was thinking too deeply the day Cairngorm was born. They have few ideas and no structural assistance for separating plumbing code from the view. Most likely coders who go to the trouble of implementing a Cairngorm application will at least try to work out some type of mediator or code behind implementation of their own since core separation of view and controllers has to constantly be wired in manually in Cairngorm. Of course using Cairngorm is considerably better than using no structure at all, but all in all it is pretty lame.</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">After some time spent suffering and becoming seriously tempted to write my own MVC framework I came across PureMVC. The guys at </span><span style="font: 12pt Helvetica; text-decoration: underline;"><a href="http://www.puremvc.org/">PureMVC</a></span> <span style="font: 12pt Helvetica;">have a very nice ActionScript 3 implementation of their MVC framework which finally provides some proper structure for separating concerns. They provide a Mediator base class for extending to do your plumbing code. PureMVC also uses a more registry based approach rather than just encouraging you to conjure up singletons whenever you get to lazy too sort out your code properly. It is by no means a perfect framework, I do find myself using quite a bit of boiler plate code but with care, this can largely be factored out into factories or utility classes.</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">There definitely needs to be more work in the Flex community on application structure and separation of concerns. There is still a lot of work to do in developing a best practice for binding form fields. The Flex Binding framework seems to verge on Voodoo and behaves very unpredictably for anyone who is not aware of what is really going on under the covers. i don't think that a really good MVC framework has been written for Flex but at least there are some options starting to spring up.</span></p>
<p></p>
<p></p>
</div>

<div class="journalentry">
<b>Date:</b> 22 October 2008<br>
<b>Time:</b> 2:51:46 PM<br>
<b>Topic:</b> Flex MenuBar - allowing top level elements to be selected<br><br>
<p><span style="font: 12pt Helvetica;">Out of the box the MenuBar control kind of insists that you have children for every top level menu item in order to navigate. If you don't have any children for a MenuBarItem you don't get an ITEM_CLICK event when it is clicked. Fixing this is pretty simple but can be a little annoying since you need to listen for MouseEvent.CLICK as well as MenuEvent.ITEM_CLICK.</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">Putting another listener on the menu bar is pretty simple but you need to look out for the user clicking on the menu bar but <strong>not</strong> on a menu item. My click listener looks simething like this:</span></p>
<p></p>
<p><span style="font: 12pt Helvetica; color: rgb(16,0,255);">public</span> <span style="font: 12pt Helvetica;"></span><span style="font: 12pt Helvetica; color: rgb(39,139,82);">function</span> <span style="font: 12pt Helvetica;">handleMenuClick(event : MouseEvent) : </span><span style="font: 12pt Helvetica; color: rgb(16,0,255);">void</span> <span style="font: 12pt Helvetica;">{</span></p>
<p></p>
<p><span style="font: 12pt Helvetica; color: rgb(16,0,255);">if</span><span style="font: 12pt Helvetica;">(event.target </span><span style="font: 12pt Helvetica; color: rgb(16,0,255);">is</span> <span style="font: 12pt Helvetica;">MenuBarItem) {</span></p>
<p></p>
<p><span style="font: 12pt Helvetica; color: rgb(84,132,194);">var</span> <span style="font: 12pt Helvetica;">menuItem : MenuItem = event.target.data </span><span style="font: 12pt Helvetica; color: rgb(16,0,255);">as</span> <span style="font: 12pt Helvetica;">MenuItem;</span></p>
<p></p>
<p><span style="font: 12pt Helvetica; color: rgb(16,0,255);">if</span><span style="font: 12pt Helvetica;">(menuItem.children == </span><span style="font: 12pt Helvetica; color: rgb(16,0,255);">null</span><span style="font: 12pt Helvetica;">) {</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">app.views.selectedIndex = menuItem.navIndex;</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">}</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">}</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">}</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">In the above example i am using a very basic custom MenuItem for the data structure of my menu. It just contains the Label, Icon and a navigation index which I apply to my ViewSstacks (in the above case the ViewStack is 'app.views') as the selectedIndex the class looks like this:</span></p>
<p></p>
<p></p>
<p></p>
<p><span style="font: 12pt Helvetica; color: rgb(16,0,255);">public</span> <span style="font: 12pt Helvetica;"></span><span style="font: 12pt Helvetica; color: rgb(135,0,195);">class</span> <span style="font: 12pt Helvetica;">MenuItem {</span></p>
<p></p>
<p><span style="font: 12pt Helvetica; color: rgb(16,0,255);">public</span> <span style="font: 12pt Helvetica;"></span><span style="font: 12pt Helvetica; color: rgb(84,132,194);">var</span> <span style="font: 12pt Helvetica;">label : String;</span></p>
<p></p>
<p><span style="font: 12pt Helvetica; color: rgb(16,0,255);">public</span> <span style="font: 12pt Helvetica;"></span><span style="font: 12pt Helvetica; color: rgb(84,132,194);">var</span> <span style="font: 12pt Helvetica;">icon : String;</span></p>
<p></p>
<p><span style="font: 12pt Helvetica; color: rgb(16,0,255);">public</span> <span style="font: 12pt Helvetica;"></span><span style="font: 12pt Helvetica; color: rgb(84,132,194);">var</span> <span style="font: 12pt Helvetica;">navIndex: int;</span></p>
<p></p>
<p><span style="font: 12pt Helvetica; color: rgb(16,0,255);">public</span> <span style="font: 12pt Helvetica;"></span><span style="font: 12pt Helvetica; color: rgb(84,132,194);">var</span> <span style="font: 12pt Helvetica;">children : Array;</span></p>
<p></p>
<p><span style="font: 12pt Helvetica; color: rgb(16,0,255);">public</span> <span style="font: 12pt Helvetica;"></span><span style="font: 12pt Helvetica; color: rgb(39,139,82);">function</span> <span style="font: 12pt Helvetica;">MenuItem(label : String, navIndex : int, icon : String) {</span></p>
<p></p>
<p><span style="font: 12pt Helvetica; color: rgb(16,0,255);">this</span><span style="font: 12pt Helvetica;">.label = label;</span></p>
<p></p>
<p><span style="font: 12pt Helvetica; color: rgb(16,0,255);">this</span><span style="font: 12pt Helvetica;">.icon = icon;</span></p>
<p></p>
<p><span style="font: 12pt Helvetica; color: rgb(16,0,255);">this</span><span style="font: 12pt Helvetica;">.navIndex = navIndex;</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">}</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">}</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">If the children Array is null, I know that it is a navigation target.</span></p>
<p></p>
<p></p>
</div>

<div class="journalentry">
<b>Date:</b> 14 October 2008<br>
<b>Time:</b> 6:06:27 PM<br>
<b>Topic:</b> Flex Form Fields Submit on Enter<br><br>
<p><span style="font: 12pt Helvetica;">It's just a small thing but it can be quite annoying when you have to use the mouse in order to submit a form, particularly something like a login form where you just want to quickly type in your details and get into the application. HTML web forms have this behaviour by default, however in Flex you have to ask for it. i have not yet found a way to do it for the whole form but you simply add a listener to the FlexEvent.ENTER event for each field on the form.</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">It will look something like this:</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">&lt;form field&gt;.addEventListener(FlexEvent.ENTER, doLogin);</span></p>
<p><span style="font: 12pt Helvetica;">Where doLogin, obviously, is your login function and &lt;form field&gt; is a field on your form.</span></p>
<p></p>
</div>

<div class="journalentry">
<b>Date:</b> 25 September 2008<br>
<b>Time:</b> 10:42:45 PM<br>
<b>Topic:</b> Postcards From a Vietnam Labour Camp pt II<br><br>
<p style="text-align: left"><span style="font: 12pt Helvetica;">Jac read some of this over my shoulder and suggested that I shouldn't publish it... That was like a red rag to a bull so here goes...</span></p>
<p style="text-align: left"></p>
<p style="text-align: left"><span style="font: 12pt Helvetica;">We've got a housekeeper... there, I've said it. Its like a dirty secret that I have been keeping and now that its out I instantly feel around 25 - 28% better. I am sure we are going to be put straight into jail on our return to Australia for the pitiful amount of money we give her. I'm told that we should stick with what is standard pay but I'm certain that if we do we will be condemning ourselves to a not inconsiderable time burning in hell. Then I look back on my past and figure, who am I kidding, I'm going to burn for eternity no matter what I do from here on in.</span></p>
<p style="text-align: left"></p>
<p style="text-align: left"><span style="font: 12pt Helvetica;">I have had some exciting adventures with the toilet lately. Jacqui tells anyone who will listen how pathetic my stomach is, but I have really been pushing the boundaries recently. The other night I had to leave a bar quickly as I sensed an impending attack and after having already urinated (reluctantly) in their disgusting toilet, there was no way I was going to spend a half hour or so in there sitting down! I started getting really out of it as I got into the taxi, my gut was really going mental and I was having waves of nausea and lightheadedness. I told the taxi driver to take me to Binh Thanh district ... the bastard took me to Ben Thanh market. When I realized what was going on I was too weak to kill him, so I had to spend 10 valuable minutes getting Jacqui to text our address so that he could read it. I was way too far gone by this stage to go through the pointless exercise of trying to communicate verbally.</span></p>
<p style="text-align: left"></p>
<p style="text-align: left"><span style="font: 12pt Helvetica;">Once we started off again, this time roughly in the direction of my home, I quickly realized that there was no possible way that I could make it home with what was currently in my lower intestine. I tried telling the taxi driver that I need a toilet. He actually understood me and promptly pulled the car over. I looked around for a toilet but could see nothing, with sign language he indicated to me that I should make my deposit in the gutter right here. WTF! No, no, surely there must be a more hygienic and less demeaning way. My bowels were disagreeing but I still had enough control to override their opinion, at least for a few more minutes.</span></p>
<p style="text-align: left"></p>
<p style="text-align: left"><span style="font: 12pt Helvetica;">The public toilet I ended up at, ten grueling minutes later made the toilet at the bar look like something you might see at the Grand Hyatt. It was a filthy squat, and I was to pay for the privilege of its use. Never mind, the toilet had no mechanism for flushing that I could see, I stuffed a bunch of notes in the guys hand on my way out, god knows how much I gave him, but I can't imagine any amount could cover what I left there for him to clean up.</span></p>
<p style="text-align: left"></p>
<p style="text-align: left"><span style="font: 12pt Helvetica;">Thank god the taxi driver was still there when I got out. He gave me a look when I fell into the cab but I've had worse and I was so far beyond caring what he thought of the stupid foreigner I hardly even noticed it. I won't bore you with the details of my journey toward solid stools but suffice to say that it was a long one. I will definitely have to consider a bonus for our housekeeper, she has earned it this month.</span></p>
<p style="text-align: left"></p>
<p style="text-align: left"><span style="font: 12pt Helvetica;">Hope you all are good and never have a bowl of noodles at the shop I got mine from.</span></p>
<p style="text-align: left"></p>
</div>

<div class="journalentry">
<b>Date:</b> 22 September 2008<br>
<b>Time:</b> 8:05:31 PM<br>
<b>Topic:</b> Excluding test Classes from WTP deploy<br><br>
<p><span style="font: 12pt Helvetica;">I was finding that test classes were somehow ending up compiled into the web application deployed onto Tomcat. I spent a fair bit of energy reading through the Eclipse ETP help files but there wasn't any reference that I could find to reconfiguring an existing dynamic web application. In desperation I started hunting through the configuration files under the .settings folder in my project ad low and behold there i found it.</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">Just in case i forget or someone else has this problem the file is called org.eclipse.wst.common.component in that file are wb-resource entries for each source folder which is being compiled and/or copied into the classes directory under WEB-INF. I deleted the entries for source/test/java and source/test/resources and that took care of things.</span></p>
<p></p>
<p></p>
</div>

<div class="journalentry">
<b>Date:</b> 20 September 2008<br>
<b>Time:</b> 10:37:55 PM<br>
<b>Topic:</b> Postcards From a Vietnam Labour Camp pt I<br><br>
<p style="text-align: left"><span style="font: 12pt Helvetica;">Drivers in Vietnam take no prisoners. It is a brutal dog-eat-dog world over here and there is no better exemplar than the traffic on the road. Drivers here are truly cosmopolitan, in that they combine the worst traits of drivers from all over the world. Road rules here are treated as advisory at best, even driving on the right side of the road appears to be optional. There are literally millions of motorcycles on the road at any given time. Only the fact that the roads are virtually constantly in a state of gridlock and no one can travel at speeds in excess of 20 - 30 kmh stops the numbers of fatalities reaching a number high enough for the UN to prosecute the Vietnamese for ethnically cleansing themselves.</span></p>
<p style="text-align: left"></p>
<p style="text-align: left"><span style="font: 12pt Helvetica;">The noise over here is absolutely constant. Mostly due to the insane numbers of motorbikes on the road, and the fact that horns seem to be used as an alternative to road rues. When we moved into our apartment we were initially a little concerned to see that there was a construction site being prepared next door for a high-rise building. Of course we thought that the noise from such a site might effect the 'quiet enjoyment' of our apartment. Hahahaha, how naive we were. I cannot possibly hear the sound of construction over the traffic noise... I needn't have worried myself!</span></p>
<p style="text-align: left"></p>
<p style="text-align: left"><span style="font: 12pt Helvetica;">I'm sorry, but I really don't get Karaoke. Not just in Vietnam, but anywhere. I don't understand why people would want to get up in front of their peers and provide documentary evidence of their alcoholism and complete lack of singing ability. We have a karaoke bar over the road from our apartment and the strains of some desperate dickhead murdering "Major Tom" or "Hotel California" floats up when we leave the balcony door open and reminds me of how grateful I should be that my tracheostomy precludes me ever making such an idiot of myself.</span></p>
<p style="text-align: left"></p>
<p style="text-align: left"><span style="font: 12pt Helvetica;">Vietnam is teaching me the lesson of patience. Things happen very slowly here. Nobody hurries and everything official has an immensely complicated bureaucracy to navigate before it can be completed and basic service related tasks are done with a complete lack of urgency even when a line of 10 or 20 people are waiting. The temptation to scream at the guy operating the coffee machine in the morning to "just fucking hurry up!" is almost irresistible. Luckily no one understands the crazy westerner anyway so if I do lose it one day they will probably just think I am having a seizure of some sort.</span></p>
<p style="text-align: left"></p>
</div>

<div class="journalentry">
<b>Date:</b> 20 September 2008<br>
<b>Time:</b> 3:39:00 PM<br>
<b>Topic:</b> Battle of the IDEs<br><br>
<p><span style="font: 12pt Helvetica;">I have always been a die hard Eclipse fan. Ever since the days of 2.1. A few years ago I started using the MyEclipse plugin to get hot-deploy to Tomcat. It quickly became indispensable to me and even when I started using maven and, what was then a very flaky plugin, M2Eclipse I persisted and wore the pain.</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">About 18 months ago I bought a Macbook Pro and my love affair with Eclipse and particularly MyEclipse plunged. I just could not seem to get a stable build. It would constantly crash...<strong>constantly.</strong> After many calls to MyEclipse and hundreds of different configurations I took the plunge an moved to IntelliJ.</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">Wow, what a lovely IDE. Smooth, everything just works (except the PMD plugin), but I kept feeling just a little bit dirty, just a little like I had sold out. As if forsaking Linux wasn't enough, now I was forsaking my open source IDE! Also the use of space in IntelliJ kind of sucked. All the wasted space in margins makes it hard to use with multiple panels open unless you have a monster screen. I think most of that is due to the incredibly poor attention to detail in Java Swing UI components. Making a sexy looking Swing app is like walking over hot coals.</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">A little while ago I got involved in a project with a bunch of friends who were using Eclipse Ganymede without the need for MyEclipse. They were using the native functionality for hot deploy to the server. I was initially reluctant to go back to Eclipse after all the past pain but developing in different physical locations using different IDE's really started to make some things more difficult than they needed to be so I downloaded Ganymede and gave it a go...</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">Rock solid on the Mac. I have been using it for the past few months without a single crash. The SWT UI is obviously a lot sexier than the IntelliJ Swing UI. The hot deploy is a bit of a pain in the arse to sort out when combined with M2Eclipse, but after a bit of tinkering around that is all working well too. The recent work on M2Eclipse has improved it out of site and integration with Maven 2 in Eclipse is now closing on what IntelliJ has had all along. The major down side is the SVN integration. Subversive is not bad, although a right pain in the arse to install, yet it is not a pinch on the IntelliJ native Subversion support. This is absolutely superb, the 3 way merge tool is brilliant, the ability to view annotations in your code to see who changed what, the constant monitoring of your repo all go to making it a pleasure to use.</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">I don't have a conclusion on which is the best for me. I am back to using Eclipse almost exclusively and enjoying the experience but every now and then I really miss a feature from IntelliJ. I will download 8.0 when it gets out of Beta and have a look but it would need to provide some pretty compelling reason for me to switch back, mostly because most of the developers I work with are using Eclipse and the difference in IDEs can make some things difficult.</span></p>
<p></p>
<p></p>
</div>

<div class="journalentry">
<b>Date:</b> 17 September 2008<br>
<b>Time:</b> 2:22:48 PM<br>
<b>Topic:</b> Unit Testing with mock objects<br><br>
<p><span style="font: 12pt Helvetica;">The main reason for using mock objects to write unit tests is so that they <em>are</em> unit tests. Without mock implementations, unit tests quickly become integration tests. There is nothing wrong with integration tests however they tend to make coverage data inaccurate, since code which is exercised incidentally rather than being directly tested gets marked as covered, and they can end up slowing down the test suite since these types of tests usually involve having to load the complete application context in a Spring application or they require a container and a JNDI instance for other J2EE apps.</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">My motto is <em>keep it simple</em>. I don't like to think too much, particularly about my tests. When I see a red bar I don't want to have to wonder whether it is the method under test which is broken or if it is one of its dependencies. I like to be certain that it is the method under test. It greatly reduces the time it takes me to get the green bar of goodness back.</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">I, personally, use EasyMock as my mock framework of choice. Combined with Unitils it takes a great deal of drudgery out of mocking out dependencies. Using the Unitils EasyMock annotations you can mark an interface as a mock using @Mock and mark the class under test which will have the mocks injected using @TestedObject. This doesn't seem to work on classes using constructor injection, however it works fine for setter injection and means there is no need to manually setup your mocks and inject them into the class under test.</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">Complete details on how to use these annotations can be found </span><span style="font: 12pt Helvetica; text-decoration: underline;"><a href="http://www.unitils.org/tutorial.html#Testing_with_mock_objects">here</a></span></p>
<p></p>
</div>

<div class="journalentry">
<b>Date:</b> 3 September 2008<br>
<b>Time:</b> 1:20:41 PM<br>
<b>Topic:</b> Eclipse Ganymede plugins<br><br>
<p><span style="font: 12pt Helvetica;">It has been quite a while since I posted on Eclipse plugins I am using. All the URLs have changed and so have many of the plugins I find essential for development. Here is an update on the plugins I recommended last time and the ones I'm using now:</span></p>
<ol style="list-style-type: decimal">
<li></li>
<li><span style="font: 12pt Helvetica;">MyEclipse: I have ditched this as an unstable, annoying, and largely useless waste of money. Ganymede WST provides all the Sever hot deploy stuff that was good in the older MyEclipse editions out of the box, most of the rest can be found in various free  plugins I will detail here. When I was working mostly in Windows or Linux this plugin was okay, but on the Mac MyEclipse crashes almost constantly and is a complete time waster. Virtually nothing interesting, which might save you money even works on the Mac, ie. UML, Javascript debug, image editing. Also the new installer is crap... I'm over these guys, $60/yr is a nice price point for a useful plugin set but really this is worse than useless if you are a Mac user.</span></li>
<li></li>
<li><span style="font: 12pt Helvetica;">Spring IDE - If you are doing Spring development you cannot live without this plugin. Provides Spring configuration validation and help with code completion. URL: http://springide.org/updatesite/</span></li>
<li></li>
<li><span style="font: 12pt Helvetica;">Subclipse: I have trashed this. The conflict resolution was kind of buggy and failure prone. Maybe it was operator error, but I got sick of trying to manage broken merges and migrated to Subversive.</span></li>
<li></li>
<li><span style="font: 12pt Helvetica;">Subversive: This is becoming the Eclipse default SVN plugin. Why Ganymede does not have an SVN plugin out of the box is beyond me, is anyone still using CVS these days??? The only downside of Subversive is that it is slightly tricky to install as the install instruction have you jumping all over the web to get the update site urls for the connectors and the actual plugin. Here is the long and the short of it...
</span><ol style="list-style-type: decimal">
<li></li>
<li><span style="font: 12pt Helvetica;">Plugin site URL:http://download.eclipse.org/technology/subversive/0.7/update-site/</span></li>
<li></li>
<li><span style="font: 12pt Helvetica;">Connector site URL: http://www.polarion.org/projects/subversive/download/eclipse/2.0/update-site/</span></li>
<li></li>
</ol>
</li>
<li> <span style="font: 12pt Helvetica;">If you are using OS X or Linux you will need to unselect some of the windows JavaHL connectors</span></li>
<li></li>
<li><span style="font: 12pt Helvetica;">M2Eclipse: This plugin has really come a long way since it was released a year or so ago. Previously the only useful thing about it was the repository search. Now it allows quite reasonable management of your Maven 2 project from within Eclipse. For those afraid of editing XML the new pom editor is really useful. I still don't think the integration is quite as seamless as IntelliJ but it is now quite acceptable. URL: http://m2eclipse.sonatype.org/update/</span></li>
<li></li>
<li><span style="font: 12pt Helvetica;">Eclemma is still the best free coverage plugin I am aware of. Again it is annoying that the IntelliJ emma integration is more seamless and intuitive but the Eclipse integration is quite workable. I had troubles installing this on Ubuntu, although it installed fine on my Mac. If you have problems it is quite simple to go to the eclemma site (<em>www.<strong>eclemma</strong>.org)</em> and download it. Unzip it and drop the contents of the plugin/ and features/ folders into their respective folders under your eclipse installation. URL: http://update.eclemma.org/</span></li>
<li></li>
<li><span style="font: 12pt Helvetica;">PMD: This plugin is very handy for getting quick feedback on code style. We have been using PMD for a while and have a company ruleset.xml. I like the way you can prioritize problems and then filter by priority in the IDE, but I am still in 2 minds as to whether this is actually better than Checkstyle. URL:  http://pmd.sourceforge.net/eclipse</span></li>
<li></li>
</ol>
<p></p>
<p></p>
</div>

<div class="journalentry">
<b>Date:</b> 15 August 2008<br>
<b>Time:</b> 11:49:46 AM<br>
<b>Topic:</b> Installing Postgres on Ubuntu 8.04<br><br>
<p><span style="font: 12pt Helvetica;">This is  a fairly simple process (the client install is optional as pgadmin is a far better client):</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">sudo apt-get install postgresql postgresql-client</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">Install pgadmin:</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">sudo apt-get install pgadmin3 </span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">then you will need to reset the password for the postgres user:</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">$ sudo su postgres -c psql</span></p>
<p><span style="font: 12pt Helvetica;">postgres=# ALTER USER postgres WITH PASSWORD 'password';</span></p>
<p><span style="font: 12pt Helvetica;">postgres=# \q</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">You can now connect to postgres using pgadmin using the password you entered above.</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">If you want to be able to access Postgres from other computers than the one it is installed on then you will need to modify the /etc/postgresql/8.3/main/pg_hba.conf  (this is the location in Ubuntu).</span></p>
<p><span style="font: 12pt Helvetica;">The file has a large commented section describing how to configure access from other machines on your network but it boils down to adding an entry something like this:</span></p>
<p><span style="font: 12pt Helvetica;">host all postgres 192.168.1.0/24 md5</span></p>
<p><span style="font: 12pt Helvetica;">The above line tells postgres that the postgres user can access all databases from any machine in the 192.168.1.* subnet. Credentials will be sent encoded using md5. There are a bunch of more complicated ways that you can setup authentication but this basic example will get you started. Later you may want to use the ident authentication method and maintain dbusers in the pg_ident.conf file (located in the same directory as the ph_hba.conf file).</span></p>
<p></p>
</div>

<div class="journalentry">
<b>Date:</b> 20 July 2008<br>
<b>Time:</b> 6:03:38 PM<br>
<b>Topic:</b> No Test, No Agile<br><br>
<p><span style="font: 12pt Helvetica;">This should be obvious, but I seem to find myself re-explaining this concept quite a bit. <em>Without testing there can be no Agile development.</em> Tests are not an optional extra, there can be no negotiation. If you are doing agile, you are doing tests. You can test first, my personal preference, or you can test immediately after, but you must write tests.</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">One of the core values of the Agile manifesto is responding to change over following a plan. Agile development is predicated on writing the simplest solution which meets business requirements and nothing more (YAGNI principle). This can only be done if the developer(s) are able to refactor later as requirements become more complex or change.</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">Developers will either not refactor at all or take an extremely long time to achieve refactorings if they don't have tests in place that give them confidence that their changes have not broken existing functionality. No test, no agile. Other features of agile development may or may not be optional, but testing is definitely not.</span></p>
<p></p>
<p></p>
<p></p>
<p></p>
</div>

<div class="journalentry">
<b>Date:</b> 18 July 2008<br>
<b>Time:</b> 10:00:00 AM<br>
<b>Topic:</b> Managing databases for ORM based applications<br><br>
<p><span style="font: 12pt Helvetica;">Powerful ORM frameworks like hibernate and Ibatis and more recently JPA based ORM frameworks like Toplink, Hibernate and openJPA have taken a great deal of drudgery and error prone code out of the average enterprise application codebase. Many IDEs now provide powerful tool support for writing and maintaining code based on these frameworks. One effect of all this has been to move attention away from the database and into code, particularly in instances where developers are using automatic ddl generation from their ORM framework.</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">In such a situation, developers often don't think about the effect that changes to their java code are having on the underlying database. Before there has been an initial release this may not necessitate migration of production data, but it can lead to large amounts of time wasted when changes in code necessitate schema changes, particularly if these changes clash with schemas other developers have established in their development environment. After an initial production release it can lead to serious problems if developers alter domain objects which are mapped using ORM frameworks. Simple XML or Annotation changes can wipe out or make redundant whole segments of the production database when released into the wild, or completely alter the semantics of existing data.</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">There is no doubt that a new discipline is required for developers when writing code using ORM frameworks. Paritcularly where there are multiple developers and potentially multiple production releases (pretty well every agile project I have ever known). This discipline should focus on the database schema that ORM frameworks are generating. Such schemas need to be versioned in the same way as the codebase is versioned. Luckily a tool called Liquibase exist for exactly this problem.</span></p>
<p></p>
<p><span style="font: 12pt Helvetica; text-decoration: underline;"><a href="http://www.liquibase.org/">Liquibase</a></span> <span style="font: 12pt Helvetica;">provides for the creation and maintanence of database schemas and their data. I have not yet used it to make changes on production databases but we have been using it in development and it has had a very positive effect on productivity as developers no longer have to spend time working out why their tests are no longer working only to eventually discover that it is due to data changes conflicting with their existing schema.</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">Liquibase manages schemas and data through change sets and the database itself. It stores the change set ids in the database along with a checksum for the change set so that it can determine if the change set has been altered, invalidating it against that database.</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">With Liquibase in place the database can be generated and/or updated without the use of the ORM frameworks auto generation of DDL, in fact it is essential that this be turned of. For Spring applications a data migrator bean can be configured to automatically generate or update the database on startup of the application context and check that the schema is valid for application data mappings. If this is not desirable Liquibase has Ant targets and Maven goals that can be executed.</span></p>
<p></p>
</div>

<div class="journalentry">
<b>Date:</b> 18 March 2008<br>
<b>Time:</b> 10:31:08 AM<br>
<b>Topic:</b> weblogic descriptor<br><br>
<p><span style="font: 12pt Helvetica;">Just so I don't have to google this again, here is how to fix the weblogic.xml descriptor when you get this message:</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">library is on the classpath of this project, but is not in the weblogic.xml file</span></p>
<p><span style="font: 12pt Helvetica;"><strong>Adding a library reference to the deployment descriptor</strong></span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">1. Select and expand the project in question in the <strong>Project Explorer</strong> view.</span></p>
<p><span style="font: 12pt Helvetica;">2. Locate the node labeled <strong>WebLogic Deployment Descriptor</strong> and expand it.</span></p>
<p><span style="font: 12pt Helvetica;">3. Find the node labeled <strong>J2EE Libraries</strong>.</span></p>
<p><span style="font: 12pt Helvetica;">4. Right-click on the <strong>J2EE Libraries</strong> node and select <strong>Add</strong>.</span></p>
<p><span style="font: 12pt Helvetica;">5. Click <strong>Browse</strong> and choose the library that should be referenced.</span></p>
<p><span style="font: 12pt Helvetica;">6. Adjust the reference information as necessary.</span></p>
<p><span style="font: 12pt Helvetica;">7. Click on the <strong>Ok</strong> button.</span></p>
<p></p>
</div>

<div class="journalentry">
<b>Date:</b> 17 March 2008<br>
<b>Time:</b> 10:37:28 PM<br>
<b>Topic:</b> Testing Flex<br><br>
<p><span style="font: 12pt Helvetica;">Flex applications are reasonably easy to write, and they certainly build themselves a lot faster than standard web applications which need a rich user interface. Testing them is a bit of a problem though. I looked as ASUnit initially, but the whole framework was so Windows-centric that I gave up in disgust. I could tell after a very short time that even if I got it working on my Mac there would be no way to run it in an automated build loop.</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">After that I started playing with FlexUnit. This framework is much more generic and quite simple to use. The most confusing thing about it is that there seems to be a FlexUnit project on Sourceforge as well as Google code and they don't appear to have anything to do with each other. I couldn't make head 'nor tail of the Sourceforge one but the version on </span><span style="font: 12pt Helvetica; text-decoration: underline;"><a href="http://code.google.com/p/as3flexunitlib/">Google code</a></span><span style="font: 12pt Helvetica;">, which appears to have some Adobe support behind it was simple to install and use and </span><span style="font: 12pt Helvetica; text-decoration: underline;"><a href="http://www.adobe.com/devnet/flex/articles/unit_testing.html">this article</a></span> <span style="font: 12pt Helvetica;">gives quite detailed instructions about how to use it.</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">Testing in Flex is still not always that easy, even when you have a reasonably easy to use framework like FlexUnit. You still have to write code which can be unit tested. This is the real value of rigorously testing your code. You have to write your code in such a way as it can be tested. When you do this your code becomes more loosely coupled and more highly decomposed. This leads to not only more testable code, but to more re-usable code..."Vive le testing"</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">Once you have tests you need a constant integration loop to run your tests and keep you honest. Initially we didn't think this would be possible, turns out we were wrong. </span><span style="font: 12pt Helvetica; text-decoration: underline;"><a href="http://code.google.com/p/antennae/">Antennae</a></span> <span style="font: 12pt Helvetica;">is an open source project on Google code which addresses exactly this problem. A detailed explanation of how to install and use it can be found in the </span><span style="font: 12pt Helvetica; text-decoration: underline;"><a href="http://www.adobe.com/cfusion/communityengine/index.cfm?event=showdetails&postId=7322&productId=2&loc=en_US">Flex Cookbook</a></span><span style="font: 12pt Helvetica;">. There is a fair bit of mucking around involved, but with a bit of determination you can reasonably easily get your Flex codebase to build and execute it's FlexUnit tests in a constant integration loop.</span></p>
<p></p>
</div>

<div class="journalentry">
<b>Date:</b> 15 March 2008<br>
<b>Time:</b> 7:31:46 PM<br>
<b>Topic:</b> Migration Complete!<br><br>
<p style="text-align: left"><span style="font: 12pt Helvetica;">Ok, my weblog has found a new home. It started life at Voodoo Programming, a domain I let lapse when I began consulting too regularly to do any work there. It then lived a private life on my laptop for a while, it didn't see a lot of action during that time. Now it has a new home at oneadam. Hopefully I will be a bit more diligent about blogging things again, now that I have my vanity domain, I have been extremely slack of late. I look forward to broadening my blogging horizons, perhaps not just limiting myself to tech tricks and notes to self.</span></p>
<p style="text-align: left"></p>
</div>

<div class="journalentry">
<b>Date:</b> 8 March 2008<br>
<b>Time:</b> 5:11:03 PM<br>
<b>Topic:</b> Multiline Labels<br><br>
<p style="text-align: left"><span style="font: 12pt Helvetica;">Doh, blew quite a bit of time on this thinking that there must be some way to make a Label multiline... there isn't! Have to use a Text control. Note to self: Google first, think and experiment later.</span></p>
<p style="text-align: left"></p>
</div>

<div class="journalentry">
<b>Date:</b> 16 February 2008<br>
<b>Time:</b> 9:26:48 AM<br>
<b>Topic:</b> Flex BlazeDS Spring an Integration Story<br><br>
<p><span style="font: 12pt Helvetica;">At the Melbourne Spring User Group (MSUG) meeting in Feb I presented on integrating an Adobe Flex Rich Internet Application with a J2EE services tier using Spring as the integration glue and BlazeDS for lightweight binary data transfer using ActionScript message Format (AMF). I have made the slides from that presentation available </span><span style="font: 12pt Helvetica; text-decoration: underline;"><a href="http://www.oneadam.net/wp-content/uploads/2008/03/flex-spring.ppt">here</a></span><span style="font: 12pt Helvetica;">.</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">Many people seem to think that their has to be some hard decision made about whether to go with the sexy flash based user interface of a Flex application, or the robust, scalable dependability delivered by a Java based application. I say "Why not have the best of both worlds?". The approach I outline is completely Open Source and free and it is trivially easy to configure BlazeDS to use the Spring bean factory to expose a standard Spring service facade to remoting calls by a Flex application.</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">Documentation for BlazeDS can be found </span><span style="font: 12pt Helvetica; text-decoration: underline;"><a href="http://livedocs.adobe.com/labs/blazeds/html/index.html">here</a></span><span style="font: 12pt Helvetica;">. An explanation of the Adobe example Spring factory can be found </span><span style="font: 12pt Helvetica; text-decoration: underline;"><a href="http://livedocs.adobe.com/blazeds/1/blazeds_devguide/help.html?content=factory_2.html">here</a></span><span style="font: 12pt Helvetica;">. it contains the source code as well. You will need to copy it and paste it into your project source tree.</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">I hope this is useful to people.</span></p>
<p></p>
</div>

<div class="journalentry">
<b>Date:</b> 10 February 2008<br>
<b>Time:</b> 2:57:52 PM<br>
<b>Topic:</b> J2ME Logging<br><br>
<p><span style="font: 12pt Helvetica;">As soon as an enterprise developer starts developing for mobile devices the paradigm changes. For me reliable logging is almost the first thing I missed in J2ME. Even System.out, were you to be so crass as to use it ;), is unreliable on some devices.</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">I found a sourceforge project called </span><span style="font: 12pt Helvetica; text-decoration: underline;"><a href="http://microlog.sourceforge.net/">MicroLog</a></span><span style="font: 12pt Helvetica;">Â this looks very promising. It is log4j compatible and the download is only the source code so you simply add it to your project source tree. It is quite lightweight and considering the development time wasted when you cannot get reliable debug information it seems well worth it.</span></p>
<p></p>
</div>

<div class="journalentry">
<b>Date:</b> 20 January 2008<br>
<b>Time:</b> 10:24:13 PM<br>
<b>Topic:</b> Flex as a J2EE MVC Tier<br><br>
<p><span style="font: 12pt Helvetica;">I began my web programming life using Perl and PHP and I don't like the idea of becoming a language snob, however, I have to admit I have been somewhat of a Java purist over the past couple of years in particular and I saw no reason to make an exception for the presentation tier.</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">I was thinking the other day about that saying: '<em>When your only tool is a hammer, everything looks like a nail</em>'. This came up when I was looking at working AJAX functionality into a Spring MVC web application. I had already worked JQuery into the UI for effects and to speed up querying the DOM. I had an custom tag library called SpringLayout, which I was using to integrate error messages and speed up validation responses. I had Yahoo! tabs going for client side tabs, and I started thinking about how difficult this application would be to maintain, particularly if that person wasn't me.</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">What I was really after was a Rich Internet Application (RIA). Because Java is my hammer, the RIA looked like a nail. But I started wondering whether there might be an easier way to achieve the rich user experience without sacrificing the well tested and proven Java application... along came Flex 3. Flex uses a component based approach based on ActionScript. I'm not going to go into the details of the Flex application framework, except to say that writing RIAs is extremely simple and intuitive using Flex and flex builder.</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">One of the interesting side effects of moving to a non-Java presentation tier technology is that you quickly become aware of areas where you have allowed application logic to bleed into the presentation tier. Without some type of artificial barrier, such as having to translate objects into ActionScript, it is quite possible for POJO based applications to leak some of their business logic out into the MVC layer. Kept to a minimum this is not the end of the world, however I prefer to have a complete separation, particularly since we often have to expose business services to automated clients.</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">BlazeDS has been an interesting tool in coming to terms with Flex as the client for my java based applications. It is an open source offering from adobe, allowing Flex clients to make RPC calls or access JMS queues and topics and has recently been released as a Beta. It performs the translation to ActionScript Message Format (AMF) transparently, greatly easing the effort in developing a transport and translation service for your Flex client. It is essentially a cut down version of the Adobe LiveCycle Server.</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">I will be blogging in more detail on the technical issues I have come across in coding in Flex and using Flex Builder as well as plugging in BlazeDS.</span></p>
<p></p>
</div>

<div class="journalentry">
<b>Date:</b> 11 November 2007<br>
<b>Time:</b> 9:34:49 PM<br>
<b>Topic:</b> MyEclipse tomcat will not deploy<br><br>
<p><span style="font: 12pt Helvetica;">This is really irritating. I can't even count the number of times the MyEclipse hot deployment to Tomcat has gone pear shaped. Fixing this particular problem can really waste a lot of time.</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">Symptoms: Repeated message that MyEclipse cannot redeploy to Tomcat as the deployment is locked. Various recommendations follow that you stop tomcat and redeploy, ect and they all fail. When this really starts getting weird is when you undeploy remove the deployment in MyEclipse, restart Eclipse and Tomcat and still the same stuff happens.</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">Solution: You have to get really medieval on it.</span></p>
<ol style="list-style-type: decimal">
<li></li>
<li><span style="font: 12pt Helvetica;">Remove the deployment.</span></li>
<li></li>
<li><span style="font: 12pt Helvetica;">Stop tomcat</span></li>
<li></li>
<li><span style="font: 12pt Helvetica;">Refresh the project</span></li>
<li></li>
<li><span style="font: 12pt Helvetica;">Start Eclipse from the command line using the -clean flag i.e. $eclipse -clean or c:\eclipse.exe -clean (in windows)</span></li>
<li></li>
</ol>
<p></p>
<p></p>
</div>

<div class="journalentry">
<b>Date:</b> 27 August 2007<br>
<b>Time:</b> 10:48:28 AM<br>
<b>Topic:</b> Eclipse plugins<br><br>
<p><span style="font: 12pt Helvetica;">Below is a list of eclipse 3.2 plugins which I like and whos URLs I am constantly forgetting. hopefully I will never need to google these again :)</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;"><strong>1. The Maven 2 plugin</strong> provides the ability to search the various Maven repos for dependecies. It also allows the prject to be built by the Maven builder, automatically manages your POM and will attach source if requested. This plugin was a little buggy initially but seems to be fine now. If you are building your project with Maven 2 I really recommend this.</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">Update site: </span><span style="font: 12pt Helvetica; text-decoration: underline;"><a href="http://m2eclipse.sonatype.org/update/">http://m2eclipse.sonatype.org/update/</a></span></p>
<p></p>
<p><span style="font: 12pt Helvetica;"><strong>2.Emma plugin for eclipse</strong>. This provides full coverage analysis as a plugin for eclipse. It allows you to run your test suite under Emmas coverage analysis tool and provides immediate feedback as well as code highlighting to indicate sections of code which have not been visited by tests. This plugin is really useful for keeping you honest.</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">Update site: http://update.eclemma.org/</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;"><strong>3. a) Subclipse</strong> is a subversion plugin from tigris. It is free and provides pretty much all the same features you are used to seeing for CVS, but for SVN. It also has some nice features for navigating into branches and branching with uncommited code, etc</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">The eclipse update site for this is: </span><span style="font: 12pt Helvetica; text-decoration: underline;"><a href="http://subclipse.tigris.org/update_1.4.x">http://subclipse.tigris.org/update_1.4.x</a></span></p>
<p></p>
<p><span style="font: 12pt Helvetica;"><strong>b)</strong>Another Subversion plugin for elipse is <strong>Subversive</strong>. i changed to this plugin recently because it seems to resolve conflicts in a manner more like the old CVS conflict resolution tool. The icon set is not quite as nice as the Subclipse set, but it seems to perform slightly better for conflict resolution.</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">Update site: http://www.polarion.org/projects/subversive/download/1.1/update-site/</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;"><strong>4. Veloedit </strong>is a Velocity template editor. Very basic, but better than nothing when you are writing velocity templates.</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">Update site: http://veloedit.sourceforge.net/updates/</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;"><strong>5. XFire plugin</strong>. This is quite a useful plugin if you want IDE support for xFiring service endpoints.</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">Update site: http://dist.codehaus.org/xfire/update/</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;"><strong>6. Spring IDE</strong>. If you are using Spring this is a must-have plugin. Provides bean file support for dependencies as well as making sure that class names are valid.</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">Update site: </span><span style="font: 12pt Helvetica; text-decoration: underline;"><a href="http://dist.springframework.org/release/IDE">http://dist.springframework.org/release/IDE</a></span></p>
<p></p>
</div>

<div class="journalentry">
<b>Date:</b> 9 July 2007<br>
<b>Time:</b> 3:03:12 PM<br>
<b>Topic:</b> Configuring Hudson SVN access<br><br>
<p><span style="font: 12pt Helvetica;">I just wanted to make a note of this URL in case I forget where to configure the hudson SVN access. It was a pain to work this out:</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">http://&lt;hudson-url&gt;/scm/SubversionSCM/enterCredential</span></p>
<p></p>
</div>

<div class="journalentry">
<b>Date:</b> 24 April 2007<br>
<b>Time:</b> 12:28:22 PM<br>
<b>Topic:</b> Maven Tests with Spring propertyPlaceHolderConfig<br><br>
<p><span style="font: 12pt Helvetica;">This seemingly innocuous combination cost me almost a full day to debug. The error I was getting was:</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">Caused by: org.springframework.beans.factory.BeanDefinitionStoreException: Error registering bean with name 'mailSender' defined in ServletContext resource [/WEB-INF/applicationContext.xml]: Could not resolve placeholder 'smtp.host'</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">The configuration file was being found, however the properties were not being loaded into by the propertyPlaceHolder. The solution to this is to use the SystemClassLoader, which is not the default for the surefire plugin you can define it like this:</span></p>
<p></p>
<p></p>
<p><span style="font: 12pt Helvetica;">&lt;plugin&gt;</span></p>
<p><span style="font: 12pt Helvetica;">&lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;</span></p>
<p><span style="font: 12pt Helvetica;">&lt;artifactId&gt;maven-surefire-plugin&lt;/artifactId&gt;</span></p>
<p><span style="font: 12pt Helvetica;">&lt;configuration&gt;</span></p>
<p><span style="font: 12pt Helvetica;">&lt;useSystemClassLoader&gt;true&lt;/useSystemClassLoader&gt;</span></p>
<p><span style="font: 12pt Helvetica;">&lt;excludes&gt;</span></p>
<p><span style="font: 12pt Helvetica;">&lt;exclude&gt;</span></p>
<p><span style="font: 12pt Helvetica;">this dummy value is to override surefire's default</span></p>
<p><span style="font: 12pt Helvetica;">&lt;/exclude&gt;</span></p>
<p><span style="font: 12pt Helvetica;">&lt;/excludes&gt;</span></p>
<p><span style="font: 12pt Helvetica;">&lt;/configuration&gt;</span></p>
<p><span style="font: 12pt Helvetica;">&lt;/plugin&gt;</span></p>
<p><span style="font: 12pt Helvetica;">Hopefully this is helpful to people trying to use this combination of Maven and the Spring propertyPlaceHolderConfig</span></p>
<p></p>
</div>

<div class="journalentry">
<b>Date:</b> 8 March 2007<br>
<b>Time:</b> 12:04:58 PM<br>
<b>Topic:</b> Rapid Enterprise Level Web Development Without Drag &amp;amp; Drop<br><br>
<p><span style="font: 12pt Helvetica;">This topic has waxed and waned in importance for me (mostly depending on how our team is going with meeting deadlines) but it is never completely out of my mind. Coding style, maintainability and robustness have always been more important to me than speed and so I am not a great fan of the Web application drag and drop development frameworks I have seen. Even though it is a quick way to get a form setup, it almost invariably leads to nasty code which can be harder to tidy up than just doing the thing yourself in the first place.</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">That being said, in a competitive marketplace, for a company writing custom applications to be viable you need tools and code libraries to speed up the development process in ways which don't reduce quality. Frameworks like Spring, Hibernate &amp; the new JPA EJB 3.0 go a long way toward speeding up the development process for enterprise class applications but the MVC part of the equation has always been a sticking point in my experience.</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">Spring MVC solves one part of the problem, that of backing web forms with plain old java objects (POJOs) rather than the Struts approach of having action forms with String fields which have to be manually converted in the action to resolve to POJOs. This is done via property editors, Simple types such as Integer and Date are provided and users can implement custom logic to do the conversion on more complex, user defined types.</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">The next time consuming problem is UI layout, validation and display of messages to the user. In my opinion, small UI concerns and tricky validation issues burn inordinate amounts of time in web based applications. The solution to this seems to be a well constructed tag library which is terse and has flexible and easy to extend validation. The need for this tag library is what drove myself, rob and others at Groupware, when I was working there, to develop the SpringLayout framework, essentially an extension to Spring MVC with a highly coupled tag library and validation framework.</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">SpringLayout is still in it's infancy but already has proven of great worth in data gathering applications, short-cutting the time it takes us to develop our applications. I will be interested to see whether other developers get the same degree of usefulness out of it as we have so far and to get there feedback on the developer experience.</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">I wonder what other developers think about RAD for Web Applications?</span></p>
<p></p>
</div>

<div class="journalentry">
<b>Date:</b> 7 March 2007<br>
<b>Time:</b> 5:53:29 PM<br>
<b>Topic:</b> iTrack on Sourceforge<br><br>
<p><span style="font: 12pt Helvetica;">The iTrack code base has now officially moved to sourceforge. I will soon build a war for people to download and deploy.</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">iTrack is a J2EE Web Based Bug Tracking and Issue Management tool which I began as an out of hours project at Groupware and was then taken up by groupware and developed further for managing software projects for clients. It is based on the Spring/Hibernate stack and uses OS Workflow, ACEGI Security, SpringLayout tags and Display tags.</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">It is currently aimed at Client/Developer relationship management but the next release will see support for anonymous defect logging on projets marked as Public.</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">The project's homepage is now at: </span><span style="font: 12pt Helvetica; text-decoration: underline;"><a href="http://itrack.sourceforge.net/">sourceforge</a></span></p>
<p></p>
</div>

<div class="journalentry">
<b>Date:</b> 10 February 2007<br>
<b>Time:</b> 12:45:58 PM<br>
<b>Topic:</b> Javascript Optimization<br><br>
<p><span style="font: 12pt Helvetica;">Writing efficient Javascript doesn't really seem to matter too much while you are trying to make something work. Mostly people don't take Javascript too seriously and more often than not just hack something together that works regardless of other considerations... or maybe that's just me :)</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">When you are writing Javascript that will be re-used and is likely to be called on a page multiple times, and that page grows and grows, suddenly you can find yourself with a web page which performs like a dog and most likely leaks to boot. I have had a few experiences like this and after writing the validation framework for the Spring Layout tags I have had an opportunity to revise my style and I thought that I would articulate a few principles here that have greatly aided me in writing efficient Javascript.</span></p>
<ol style="list-style-type: decimal">
<li></li>
<li><span style="font: 12pt Helvetica;">When accessing form variables, use the form field collection rather than the DOM. It is tempting to just use the prototype $ function all the time but it is extremely inefficient compared to getting the field from the forms field collection or better still getting a reference from the event source.</span></li>
<li></li>
<li><span style="font: 12pt Helvetica;">Use methods like addEvent(...) sparingly. Most people, these days add Javascript events dynamically using some wrapper to genericize the method for IE and Mozilla. This is a good practice, but if a lot of methods are going to be added to an event it can become quite heavy weight. Consider aggregating functions whenever possible to make this more efficient.</span></li>
<li></li>
<li><span style="font: 12pt Helvetica;">Always declare a local variable for calculated values or functions like document.forms[0] which are going to be re-used in a function. Javascript does very little optimization for you and particularly in loops it can become very expensive re-calling functions or accessing data members over and over so you need to declare a local variable using the var keyword for anything you are going to re-use.</span></li>
<li></li>
<li><span style="font: 12pt Helvetica;">Loops which are implemented ineficiently in Javascript can be very expensive indeed. A number of basic principles should be employed when writing loops see </span><span style="font: 12pt Helvetica; text-decoration: underline;"><a href="http://www.webreference.com/programming/optimize/speedup/chap10/3/">this</a></span> <span style="font: 12pt Helvetica;">article for an in depth analysis but I will sum up the major points here.</span></li>
<li></li>
</ol>
<p></p>
<ul style="list-style-type: disc">
<li></li>
<li><span style="font: 12pt Helvetica;">Minimize if statements within a loop, switch statements are far more efficient in Javascript however if you must use if statements combine them whenever possible to reduce the number of distinct statements as every if must be tested even if an earlier one evaluates to true.</span></li>
<li></li>
<li><span style="font: 12pt Helvetica;">Loop backward whenever practicable using loops iterating on index-- is surprisingl much more efficient than index++ and --index is even more efficient particularly when you use a do/while loop rather than a for loop (the figures for the speed difference are staggering, check the link above)</span></li>
<li></li>
<li><span style="font: 12pt Helvetica;">Obviously, remove invariant code from the loop, anything which can be calculated once before the loop should be.</span></li>
<li></li>
</ul>
<p></p>
<p><span style="font: 12pt Helvetica;">I will keep adding to this entry as I have the time. I encourage others who have tips on this topic to post them here as comments.</span></p>
<p></p>
</div>

<div class="journalentry">
<b>Date:</b> 4 February 2007<br>
<b>Time:</b> 11:30:37 AM<br>
<b>Topic:</b> Spring Layout Released<br><br>
<p><span style="font: 12pt Helvetica;">Last week we deployed the first public release of the Spring Layout project. The project homepage is at </span><span style="font: 12pt Helvetica; text-decoration: underline;"><a href="http://springlayout.sourceforge.net/">sourceforge</a></span> <span style="font: 12pt Helvetica;">and is now available for download. I am looking forward to feedback from other developers and getting feedback from users.</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">I am currently working on the datagrid to enable multiple entries to be added without a post and writing a roadmap document so that we keep a coherent direction for future development.</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">Thanks to Groupware for providing time for developers to work on this framework.</span></p>
<p></p>
</div>

<div class="journalentry">
<b>Date:</b> 28 January 2007<br>
<b>Time:</b> 11:08:12 AM<br>
<b>Topic:</b> Spring Layout<br><br>
<p><span style="font: 12pt Helvetica;">Over the past 18 months we have been expanding the tag library and Spring MVC extensions that we use to increase our velocity in Web Application development. We always intended to Open Source this stuff as soon as it was mature enough to be easily configured and used by someone without intimate knowledge on how they work and it looks like that time is now just around the corner.</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">We have a sourceforge project open now </span><span style="font: 12pt Helvetica; text-decoration: underline;"><a href="http://sourceforge.net/projects/springlayout/">here</a></span></p>
<p><span style="font: 12pt Helvetica;">and will be migrating the source code, documentation and sample application there over the coming week. In general this framework provides integrated tags, much like the struts html tags which provide Spring binding and facilitate 3 modes of display: Read, Edit, and Multi. This allows for form data to be either displayed or provided in an editable format or to be switchable via clicking on the field or label. It provides a tightly integrated, extensible validation framework with simple client side/server side independent or cross field validation with both style sheet and message based error feedback.</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">In terms of Spring MVC extensions, it provides a Multi-Panel controller which allows for wizard-like multi form data gathering, field level security and controller support special components such as a Datagrid.</span></p>
<p></p>
</div>

<div class="journalentry">
<b>Date:</b> 5 January 2007<br>
<b>Time:</b> 8:35:15 AM<br>
<b>Topic:</b> Maven 2, MyEclipse &amp;amp; Tomcat Hot Deploy<br><br>
<p><span style="font: 12pt Helvetica;">Recently we have been attempting to move away from manually managing libs for each project and move to a central repository for manging our jars and dependecies. Maven 2 seemed like the ideal tool for this and since it seems to have such a large body of support we thought that it would be reasonably easy to integrate into our current development processes. We even thought we might get quite a bit of leverage out of the other plugins available for Maven 2 which would allow things like automatic site generation for the project and documentation of dependencies.</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">Unfortunately getting Maven 2 integrated into our current development processes was anything but easy. We usually build Web applications and we use the MyEclipse plugin for eclipse to automate and speed up many of the repetitive tasks. Auto-deploying wars and hot-swapping code is one feature we consider absolutely critical to our rapid development process. The following is a description of how we eventually got this working, and now can in fact get setup quicker than we could our old way.</span></p>
<ol style="list-style-type: decimal">
<li></li>
<li><span style="font: 12pt Helvetica;">First make sure that Maven 2 is installed and that it is in the path (see the Maven install instructions if you can find them).</span></li>
<li></li>
<li><span style="font: 12pt Helvetica;">.Configure the M2_REPO variable in Eclipse to point to your maven repository (usually /.m2/repository). This can be configured in Eclipse under windows-&gt;preferences-&gt;Java-&gt;build path-&gt;Classpath</span></li>
<li></li>
<li><span style="font: 12pt Helvetica;">Next, I have found that is easier to just follow the Maven folder conventions than to try and get maven to follow yours. This means that the normal src folder becomes src/main/java, all resources and configuration files go in src/main/resources, and the web root becomes src/main/webapp the test tree follows the same structure and becomes src/test/java and src/test/resources. In order for MyEclipse to live with this and do a hot deploy you need to tell the web deployer that your web context root folder is /src/main/webapp, this can be done when you give a project web capabilities but if your project already has web capabilities then you will need to modify the .mymetadata file in order to change it and restart eclipse.</span></li>
<li></li>
<li><span style="font: 12pt Helvetica;">obviously your project needs to have a valid pom.xml in the project root. Under the  part of your pom put the following: &lt;plugin&gt; &lt;groupid&gt;org.apache.maven.plugins&lt;/groupid&gt; &lt;artifactid&gt;maven-eclipse-plugin&lt;/artifactid&gt; &lt;configuration&gt; &lt;buildoutputdirectory&gt;src/main/webapp/WEB-INF/classes&lt;/buildoutputdirectory&gt; &lt;downloadsources&gt;true&lt;/downloadsources&gt; &lt;/configuration&gt; &lt;/plugin&gt;</span></li>
<li></li>
<li><span style="font: 12pt Helvetica;">this tells eclipse to build to the classes folder under your web root WEB-INF folder (where they need to be for a hot deploy)</span></li>
<li></li>
<li><span style="font: 12pt Helvetica;">Navigate to your project root on the command line and run mvn eclipse:eclipse this should build your .classpath file according to your pom.xml and even attach source code where available.</span></li>
<li></li>
</ol>
<p></p>
<p><span style="font: 12pt Helvetica;">Most people should be able to hot-deploy as normal now using the MyEclipse server tools, however i have noticed some people have problems with servlet-api.jar and jsp-api.jar conflicts, if that is the case then the following steps should fix that:</span></p>
<ol style="list-style-type: decimal">
<li></li>
<li><span style="font: 12pt Helvetica;">Right click on your project and go to the properties&gt;java build path&gt;libraries You will need to look through this list for servlet-api.jar and jsp-api.jar, remove them and add the J2EE library (You will need to do this each time you run the eclipse target or else your servlet-api.jar and jsp-api.jar will get deployed to your web server and may interfere with the one it already has in it's classpath</span></li>
<li></li>
<li><span style="font: 12pt Helvetica;">Next, still under the project properties item go to MyEclpse-&gt;Web-&gt;Deployment uncheck the 'workbench default settings' and 'Jars in web Projects user Libraries'</span></li>
<li></li>
</ol>
<p></p>
<p><span style="font: 12pt Helvetica;">you should now be able to do a normal MyEclipse hot-deploy...</span></p>
<p></p>
</div>

<div class="journalentry">
<b>Date:</b> 29 December 2006<br>
<b>Time:</b> 10:49:23 PM<br>
<b>Topic:</b> Javascript Memory Leaks<br><br>
<p><span style="font: 12pt Helvetica;">A while ago we were implementing a large, web based, data gathering application for a government department. The application required quite complicated cross field validation and very specific visual feedback mechanisms which had to be live on the page whenever possible. We had already been developing a tag library to extend the bind tags provided out of the box in Spring MVC so we decided to bite the bullet and integrate validation into these tags (I will write more on this project in other entries).</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">We made extensive use of the Prototype and Behaviour Javascript libraries to assist in cross browser compatibility and to try and keep as much Javascript event code off the page as possible. We soon began to see performance problems in IE. For quite a wile we couldn't pin down what was making this problem occur as it seemed quite intermittent, but eventually we pinned it down to browsers which had been open on our application for extended lengths of time without being closed and re-opened.</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">Checking the memory footprint of IE we quickly noted that it's size was growing at the rate of almost .5 mb per page load. After a fair bit of analysis we discovered a tool called </span><span style="font: 12pt Helvetica; text-decoration: underline;"><a href="http://outofhanwell.com/ieleak/index.php?title=Main_Page">Drip</a></span> <span style="font: 12pt Helvetica;">which we found invaluable in tracking down and plugging the leaks.</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">Two main issues are at the core of memory leaks in IE and the drip link above provides links to sites which discuss both of them.</span></p>
<p><span style="font: 12pt Helvetica;">1. Closures: Briefly closures occur when functions reference variables scoped at higher levels.</span></p>
<p><span style="font: 12pt Helvetica;">2.Event listeners with references to the DOM: Briefly this causes self referencing islands which IE is unable to garbage collect.</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">Issue number 2 is fixed relatively easy by the event cache javascript a link to which can be found on the drip page I have already linked. The problem of closures is far less difficult to fix but can easily be detected using the drip tool.</span></p>
<p></p>
<p><span style="font: 12pt Helvetica;">There are two possible remedies once you find closures which are leaking memory. The first is to alter your code to remove them altogether. Unfortunately this is not always easy to do or can involve extremely verbose workarounds. In instances where you are attaching an anonymous function to an element (something that we often do when using Behaviour) you will almost invariably create a closure which will leak in IE. We found </span><span style="font: 12pt Helvetica; text-decoration: underline;"><a href="http://laurens.vd.oever.nl/weblog/items2005/closures/">this</a></span> <span style="font: 12pt Helvetica;">closure script to work extremely efficiently in removing these leaks in IE.</span></p>
<p></p>
</div>

<div class="journalentry">
<b>Date:</b> 26 December 2006<br>
<b>Time:</b> 11:23:34 AM<br>
<b>Topic:</b> Voodoo Blog is Born<br><br>
<p style="text-align: left"><span style="font: 12pt Helvetica;">This is the first entry for my blog. I hope to put here items of interest which have come up while I have been developing Enterprise Java web Applications. It has been on my list for quite some time to get this blog up but for one reason or another I have not gotten around to it.</span></p>
<p style="text-align: left"></p>
<p style="text-align: left"><span style="font: 12pt Helvetica;">Hopefully this will be useful to other people, but more importantly this is intended to be a kind of journal of interesting problems I have come across and how they were managed. I hope, over the next little while, to back enter some of the issues which spurred me to get this blog going.</span></p>
<p style="text-align: left"></p>
</div>

<div class="journalentry">
<b>Date:</b> 27 September 2011<br>
<b>Time:</b> 8:07:37 AM<br>
<b>Topic:</b> Agile - Form follows function<br><br>
<p style="text-align: left"><span style="font: 12pt Helvetica;">Often, these days, developing in Agile shops it feels like it is about Agile rather than about delivering features. People spend so much time talking about Agile and Agile processes they seem to have lost track of what it is all for. Enter into this debate the Software Craftsmanship movement and it almost seems like giving businesses what they want (features in production) seems to have become irrelevant.</span></p>
<p style="text-align: left"></p>
<p style="text-align: left"><span style="font: 12pt Helvetica;">The issue is further clouded by consultancy that make their bread and butter from coaching Agile and have a vested interest in broadening the scope of Agile to encompass anything to do with business. Of course this is a great thing for them as it broadens the base of people they can sell their services to. Initially this was couched in terms of the business connected to software delivery but increasingly it is about anything to do with business full stop. There is even a movement around now called Personal KanBan. I’m personally okay with broadening the conversation but not at the expense of doing what is required to <em>deliver features into production</em>. I’m okay with calling ourselves craftsmen and getting super precious about everything we do, but again as long as it doesn’t get in the way of <em>delivering features into production.</em></span></p>
<p style="text-align: left"></p>
<p style="text-align: left"><span style="font: 12pt Helvetica;">I am increasingly disinclined to engage with people in discussions about Agile. That is because the term has become so loaded now. Often small companies view the term Agile with suspicion, the examples of agile success that they have been shown look extremely expensive and inefficient, and mostly they are. What I prefer to discuss is how to get their ideas into production where they can test them with the public (or at least some select subsection of the public).</span></p></div>

<div class="journalentry">
<b>Date:</b> 16 January 2012<br>
<b>Time:</b> 8:34:08 AM<br>
<b>Topic:</b> Workingness<br><br>
<p style="text-align: left"><span style="font: 12pt Helvetica;">Over the years I have worked on a lot of ‘legacy’ apps. I was never surprised to find them in Java, but I have been focussing on Ruby, mostly Rails apps, for the past few years and have been unpleasantly surprised to find an abundant supply of legacy apps in this space as well. One thing it does prove is that a long time in production is not a pre-requisite for an application becoming legacy. A poorly written application can become legacy virtually from the moment that it is released.</span></p>
<p style="text-align: left"></p>
<p style="text-align: left"><span style="font: 12pt Helvetica;">Rather than bang on about how much harder it is to improve and sanitise a legacy system, I thought I might focus on what is useful in a legacy system, and the most critical aspect of any legacy system that must be preserved at all costs. There is no term that I know of for this, so I have decided to call it <em>workingness</em><strong>. </strong>Talking about software having the property of working may not seem all that insightful but actually this simple feature of an existing application is far more important than many people think. It is the single most important reason to opt for strategies like ‘hollow out and replace’ as an existing verifiably working systems is an awesome acceptance test.</span></p>
<p style="text-align: left"></p>
<p style="text-align: left"></p>
<p style="text-align: left"><span style="font: 12pt Helvetica;">Often they happen due to overwhelming pressure to get something out and prove out an idea. Even when they can only be attributed to poor skill or carelessness, they nevertheless often represent a large part of the money making apparatus of a company. Even when such an application is a complete basket case it  and why  you generally end up following a hollow out and replace strategy rather than a re-write, even for many of the worst legacy systems.</span></p></div>

</body>
</html>
